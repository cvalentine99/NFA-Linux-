import{r as l,a as Be,g as He,R as Pe}from"./react-vendor-CQ1lgQYd.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var je={exports:{}},X={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke=l,Ge=Symbol.for("react.element"),Xe=Symbol.for("react.fragment"),Ye=Object.prototype.hasOwnProperty,Ze=Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Je={key:!0,ref:!0,__self:!0,__source:!0};function Ae(e,t,r){var s,n={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)Ye.call(t,s)&&!Je.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:Ge,type:e,key:o,ref:i,props:n,_owner:Ze.current}}X.Fragment=Xe;X.jsx=Ae;X.jsxs=Ae;je.exports=X;var a=je.exports,ne={},fe=Be;ne.createRoot=fe.createRoot,ne.hydrateRoot=fe.hydrateRoot;const Qe={},pe=e=>{let t;const r=new Set,s=(h,x)=>{const y=typeof h=="function"?h(t):h;if(!Object.is(y,t)){const w=t;t=x??(typeof y!="object"||y===null)?y:Object.assign({},t,y),r.forEach(_=>_(t,w))}},n=()=>t,d={setState:s,getState:n,getInitialState:()=>m,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(Qe?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},m=t=e(s,n,d);return d},et=e=>e?pe(e):pe;var Ee={exports:{}},Ne={},Ie={exports:{}},Fe={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I=l;function tt(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rt=typeof Object.is=="function"?Object.is:tt,nt=I.useState,st=I.useEffect,ot=I.useLayoutEffect,at=I.useDebugValue;function it(e,t){var r=t(),s=nt({inst:{value:r,getSnapshot:t}}),n=s[0].inst,o=s[1];return ot(function(){n.value=r,n.getSnapshot=t,ee(n)&&o({inst:n})},[e,r,t]),st(function(){return ee(n)&&o({inst:n}),e(function(){ee(n)&&o({inst:n})})},[e]),at(r),r}function ee(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!rt(e,r)}catch{return!0}}function ct(e,t){return t()}var lt=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ct:it;Fe.useSyncExternalStore=I.useSyncExternalStore!==void 0?I.useSyncExternalStore:lt;Ie.exports=Fe;var ut=Ie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y=l,dt=ut;function ft(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pt=typeof Object.is=="function"?Object.is:ft,ht=dt.useSyncExternalStore,yt=Y.useRef,mt=Y.useEffect,wt=Y.useMemo,xt=Y.useDebugValue;Ne.useSyncExternalStoreWithSelector=function(e,t,r,s,n){var o=yt(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=wt(function(){function d(w){if(!m){if(m=!0,h=w,w=s(w),n!==void 0&&i.hasValue){var _=i.value;if(n(_,w))return x=_}return x=w}if(_=x,pt(h,w))return _;var C=s(w);return n!==void 0&&n(_,C)?(h=w,_):(h=w,x=C)}var m=!1,h,x,y=r===void 0?null:r;return[function(){return d(t())},y===null?void 0:function(){return d(y())}]},[t,r,s,n]);var c=ht(e,o[0],o[1]);return mt(function(){i.hasValue=!0,i.value=c},[c]),xt(c),c};Ee.exports=Ne;var _t=Ee.exports;const vt=He(_t),Oe={},{useDebugValue:gt}=Pe,{useSyncExternalStoreWithSelector:bt}=vt;let he=!1;const kt=e=>e;function St(e,t=kt,r){(Oe?"production":void 0)!=="production"&&r&&!he&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),he=!0);const s=bt(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return gt(s),s}const Ct=e=>{(Oe?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?et(e):e,r=(s,n)=>St(t,s,n);return Object.assign(r,t),r},Pt=e=>Ct;var Te=Symbol.for("immer-nothing"),ye=Symbol.for("immer-draftable"),g=Symbol.for("immer-state");function k(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var D=Object.getPrototypeOf;function F(e){return!!e&&!!e[g]}function A(e){var t;return e?Re(e)||Array.isArray(e)||!!e[ye]||!!((t=e.constructor)!=null&&t[ye])||M(e)||J(e):!1}var jt=Object.prototype.constructor.toString(),me=new WeakMap;function Re(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let s=me.get(r);return s===void 0&&(s=Function.toString.call(r),me.set(r,s)),s===jt}function H(e,t,r=!0){Z(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)}):e.forEach((s,n)=>t(n,s,e))}function Z(e){const t=e[g];return t?t.type_:Array.isArray(e)?1:M(e)?2:J(e)?3:0}function se(e,t){return Z(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function De(e,t,r){const s=Z(e);s===2?e.set(t,r):s===3?e.add(r):e[t]=r}function At(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function M(e){return e instanceof Map}function J(e){return e instanceof Set}function j(e){return e.copy_||e.base_}function oe(e,t){if(M(e))return new Map(e);if(J(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Re(e);if(t===!0||t==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(e);delete s[g];let n=Reflect.ownKeys(s);for(let o=0;o<n.length;o++){const i=n[o],c=s[i];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(s[i]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[i]})}return Object.create(D(e),s)}else{const s=D(e);if(s!==null&&r)return{...e};const n=Object.create(s);return Object.assign(n,e)}}function ue(e,t=!1){return Q(e)||F(e)||!A(e)||(Z(e)>1&&Object.defineProperties(e,{set:B,add:B,clear:B,delete:B}),Object.freeze(e),t&&Object.values(e).forEach(r=>ue(r,!0))),e}function Et(){k(2)}var B={value:Et};function Q(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Nt={};function E(e){const t=Nt[e];return t||k(0,e),t}var z;function ze(){return z}function It(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function we(e,t){t&&(E("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ae(e){ie(e),e.drafts_.forEach(Ft),e.drafts_=null}function ie(e){e===z&&(z=e.parent_)}function xe(e){return z=It(z,e)}function Ft(e){const t=e[g];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function _e(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[g].modified_&&(ae(t),k(4)),A(e)&&(e=K(t,e),t.parent_||G(t,e)),t.patches_&&E("Patches").generateReplacementPatches_(r[g].base_,e,t.patches_,t.inversePatches_)):e=K(t,r,[]),ae(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Te?e:void 0}function K(e,t,r){if(Q(t))return t;const s=e.immer_.shouldUseStrictIteration(),n=t[g];if(!n)return H(t,(o,i)=>ve(e,n,t,o,i,r),s),t;if(n.scope_!==e)return t;if(!n.modified_)return G(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const o=n.copy_;let i=o,c=!1;n.type_===3&&(i=new Set(o),o.clear(),c=!0),H(i,(d,m)=>ve(e,n,o,d,m,r,c),s),G(e,o,!1),r&&e.patches_&&E("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function ve(e,t,r,s,n,o,i){if(n==null||typeof n!="object"&&!i)return;const c=Q(n);if(!(c&&!i)){if(F(n)){const d=o&&t&&t.type_!==3&&!se(t.assigned_,s)?o.concat(s):void 0,m=K(e,n,d);if(De(r,s,m),F(m))e.canAutoFreeze_=!1;else return}else i&&r.add(n);if(A(n)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[s]===n&&c)return;K(e,n),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(M(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&G(e,n)}}}function G(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ue(t,r)}function Ot(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:ze(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,o=de;r&&(n=[s],o=L);const{revoke:i,proxy:c}=Proxy.revocable(n,o);return s.draft_=c,s.revoke_=i,c}var de={get(e,t){if(t===g)return e;const r=j(e);if(!se(r,t))return Tt(e,r,t);const s=r[t];return e.finalized_||!A(s)?s:s===te(e.base_,t)?(re(e),e.copy_[t]=le(s,e)):s},has(e,t){return t in j(e)},ownKeys(e){return Reflect.ownKeys(j(e))},set(e,t,r){const s=Le(j(e),t);if(s!=null&&s.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const n=te(j(e),t),o=n==null?void 0:n[g];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(At(r,n)&&(r!==void 0||se(e.base_,t)))return!0;re(e),ce(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return te(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,re(e),ce(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=j(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:r[t]}},defineProperty(){k(11)},getPrototypeOf(e){return D(e.base_)},setPrototypeOf(){k(12)}},L={};H(de,(e,t)=>{L[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});L.deleteProperty=function(e,t){return L.set.call(this,e,t,void 0)};L.set=function(e,t,r){return de.set.call(this,e[0],t,r,e[0])};function te(e,t){const r=e[g];return(r?j(r):e)[t]}function Tt(e,t,r){var n;const s=Le(t,r);return s?"value"in s?s.value:(n=s.get)==null?void 0:n.call(e.draft_):void 0}function Le(e,t){if(!(t in e))return;let r=D(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=D(r)}}function ce(e){e.modified_||(e.modified_=!0,e.parent_&&ce(e.parent_))}function re(e){e.copy_||(e.copy_=oe(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Rt=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,s)=>{if(typeof t=="function"&&typeof r!="function"){const o=r;r=t;const i=this;return function(d=o,...m){return i.produce(d,h=>r.call(this,h,...m))}}typeof r!="function"&&k(6),s!==void 0&&typeof s!="function"&&k(7);let n;if(A(t)){const o=xe(this),i=le(t,void 0);let c=!0;try{n=r(i),c=!1}finally{c?ae(o):ie(o)}return we(o,s),_e(n,o)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===Te&&(n=void 0),this.autoFreeze_&&ue(n,!0),s){const o=[],i=[];E("Patches").generateReplacementPatches_(t,n,o,i),s(o,i)}return n}else k(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...c)=>this.produceWithPatches(i,d=>t(d,...c));let s,n;return[this.produce(t,r,(i,c)=>{s=i,n=c}),s,n]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){A(e)||k(8),F(e)&&(e=Dt(e));const t=xe(this),r=le(e,void 0);return r[g].isManual_=!0,ie(t),r}finishDraft(e,t){const r=e&&e[g];(!r||!r.isManual_)&&k(9);const{scope_:s}=r;return we(s,t),_e(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const s=E("Patches").applyPatches_;return F(e)?s(e,t):this.produce(e,n=>s(n,t))}};function le(e,t){const r=M(e)?E("MapSet").proxyMap_(e,t):J(e)?E("MapSet").proxySet_(e,t):Ot(e,t);return(t?t.scope_:ze()).drafts_.push(r),r}function Dt(e){return F(e)||k(10,e),Me(e)}function Me(e){if(!A(e)||Q(e))return e;const t=e[g];let r,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=oe(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else r=oe(e,!0);return H(r,(n,o)=>{De(r,n,Me(o))},s),t&&(t.finalized_=!1),r}var zt=new Rt,Lt=zt.produce;const Mt=e=>(t,r,s)=>(s.setState=(n,o,...i)=>{const c=typeof n=="function"?Lt(n):n;return t(c,o,...i)},e(s.setState,r,s)),Vt=Mt,ge=1e5,be=5e4,ke=1e4,$t={packets:{total:0,tcp:0,udp:0,icmp:0,other:0},bytes:{total:0,inbound:0,outbound:0},flows:{total:0,active:0,completed:0},protocols:{},topTalkers:[],topPorts:[]},Ut={isCapturing:!1,interface:"",startTime:0,packetsCaptured:0,packetsDropped:0,bytesProcessed:0,flowsActive:0,alertsGenerated:0},Se={activeView:"dashboard",selectedPacketId:null,selectedFlowId:null,selectedFileId:null,selectedAlertId:null,filters:{search:"",protocols:[],severities:[],srcIP:"",dstIP:"",port:null,minBytes:null,maxBytes:null},timeRange:{start:null,end:null,relative:"all"}},S=Pt()(Vt(e=>({packets:new Map,packetIds:[],flows:new Map,flowIds:[],files:new Map,alerts:new Map,alertIds:[],topology:{nodes:[],links:[]},statistics:$t,capture:Ut,view:Se,_packetVersion:0,_flowVersion:0,_alertVersion:0,_filterVersion:0,addPackets:t=>e(r=>{for(const s of t)r.packets.set(s.id,s),r.packetIds.push(s.id);if(r.packetIds.length>ge){const s=r.packetIds.splice(0,r.packetIds.length-ge);for(const n of s)r.packets.delete(n)}r._packetVersion++}),clearPackets:()=>e(t=>{t.packets.clear(),t.packetIds=[],t._packetVersion++}),updateFlows:t=>e(r=>{for(const s of t)r.flows.has(s.id)||r.flowIds.push(s.id),r.flows.set(s.id,s);if(r.flowIds.length>be){const s=r.flowIds.splice(0,r.flowIds.length-be);for(const n of s)r.flows.delete(n)}r._flowVersion++}),clearFlows:()=>e(t=>{t.flows.clear(),t.flowIds=[],t._flowVersion++}),addFile:t=>e(r=>{r.files.set(t.id,t)}),clearFiles:()=>e(t=>{t.files.clear()}),addAlert:t=>e(r=>{if(r.alerts.set(t.id,t),r.alertIds.unshift(t.id),r.alertIds.length>ke){const s=r.alertIds.splice(ke);for(const n of s)r.alerts.delete(n)}r._alertVersion++}),clearAlerts:()=>e(t=>{t.alerts.clear(),t.alertIds=[],t._alertVersion++}),acknowledgeAlert:t=>e(r=>{const s=r.alerts.get(t);s&&(r.alerts.set(t,{...s,acknowledged:!0,acknowledgedAt:Date.now()*1e6}),r._alertVersion++)}),updateStatistics:t=>e(r=>{r.statistics=t}),updateTopology:t=>e(r=>{r.topology=t}),updateCaptureState:t=>e(r=>{Object.assign(r.capture,t)}),startCapture:t=>e(r=>{r.capture.isCapturing=!0,r.capture.interface=t,r.capture.startTime=Date.now(),r.capture.packetsCaptured=0,r.capture.packetsDropped=0,r.capture.bytesProcessed=0}),stopCapture:()=>e(t=>{t.capture.isCapturing=!1}),setActiveView:t=>e(r=>{r.view.activeView=t}),selectPacket:t=>e(r=>{r.view.selectedPacketId=t}),selectFlow:t=>e(r=>{r.view.selectedFlowId=t}),selectFile:t=>e(r=>{r.view.selectedFileId=t}),selectAlert:t=>e(r=>{r.view.selectedAlertId=t}),setFilter:t=>e(r=>{Object.assign(r.view.filters,t),r._filterVersion++}),clearFilters:()=>e(t=>{t.view.filters=Se.filters,t._filterVersion++}),setTimeRange:t=>e(r=>{r.view.timeRange=t,r._filterVersion++})}))),Wt=()=>S(e=>e.packetIds.length),qt=()=>S(e=>e.flowIds.length),Bt=()=>S(e=>e.alertIds.length),Ht=()=>S(e=>e.capture),Kt=()=>S(e=>e.view.activeView);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Gt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=(e,t)=>{const r=l.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:c="",children:d,...m},h)=>l.createElement("svg",{ref:h,...Gt,width:n,height:n,stroke:s,strokeWidth:i?Number(o)*24/Number(n):o,className:["lucide",`lucide-${Xt(e)}`,c].join(" "),...m},[...t.map(([x,y])=>l.createElement(x,y)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=b("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=b("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=b("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=b("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=b("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=b("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=b("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=b("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=b("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=b("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=b("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=b("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=b("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),P={PACKET_BATCH:"packet:batch",FLOW_UPDATE:"flow:update",ALERT_NEW:"alert:new",STATS_UPDATE:"stats:update",CAPTURE_STATE:"capture:state",TOPOLOGY_UPDATE:"topology:update",FILE_EXTRACTED:"file:extracted",ERROR:"error"},sr=16;function or(){const{addPackets:e,updateFlows:t,addAlert:r,updateStatistics:s,updateCaptureState:n,updateTopology:o,addFile:i}=S(),c=l.useRef([]),d=l.useRef([]),m=l.useRef(0),h=l.useRef(null),x=l.useCallback(()=>{c.current.length>0&&(e(c.current),c.current=[]),d.current.length>0&&(t(d.current),d.current=[]),m.current=performance.now(),h.current=null},[e,t]),y=l.useCallback(()=>{h.current===null&&(performance.now()-m.current>=sr?h.current=requestAnimationFrame(x):h.current=requestAnimationFrame(()=>{h.current=requestAnimationFrame(x)}))},[x]),w=l.useCallback(u=>{const f=u;c.current.push(...f.packets),y()},[y]),_=l.useCallback(u=>{const f=u;d.current.push(...f.flows),y()},[y]),C=l.useCallback(u=>{const f=u;r(f.alert),(f.alert.severity==="critical"||f.alert.severity==="high")&&ir(f.alert)},[r]),O=l.useCallback(u=>{s(u.stats)},[s]),v=l.useCallback(u=>{const f=u;n({isCapturing:f.capturing,interface:f.interface||"",pcapFile:f.pcap||"",isPcapComplete:f.pcapComplete||!1}),f.stats&&s(f.stats)},[n,s]),V=l.useCallback(u=>{o(u.topology)},[o]),$=l.useCallback(u=>{i(u.file)},[i]),U=l.useCallback(u=>{const f=u;console.error("Backend error:",f.message,f.code)},[]);l.useEffect(()=>{const u=window.runtime;if(!u){console.warn("Wails runtime not available, running in development mode");return}const f=[u.EventsOn(P.PACKET_BATCH,w),u.EventsOn(P.FLOW_UPDATE,_),u.EventsOn(P.ALERT_NEW,C),u.EventsOn(P.STATS_UPDATE,O),u.EventsOn(P.CAPTURE_STATE,v),u.EventsOn(P.TOPOLOGY_UPDATE,V),u.EventsOn(P.FILE_EXTRACTED,$),u.EventsOn(P.ERROR,U)];return()=>{f.forEach(T=>T==null?void 0:T()),h.current!==null&&cancelAnimationFrame(h.current)}},[w,_,C,O,v,V,$,U])}function ar(){const e=l.useCallback(async n=>{var i,c;const o=(c=(i=window.go)==null?void 0:i.main)==null?void 0:c.App;o!=null&&o.StartCapture?await o.StartCapture(n,""):console.warn("StartCapture not available")},[]),t=l.useCallback(async()=>{var o,i;const n=(i=(o=window.go)==null?void 0:o.main)==null?void 0:i.App;n!=null&&n.StopCapture?await n.StopCapture():console.warn("StopCapture not available")},[]),r=l.useCallback(async()=>{var o,i;const n=(i=(o=window.go)==null?void 0:o.main)==null?void 0:i.App;return n!=null&&n.ListInterfaces?(await n.ListInterfaces()).map(d=>d.name):(console.warn("ListInterfaces not available"),[])},[]),s=l.useCallback(async n=>{var i,c;const o=(c=(i=window.go)==null?void 0:i.main)==null?void 0:c.App;o!=null&&o.LoadPCAP?await o.LoadPCAP(n):console.warn("LoadPCAP not available")},[]);return{startCapture:e,stopCapture:t,getInterfaces:r,loadPCAP:s}}function ir(e){"Notification"in window&&Notification.permission==="granted"&&new Notification(`NFA Alert: ${e.title}`,{body:e.description,icon:"/nfa-icon.svg",tag:e.id})}const cr=[{id:"dashboard",label:"Dashboard",icon:Zt},{id:"packets",label:"Packets",icon:We},{id:"flows",label:"Flows",icon:$e},{id:"files",label:"Files",icon:Ve},{id:"alerts",label:"Alerts",icon:qe},{id:"topology",label:"Topology",icon:Ue}];function lr(){const e=Kt(),t=S(p=>p.setActiveView),r=Ht(),s=Wt(),n=qt(),o=Bt(),i=S(p=>p.files),c=S(p=>p.updateCaptureState),[d,m]=l.useState(""),[h,x]=l.useState([]),[y,w]=l.useState(""),[_,C]=l.useState(!1),[O,v]=l.useState("");or();const{startCapture:V,stopCapture:$,loadPCAP:U}=ar();l.useEffect(()=>{(async()=>{var R,W;try{const N=(W=(R=window.go)==null?void 0:R.main)==null?void 0:W.App;if(N!=null&&N.ListInterfaces){const q=await N.ListInterfaces();x(q),q&&q.length>0&&w(q[0].name)}}catch(N){console.error("Failed to load interfaces:",N)}})()},[]);const u=async()=>{try{if(r.isCapturing)v("Stopping capture..."),await $(),c({isCapturing:!1}),v("");else{if(!y){console.error("No interface selected");return}v(`Starting capture on ${y}...`),await V(y),c({isCapturing:!0,interface:y,startTime:Date.now()}),v(`Capturing on ${y}`)}}catch(p){console.error("Capture toggle failed:",p),v("Capture failed"),setTimeout(()=>v(""),3e3)}},f=async()=>{try{const p=prompt("Enter PCAP file path:");p&&(v("Loading PCAP file..."),await U(p),v("PCAP file loaded"),setTimeout(()=>v(""),3e3))}catch(p){console.error("Failed to load PCAP file:",p),v("Failed to load PCAP file"),setTimeout(()=>v(""),3e3)}},T=()=>{switch(e){case"dashboard":return a.jsx(Ce,{});case"packets":return a.jsx(ur,{searchValue:d});case"flows":return a.jsx(dr,{});case"files":return a.jsx(fr,{});case"alerts":return a.jsx(pr,{});case"topology":return a.jsx(hr,{});default:return a.jsx(Ce,{})}};return a.jsxs("div",{className:"h-screen w-screen flex flex-col bg-[#0a0a0f] text-white font-sans",children:[a.jsxs("header",{className:"h-12 bg-[#16161e] border-b border-[#2a2a3a] flex items-center justify-between px-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ue,{className:"w-5 h-5 text-blue-400"}),a.jsx("span",{className:"font-semibold text-lg",children:"Network Forensics Analyzer"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>C(!_),className:"flex items-center space-x-2 px-3 py-1 bg-[#2a2a3a] rounded border border-[#404040] hover:bg-[#353544] transition-colors",children:[a.jsx(nr,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:y||"Select Interface"}),a.jsx(Yt,{className:"w-4 h-4"})]}),_&&a.jsx("div",{className:"absolute top-full left-0 mt-1 bg-[#2a2a3a] border border-[#404040] rounded shadow-lg z-10 min-w-[200px]",children:h.map(p=>a.jsxs("button",{onClick:()=>{w(p.name),C(!1)},className:"w-full px-3 py-2 text-left text-sm hover:bg-[#353544] flex items-center justify-between",children:[a.jsx("span",{children:p.name}),a.jsxs("div",{className:"flex space-x-1",children:[p.isUp&&a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full",title:"Up"}),p.hasAddress&&a.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full",title:"Has Address"}),p.isLoopback&&a.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full",title:"Loopback"})]})]},p.name))})]}),a.jsxs("button",{onClick:f,className:"flex items-center space-x-2 px-3 py-1 bg-purple-600 hover:bg-purple-700 rounded transition-colors",children:[a.jsx(rr,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Load PCAP"})]}),a.jsx("button",{onClick:u,disabled:!y,className:`flex items-center space-x-2 px-3 py-1 rounded transition-colors ${r.isCapturing?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed"}`,children:r.isCapturing?a.jsxs(a.Fragment,{children:[a.jsx(tr,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Stop"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Jt,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Capture"})]})}),O&&a.jsxs("div",{className:"text-sm text-yellow-400 flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),a.jsx("span",{children:O})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Qt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",value:d,onChange:p=>m(p.target.value),placeholder:"Search...",className:"pl-8 pr-3 py-1 bg-[#2a2a3a] border border-[#404040] rounded text-sm focus:outline-none focus:border-blue-500 w-64"})]}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(We,{className:"w-4 h-4 text-blue-400"}),a.jsx("span",{children:s.toLocaleString()})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx($e,{className:"w-4 h-4 text-green-400"}),a.jsx("span",{children:n.toLocaleString()})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(qe,{className:"w-4 h-4 text-yellow-400"}),a.jsx("span",{children:o.toLocaleString()})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ve,{className:"w-4 h-4 text-purple-400"}),a.jsx("span",{children:i.size.toLocaleString()})]})]}),a.jsx(er,{className:"w-5 h-5 text-gray-400 hover:text-white cursor-pointer transition-colors"})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsx("nav",{className:"w-16 bg-[#16161e] border-r border-[#2a2a3a] flex flex-col items-center py-4 space-y-2",children:cr.map(({id:p,label:R,icon:W})=>a.jsxs("button",{onClick:()=>t(p),className:`w-10 h-10 flex items-center justify-center rounded transition-colors group relative ${e===p?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-[#2a2a3a]"}`,title:R,children:[a.jsx(W,{className:"w-5 h-5"}),a.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-black text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:R})]},p))}),a.jsx("main",{className:"flex-1 overflow-hidden",children:T()})]})]})}function Ce(){return a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Dashboard"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"})]})}function ur({searchValue:e}){return a.jsx("div",{className:"p-6",children:a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Packets"})})}function dr(){return a.jsx("div",{className:"p-6",children:a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Flows"})})}function fr(){return a.jsx("div",{className:"p-6",children:a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Extracted Files"})})}function pr(){return a.jsx("div",{className:"p-6",children:a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Security Alerts"})})}function hr(){return a.jsx("div",{className:"p-6",children:a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Network Topology"})})}ne.createRoot(document.getElementById("root")).render(a.jsx(Pe.StrictMode,{children:a.jsx(lr,{})}));
