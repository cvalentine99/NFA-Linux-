import{r as m,a as Kt,g as Wt,R as ft}from"./react-vendor-3-72CUaz.js";import{c as j,R as gt,P as Zt,a as Qt,C as Yt,T as yt,L as Xt,A as Jt,b as es,X as ts,Y as ss,d as Be,S as Ve,M as rs,e as Ne,f as as,g as He,D as ns,F as cs}from"./viz-vendor-Bkb7tg2m.js";import{u as he}from"./table-vendor-Dg3rGswh.js";import"three/webgpu";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var jt={exports:{}},me={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ls=m,is=Symbol.for("react.element"),os=Symbol.for("react.fragment"),ds=Object.prototype.hasOwnProperty,xs=ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hs={key:!0,ref:!0,__self:!0,__source:!0};function bt(t,s,r){var a,n={},i=null,c=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(c=s.ref);for(a in s)ds.call(s,a)&&!hs.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:is,type:t,key:i,ref:c,props:n,_owner:xs.current}}me.Fragment=os;me.jsx=bt;me.jsxs=bt;jt.exports=me;var e=jt.exports,Ce={},qe=Kt;Ce.createRoot=qe.createRoot,Ce.hydrateRoot=qe.hydrateRoot;const ms={},Ue=t=>{let s;const r=new Set,a=(l,h)=>{const g=typeof l=="function"?l(s):l;if(!Object.is(g,s)){const N=s;s=h??(typeof g!="object"||g===null)?g:Object.assign({},s,g),r.forEach(k=>k(s,N))}},n=()=>s,x={setState:a,getState:n,getInitialState:()=>d,subscribe:l=>(r.add(l),()=>r.delete(l)),destroy:()=>{(ms?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=s=t(a,n,x);return x},us=t=>t?Ue(t):Ue;var vt={exports:{}},Nt={},wt={exports:{}},kt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K=m;function ps(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var fs=typeof Object.is=="function"?Object.is:ps,gs=K.useState,ys=K.useEffect,js=K.useLayoutEffect,bs=K.useDebugValue;function vs(t,s){var r=s(),a=gs({inst:{value:r,getSnapshot:s}}),n=a[0].inst,i=a[1];return js(function(){n.value=r,n.getSnapshot=s,we(n)&&i({inst:n})},[t,r,s]),ys(function(){return we(n)&&i({inst:n}),t(function(){we(n)&&i({inst:n})})},[t]),bs(r),r}function we(t){var s=t.getSnapshot;t=t.value;try{var r=s();return!fs(t,r)}catch{return!0}}function Ns(t,s){return s()}var ws=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ns:vs;kt.useSyncExternalStore=K.useSyncExternalStore!==void 0?K.useSyncExternalStore:ws;wt.exports=kt;var ks=wt.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ue=m,Ss=ks;function Cs(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Ps=typeof Object.is=="function"?Object.is:Cs,Ts=Ss.useSyncExternalStore,Is=ue.useRef,Ms=ue.useEffect,_s=ue.useMemo,Fs=ue.useDebugValue;Nt.useSyncExternalStoreWithSelector=function(t,s,r,a,n){var i=Is(null);if(i.current===null){var c={hasValue:!1,value:null};i.current=c}else c=i.current;i=_s(function(){function x(N){if(!d){if(d=!0,l=N,N=a(N),n!==void 0&&c.hasValue){var k=c.value;if(n(k,N))return h=k}return h=N}if(k=h,Ps(l,N))return k;var p=a(N);return n!==void 0&&n(k,p)?(l=N,k):(l=N,h=p)}var d=!1,l,h,g=r===void 0?null:r;return[function(){return x(s())},g===null?void 0:function(){return x(g())}]},[s,r,a,n]);var o=Ts(t,i[0],i[1]);return Ms(function(){c.hasValue=!0,c.value=o},[o]),Fs(o),o};vt.exports=Nt;var As=vt.exports;const Ds=Wt(As),St={},{useDebugValue:Es}=ft,{useSyncExternalStoreWithSelector:$s}=Ds;let Ge=!1;const Ls=t=>t;function zs(t,s=Ls,r){(St?"production":void 0)!=="production"&&r&&!Ge&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ge=!0);const a=$s(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,r);return Es(a),a}const Os=t=>{(St?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?us(t):t,r=(a,n)=>zs(s,a,n);return Object.assign(r,s),r},Rs=t=>Os;var Ct=Symbol.for("immer-nothing"),Ke=Symbol.for("immer-draftable"),M=Symbol.for("immer-state");function _(t,...s){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Y=Object.getPrototypeOf;function W(t){return!!t&&!!t[M]}function H(t){var s;return t?Pt(t)||Array.isArray(t)||!!t[Ke]||!!((s=t.constructor)!=null&&s[Ke])||te(t)||fe(t):!1}var Bs=Object.prototype.constructor.toString(),We=new WeakMap;function Pt(t){if(!t||typeof t!="object")return!1;const s=Object.getPrototypeOf(t);if(s===null||s===Object.prototype)return!0;const r=Object.hasOwnProperty.call(s,"constructor")&&s.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let a=We.get(r);return a===void 0&&(a=Function.toString.call(r),We.set(r,a)),a===Bs}function ce(t,s,r=!0){pe(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(n=>{s(n,t[n],t)}):t.forEach((a,n)=>s(n,a,t))}function pe(t){const s=t[M];return s?s.type_:Array.isArray(t)?1:te(t)?2:fe(t)?3:0}function Pe(t,s){return pe(t)===2?t.has(s):Object.prototype.hasOwnProperty.call(t,s)}function Tt(t,s,r){const a=pe(t);a===2?t.set(s,r):a===3?t.add(r):t[s]=r}function Vs(t,s){return t===s?t!==0||1/t===1/s:t!==t&&s!==s}function te(t){return t instanceof Map}function fe(t){return t instanceof Set}function V(t){return t.copy_||t.base_}function Te(t,s){if(te(t))return new Map(t);if(fe(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Pt(t);if(s===!0||s==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(t);delete a[M];let n=Reflect.ownKeys(a);for(let i=0;i<n.length;i++){const c=n[i],o=a[c];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(a[c]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[c]})}return Object.create(Y(t),a)}else{const a=Y(t);if(a!==null&&r)return{...t};const n=Object.create(a);return Object.assign(n,t)}}function De(t,s=!1){return ge(t)||W(t)||!H(t)||(pe(t)>1&&Object.defineProperties(t,{set:se,add:se,clear:se,delete:se}),Object.freeze(t),s&&Object.values(t).forEach(r=>De(r,!0))),t}function Hs(){_(2)}var se={value:Hs};function ge(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var qs={};function q(t){const s=qs[t];return s||_(0,t),s}var X;function It(){return X}function Us(t,s){return{drafts_:[],parent_:t,immer_:s,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ze(t,s){s&&(q("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=s)}function Ie(t){Me(t),t.drafts_.forEach(Gs),t.drafts_=null}function Me(t){t===X&&(X=t.parent_)}function Qe(t){return X=Us(X,t)}function Gs(t){const s=t[M];s.type_===0||s.type_===1?s.revoke_():s.revoked_=!0}function Ye(t,s){s.unfinalizedDrafts_=s.drafts_.length;const r=s.drafts_[0];return t!==void 0&&t!==r?(r[M].modified_&&(Ie(s),_(4)),H(t)&&(t=le(s,t),s.parent_||ie(s,t)),s.patches_&&q("Patches").generateReplacementPatches_(r[M].base_,t,s.patches_,s.inversePatches_)):t=le(s,r,[]),Ie(s),s.patches_&&s.patchListener_(s.patches_,s.inversePatches_),t!==Ct?t:void 0}function le(t,s,r){if(ge(s))return s;const a=t.immer_.shouldUseStrictIteration(),n=s[M];if(!n)return ce(s,(i,c)=>Xe(t,n,s,i,c,r),a),s;if(n.scope_!==t)return s;if(!n.modified_)return ie(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let c=i,o=!1;n.type_===3&&(c=new Set(i),i.clear(),o=!0),ce(c,(x,d)=>Xe(t,n,i,x,d,r,o),a),ie(t,i,!1),r&&t.patches_&&q("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Xe(t,s,r,a,n,i,c){if(n==null||typeof n!="object"&&!c)return;const o=ge(n);if(!(o&&!c)){if(W(n)){const x=i&&s&&s.type_!==3&&!Pe(s.assigned_,a)?i.concat(a):void 0,d=le(t,n,x);if(Tt(r,a,d),W(d))t.canAutoFreeze_=!1;else return}else c&&r.add(n);if(H(n)&&!o){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||s&&s.base_&&s.base_[a]===n&&o)return;le(t,n),(!s||!s.scope_.parent_)&&typeof a!="symbol"&&(te(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&ie(t,n)}}}function ie(t,s,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&De(s,r)}function Ks(t,s){const r=Array.isArray(t),a={type_:r?1:0,scope_:s?s.scope_:It(),modified_:!1,finalized_:!1,assigned_:{},parent_:s,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=a,i=Ee;r&&(n=[a],i=J);const{revoke:c,proxy:o}=Proxy.revocable(n,i);return a.draft_=o,a.revoke_=c,o}var Ee={get(t,s){if(s===M)return t;const r=V(t);if(!Pe(r,s))return Ws(t,r,s);const a=r[s];return t.finalized_||!H(a)?a:a===ke(t.base_,s)?(Se(t),t.copy_[s]=Fe(a,t)):a},has(t,s){return s in V(t)},ownKeys(t){return Reflect.ownKeys(V(t))},set(t,s,r){const a=Mt(V(t),s);if(a!=null&&a.set)return a.set.call(t.draft_,r),!0;if(!t.modified_){const n=ke(V(t),s),i=n==null?void 0:n[M];if(i&&i.base_===r)return t.copy_[s]=r,t.assigned_[s]=!1,!0;if(Vs(r,n)&&(r!==void 0||Pe(t.base_,s)))return!0;Se(t),_e(t)}return t.copy_[s]===r&&(r!==void 0||s in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[s])||(t.copy_[s]=r,t.assigned_[s]=!0),!0},deleteProperty(t,s){return ke(t.base_,s)!==void 0||s in t.base_?(t.assigned_[s]=!1,Se(t),_e(t)):delete t.assigned_[s],t.copy_&&delete t.copy_[s],!0},getOwnPropertyDescriptor(t,s){const r=V(t),a=Reflect.getOwnPropertyDescriptor(r,s);return a&&{writable:!0,configurable:t.type_!==1||s!=="length",enumerable:a.enumerable,value:r[s]}},defineProperty(){_(11)},getPrototypeOf(t){return Y(t.base_)},setPrototypeOf(){_(12)}},J={};ce(Ee,(t,s)=>{J[t]=function(){return arguments[0]=arguments[0][0],s.apply(this,arguments)}});J.deleteProperty=function(t,s){return J.set.call(this,t,s,void 0)};J.set=function(t,s,r){return Ee.set.call(this,t[0],s,r,t[0])};function ke(t,s){const r=t[M];return(r?V(r):t)[s]}function Ws(t,s,r){var n;const a=Mt(s,r);return a?"value"in a?a.value:(n=a.get)==null?void 0:n.call(t.draft_):void 0}function Mt(t,s){if(!(s in t))return;let r=Y(t);for(;r;){const a=Object.getOwnPropertyDescriptor(r,s);if(a)return a;r=Y(r)}}function _e(t){t.modified_||(t.modified_=!0,t.parent_&&_e(t.parent_))}function Se(t){t.copy_||(t.copy_=Te(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Zs=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(s,r,a)=>{if(typeof s=="function"&&typeof r!="function"){const i=r;r=s;const c=this;return function(x=i,...d){return c.produce(x,l=>r.call(this,l,...d))}}typeof r!="function"&&_(6),a!==void 0&&typeof a!="function"&&_(7);let n;if(H(s)){const i=Qe(this),c=Fe(s,void 0);let o=!0;try{n=r(c),o=!1}finally{o?Ie(i):Me(i)}return Ze(i,a),Ye(n,i)}else if(!s||typeof s!="object"){if(n=r(s),n===void 0&&(n=s),n===Ct&&(n=void 0),this.autoFreeze_&&De(n,!0),a){const i=[],c=[];q("Patches").generateReplacementPatches_(s,n,i,c),a(i,c)}return n}else _(1,s)},this.produceWithPatches=(s,r)=>{if(typeof s=="function")return(c,...o)=>this.produceWithPatches(c,x=>s(x,...o));let a,n;return[this.produce(s,r,(c,o)=>{a=c,n=o}),a,n]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){H(t)||_(8),W(t)&&(t=Qs(t));const s=Qe(this),r=Fe(t,void 0);return r[M].isManual_=!0,Me(s),r}finishDraft(t,s){const r=t&&t[M];(!r||!r.isManual_)&&_(9);const{scope_:a}=r;return Ze(a,s),Ye(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,s){let r;for(r=s.length-1;r>=0;r--){const n=s[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(s=s.slice(r+1));const a=q("Patches").applyPatches_;return W(t)?a(t,s):this.produce(t,n=>a(n,s))}};function Fe(t,s){const r=te(t)?q("MapSet").proxyMap_(t,s):fe(t)?q("MapSet").proxySet_(t,s):Ks(t,s);return(s?s.scope_:It()).drafts_.push(r),r}function Qs(t){return W(t)||_(10,t),_t(t)}function _t(t){if(!H(t)||ge(t))return t;const s=t[M];let r,a=!0;if(s){if(!s.modified_)return s.base_;s.finalized_=!0,r=Te(t,s.scope_.immer_.useStrictShallowCopy_),a=s.scope_.immer_.shouldUseStrictIteration()}else r=Te(t,!0);return ce(r,(n,i)=>{Tt(r,n,_t(i))},a),s&&(s.finalized_=!1),r}var Ys=new Zs,Xs=Ys.produce;const Js=t=>(s,r,a)=>(a.setState=(n,i,...c)=>{const o=typeof n=="function"?Xs(n):n;return s(o,i,...c)},t(a.setState,r,a)),er=Js;function ee(t,s){if(Object.is(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;if(t instanceof Map&&s instanceof Map){if(t.size!==s.size)return!1;for(const[a,n]of t)if(!Object.is(n,s.get(a)))return!1;return!0}if(t instanceof Set&&s instanceof Set){if(t.size!==s.size)return!1;for(const a of t)if(!s.has(a))return!1;return!0}const r=Object.keys(t);if(r.length!==Object.keys(s).length)return!1;for(const a of r)if(!Object.prototype.hasOwnProperty.call(s,a)||!Object.is(t[a],s[a]))return!1;return!0}const Je=1e5,et=5e4,tt=1e4,tr={packets:{total:0,tcp:0,udp:0,icmp:0,other:0},bytes:{total:0,inbound:0,outbound:0},flows:{total:0,active:0,completed:0},protocols:{},topTalkers:[],topPorts:[]},sr={isCapturing:!1,interface:"",startTime:0,packetsCaptured:0,packetsDropped:0,bytesProcessed:0,flowsActive:0,alertsGenerated:0},st={activeView:"dashboard",selectedPacketId:null,selectedFlowId:null,selectedFileId:null,selectedAlertId:null,filters:{search:"",protocols:[],severities:[],srcIP:"",dstIP:"",port:null,minBytes:null,maxBytes:null},timeRange:{start:null,end:null,relative:"all"}},y=Rs()(er(t=>({packets:new Map,packetIds:[],flows:new Map,flowIds:[],files:new Map,alerts:new Map,alertIds:[],topology:{nodes:[],links:[]},statistics:tr,capture:sr,view:st,_packetVersion:0,_flowVersion:0,_alertVersion:0,_filterVersion:0,addPackets:s=>t(r=>{for(const a of s)r.packets.set(a.id,a),r.packetIds.push(a.id);if(r.packetIds.length>Je){const a=r.packetIds.splice(0,r.packetIds.length-Je);for(const n of a)r.packets.delete(n)}r._packetVersion++}),clearPackets:()=>t(s=>{s.packets.clear(),s.packetIds=[],s._packetVersion++}),updateFlows:s=>t(r=>{for(const a of s)r.flows.has(a.id)||r.flowIds.push(a.id),r.flows.set(a.id,a);if(r.flowIds.length>et){const a=r.flowIds.splice(0,r.flowIds.length-et);for(const n of a)r.flows.delete(n)}r._flowVersion++}),clearFlows:()=>t(s=>{s.flows.clear(),s.flowIds=[],s._flowVersion++}),addFile:s=>t(r=>{r.files.set(s.id,s)}),clearFiles:()=>t(s=>{s.files.clear()}),addAlert:s=>t(r=>{if(r.alerts.set(s.id,s),r.alertIds.unshift(s.id),r.alertIds.length>tt){const a=r.alertIds.splice(tt);for(const n of a)r.alerts.delete(n)}r._alertVersion++}),clearAlerts:()=>t(s=>{s.alerts.clear(),s.alertIds=[],s._alertVersion++}),acknowledgeAlert:s=>t(r=>{const a=r.alerts.get(s);a&&(r.alerts.set(s,{...a,acknowledged:!0,acknowledgedAt:Date.now()*1e6}),r._alertVersion++)}),updateStatistics:s=>t(r=>{r.statistics=s}),updateTopology:s=>t(r=>{r.topology=s}),updateCaptureState:s=>t(r=>{Object.assign(r.capture,s)}),startCapture:s=>t(r=>{r.capture.isCapturing=!0,r.capture.interface=s,r.capture.startTime=Date.now(),r.capture.packetsCaptured=0,r.capture.packetsDropped=0,r.capture.bytesProcessed=0}),stopCapture:()=>t(s=>{s.capture.isCapturing=!1}),setActiveView:s=>t(r=>{r.view.activeView=s}),selectPacket:s=>t(r=>{r.view.selectedPacketId=s}),selectFlow:s=>t(r=>{r.view.selectedFlowId=s}),selectFile:s=>t(r=>{r.view.selectedFileId=s}),selectAlert:s=>t(r=>{r.view.selectedAlertId=s}),setFilter:s=>t(r=>{Object.assign(r.view.filters,s),r._filterVersion++}),clearFilters:()=>t(s=>{s.view.filters=st.filters,s._filterVersion++}),setTimeRange:s=>t(r=>{r.view.timeRange=s,r._filterVersion++})})));function rr(){const t=y(o=>o.packets),s=y(o=>o.packetIds),r=y(o=>o.view.filters,ee),a=y(o=>o.view.timeRange,ee),n=y(o=>o._packetVersion),i=y(o=>o._filterVersion),c=m.useRef({packetVersion:-1,filterVersion:-1,result:[]});return m.useMemo(()=>{if(c.current.packetVersion===n&&c.current.filterVersion===i)return c.current.result;let o=s.map(x=>t.get(x)).filter(x=>x!==void 0);if(r.search){const x=r.search.toLowerCase();o=o.filter(d=>d.srcIP.includes(x)||d.dstIP.includes(x)||d.protocol.toLowerCase().includes(x))}if(r.protocols.length>0&&(o=o.filter(x=>r.protocols.includes(x.protocol))),r.srcIP&&(o=o.filter(x=>x.srcIP.includes(r.srcIP))),r.dstIP&&(o=o.filter(x=>x.dstIP.includes(r.dstIP))),r.port!==null&&(o=o.filter(x=>x.srcPort===r.port||x.dstPort===r.port)),a.start!==null){const x=a.start;o=o.filter(d=>d.timestampNano>=x)}if(a.end!==null){const x=a.end;o=o.filter(d=>d.timestampNano<=x)}return c.current={packetVersion:n,filterVersion:i,result:o},o},[t,s,r,a,n,i])}function ar(){const t=y(c=>c.flows),s=y(c=>c.flowIds),r=y(c=>c.view.filters,ee),a=y(c=>c._flowVersion),n=y(c=>c._filterVersion),i=m.useRef({flowVersion:-1,filterVersion:-1,result:[]});return m.useMemo(()=>{if(i.current.flowVersion===a&&i.current.filterVersion===n)return i.current.result;let c=s.map(o=>t.get(o)).filter(o=>o!==void 0);if(r.search){const o=r.search.toLowerCase();c=c.filter(x=>{var d,l;return x.srcIP.includes(o)||x.dstIP.includes(o)||x.protocol.toLowerCase().includes(o)||((d=x.metadata.serverName)==null?void 0:d.toLowerCase().includes(o))||((l=x.metadata.httpHost)==null?void 0:l.toLowerCase().includes(o))})}if(r.protocols.length>0&&(c=c.filter(o=>r.protocols.includes(o.protocol))),r.minBytes!==null){const o=r.minBytes;c=c.filter(x=>x.byteCount>=o)}if(r.maxBytes!==null){const o=r.maxBytes;c=c.filter(x=>x.byteCount<=o)}return i.current={flowVersion:a,filterVersion:n,result:c},c},[t,s,r,a,n])}function nr(){const t=y(c=>c.alerts),s=y(c=>c.alertIds),r=y(c=>c.view.filters,ee),a=y(c=>c._alertVersion),n=y(c=>c._filterVersion),i=m.useRef({alertVersion:-1,filterVersion:-1,result:[]});return m.useMemo(()=>{if(i.current.alertVersion===a&&i.current.filterVersion===n)return i.current.result;let c=s.map(o=>t.get(o)).filter(o=>o!==void 0);if(r.severities.length>0&&(c=c.filter(o=>r.severities.includes(o.severity))),r.search){const o=r.search.toLowerCase();c=c.filter(x=>x.title.toLowerCase().includes(o)||x.description.toLowerCase().includes(o))}return i.current={alertVersion:a,filterVersion:n,result:c},c},[t,s,r,a,n])}const Ft=()=>y(t=>t.packetIds.length),At=()=>y(t=>t.flowIds.length),Dt=()=>y(t=>t.alertIds.length),$e=()=>y(t=>t.capture),Le=()=>y(t=>t.statistics),Et=()=>y(t=>t.view.activeView),cr=()=>y(t=>t.view.filters,ee);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=(t,s)=>{const r=m.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:o="",children:x,...d},l)=>m.createElement("svg",{ref:l,...lr,width:n,height:n,stroke:a,strokeWidth:c?Number(i)*24/Number(n):i,className:["lucide",`lucide-${ir(t)}`,o].join(" "),...d},[...s.map(([h,g])=>m.createElement(h,g)),...Array.isArray(x)?x:[x]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=f("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=f("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=f("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=f("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=f("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=f("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=f("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=f("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=f("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=f("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=f("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=f("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=f("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=f("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=f("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=f("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=f("FileArchive",[["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v18",key:"1oywqq"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=f("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=f("FileCode",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=f("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=f("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=f("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=f("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=f("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=f("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=f("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=f("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=f("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=f("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=f("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=f("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=f("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=f("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=f("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=f("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=f("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=f("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=f("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=f("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=f("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=f("Router",[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=f("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=f("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=f("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=f("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=f("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=f("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=f("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=f("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=f("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=f("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=f("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=f("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=f("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=f("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=f("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=f("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Er=[{id:"dashboard",label:"Dashboard",icon:jr},{id:"packets",label:"Packets",icon:je,badgeKey:"packets"},{id:"flows",label:"Flows",icon:Vt,badgeKey:"flows"},{id:"files",label:"Files",icon:Ae},{id:"alerts",label:"Alerts",icon:T,badgeKey:"alerts",badgeColor:"bg-threat-critical"},{id:"topology",label:"Topology",icon:Nr}];function $r(){const t=Et(),s=y(x=>x.setActiveView),[r,a]=m.useState(!1),n=Ft(),i=At(),c=Dt(),o={packets:n,flows:i,alerts:c};return e.jsxs("aside",{className:j("h-full bg-surface-raised border-r border-surface-border flex flex-col transition-all duration-300",r?"w-16":"w-56"),children:[e.jsx("nav",{className:"flex-1 py-4",children:e.jsx("ul",{className:"space-y-1 px-2",children:Er.map(x=>e.jsx(Lr,{item:x,isActive:t===x.id,collapsed:r,onClick:()=>s(x.id),badgeCount:x.badgeKey?o[x.badgeKey]:0},x.id))})}),e.jsx("div",{className:"p-2 border-t border-surface-border",children:e.jsx("button",{onClick:()=>a(!r),className:"w-full btn-icon flex items-center justify-center",children:r?e.jsx($t,{className:"w-5 h-5 text-gray-400"}):e.jsx(dr,{className:"w-5 h-5 text-gray-400"})})})]})}function Lr({item:t,isActive:s,collapsed:r,onClick:a,badgeCount:n}){const i=t.icon;return e.jsx("li",{children:e.jsxs("button",{onClick:a,className:j("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200","hover:bg-surface-overlay group",s&&"bg-cyber-900/30 border-l-2 border-l-cyber-500 text-cyber-400",!s&&"text-gray-400 hover:text-white"),children:[e.jsx(i,{className:j("w-5 h-5 flex-shrink-0 transition-colors",s?"text-cyber-400":"text-gray-500 group-hover:text-gray-300")}),!r&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1 text-left text-sm font-medium",children:t.label}),n>0&&e.jsx("span",{className:j("px-2 py-0.5 rounded-full text-xs font-medium",t.badgeColor||"bg-cyber-600","text-white"),children:n>999?"999+":n})]}),r&&n>0&&e.jsx("span",{className:j("absolute right-1 top-1 w-2 h-2 rounded-full",t.badgeColor||"bg-cyber-500")})]})})}function zr(){const t=$e(),s=Le(),{startCapture:r,stopCapture:a,setFilter:n}=y(),[i,c]=m.useState(""),o=h=>{h.preventDefault(),n({search:i})},x=()=>{t.isCapturing?a():r("eth0")},d=h=>{if(h===0)return"0 B";const g=1024,N=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(h)/Math.log(g));return parseFloat((h/Math.pow(g,k)).toFixed(2))+" "+N[k]},l=h=>h>=1e6?(h/1e6).toFixed(1)+"M":h>=1e3?(h/1e3).toFixed(1)+"K":h.toString();return e.jsxs("header",{className:"h-14 bg-surface-raised border-b border-surface-border flex items-center px-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyber-500 to-cyber-700 flex items-center justify-center",children:e.jsx(oe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-lg font-bold text-gradient-cyber",children:"NFA-Linux"}),e.jsx("p",{className:"text-xxs text-gray-500 -mt-1",children:"Network Forensics Analyzer"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{onClick:x,className:`btn ${t.isCapturing?"btn-danger":"btn-primary"} flex items-center gap-2`,children:t.isCapturing?e.jsxs(e.Fragment,{children:[e.jsx(Pr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Stop"})]}):e.jsxs(e.Fragment,{children:[e.jsx(wr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Capture"})]})}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[t.isCapturing?e.jsx(be,{className:"w-4 h-4 text-green-500 animate-pulse"}):e.jsx(_r,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-xs text-gray-400",children:t.isCapturing?t.interface:"Idle"})]})]}),e.jsx("form",{onSubmit:o,className:"flex-1 max-w-md mx-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:i,onChange:h=>c(h.target.value),placeholder:"Search packets, flows, IPs...",className:"input w-full pl-10 pr-4"})]})}),e.jsxs("div",{className:"hidden lg:flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[e.jsx(Z,{className:"w-4 h-4 text-cyber-400"}),e.jsx("span",{className:"text-gray-400",children:"Packets:"}),e.jsx("span",{className:"text-white font-mono",children:l(s.packets.total)})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[e.jsx(Lt,{className:"w-4 h-4 text-protocol-tcp"}),e.jsx("span",{className:"text-gray-400",children:"Flows:"}),e.jsx("span",{className:"text-white font-mono",children:l(s.flows.active)})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[e.jsx(oe,{className:"w-4 h-4 text-protocol-udp"}),e.jsx("span",{className:"text-gray-400",children:"Data:"}),e.jsx("span",{className:"text-white font-mono",children:d(s.bytes.total)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"btn-icon relative",children:[e.jsx(or,{className:"w-5 h-5 text-gray-400"}),s.flows.total>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-threat-critical text-white text-xxs rounded-full flex items-center justify-center",children:"!"})]}),e.jsx("button",{className:"btn-icon",children:e.jsx(Cr,{className:"w-5 h-5 text-gray-400"})})]})]})}function Or(){const t=$e(),s=Le(),[r,a]=m.useState(new Date),[n,i]=m.useState(0),[c,o]=m.useState(0);m.useEffect(()=>{const h=setInterval(()=>{a(new Date)},1e3);return()=>clearInterval(h)},[]),m.useEffect(()=>{const h=setInterval(()=>{const g=s.packets.total-c;i(g),o(s.packets.total)},1e3);return()=>clearInterval(h)},[s.packets.total,c]);const x=()=>{if(!t.isCapturing||t.startTime===0)return"00:00:00";const h=Math.floor((Date.now()-t.startTime)/1e3),g=Math.floor(h/3600),N=Math.floor(h%3600/60),k=h%60;return`${g.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`},d=h=>{if(h===0)return"0 B";const g=1024,N=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(h)/Math.log(g));return parseFloat((h/Math.pow(g,k)).toFixed(2))+" "+N[k]},l=()=>t.packetsCaptured===0?"0%":(t.packetsDropped/t.packetsCaptured*100).toFixed(2)+"%";return e.jsxs("footer",{className:"h-7 bg-surface-raised border-t border-surface-border flex items-center px-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`status-dot ${t.isCapturing?"status-dot-active":"status-dot-inactive"}`}),e.jsx("span",{children:t.isCapturing?"Capturing":"Idle"})]}),t.interface&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsx("span",{children:t.interface})]}),t.isCapturing&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3"}),e.jsx("span",{className:"font-mono",children:x()})]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fr,{className:"w-3 h-3 text-cyber-400"}),e.jsx("span",{className:"font-mono",children:n.toLocaleString()}),e.jsx("span",{className:"text-gray-600",children:"pps"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3 text-protocol-tcp"}),e.jsx("span",{className:"font-mono",children:s.packets.total.toLocaleString()}),e.jsx("span",{className:"text-gray-600",children:"packets"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Lt,{className:"w-3 h-3 text-protocol-udp"}),e.jsx("span",{className:"font-mono",children:d(s.bytes.total)})]}),t.isCapturing&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-600",children:"Drops:"}),e.jsx("span",{className:`font-mono ${t.packetsDropped>0?"text-threat-medium":"text-green-500"}`,children:l()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("span",{className:"font-mono text-gray-400",children:r.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]})}const Rr={cyber:{bg:"bg-cyber-500/10",icon:"text-cyber-400",border:"border-cyber-500/30"},blue:{bg:"bg-blue-500/10",icon:"text-blue-400",border:"border-blue-500/30"},green:{bg:"bg-green-500/10",icon:"text-green-400",border:"border-green-500/30"},red:{bg:"bg-red-500/10",icon:"text-red-400",border:"border-red-500/30"},gray:{bg:"bg-gray-500/10",icon:"text-gray-400",border:"border-gray-500/30"}};function ae({title:t,value:s,subtitle:r,icon:a,trend:n,trendValue:i,color:c="cyber",highlight:o=!1}){const x=Rr[c];return e.jsx("div",{className:j("panel p-4 transition-all duration-300",o&&"glow-threat animate-pulse-slow"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:t}),e.jsx("p",{className:"text-2xl font-bold text-white font-mono",children:s}),r&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r}),n&&i&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[n==="up"?e.jsx(Mr,{className:"w-3 h-3 text-green-500"}):e.jsx(Ir,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:j("text-xs",n==="up"?"text-green-500":"text-red-500"),children:i})]})]}),e.jsx("div",{className:j("p-3 rounded-lg",x.bg),children:e.jsx(a,{className:j("w-6 h-6",x.icon)})})]})})}const at={TCP:"#3b82f6",UDP:"#22c55e",ICMP:"#f97316",DNS:"#8b5cf6",HTTP:"#06b6d4",HTTPS:"#10b981",TLS:"#10b981",SMB:"#f59e0b",QUIC:"#ec4899",SSH:"#6366f1",FTP:"#84cc16",Other:"#6b7280"};function Br({protocols:t}){const s=Object.entries(t).map(([i,c])=>({name:i,value:c})).sort((i,c)=>c.value-i.value).slice(0,8);if(s.length===0)return e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsx("p",{children:"No protocol data available"})});const r=s.reduce((i,c)=>i+c.value,0),a=({active:i,payload:c})=>{if(i&&c&&c.length){const o=c[0],x=o.value??0,d=(x/r*100).toFixed(1);return e.jsxs("div",{className:"bg-surface-overlay border border-surface-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:o.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[x.toLocaleString()," packets (",d,"%)"]})]})}return null},n=i=>{const{payload:c}=i;return c?e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-4",children:c.map((o,x)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:o.color}}),e.jsx("span",{className:"text-xs text-gray-400",children:o.value})]},x))}):null};return e.jsx(gt,{width:"100%",height:"100%",children:e.jsxs(Zt,{children:[e.jsx(Qt,{data:s,cx:"50%",cy:"45%",innerRadius:60,outerRadius:90,paddingAngle:2,dataKey:"value",animationBegin:0,animationDuration:800,children:s.map((i,c)=>e.jsx(Yt,{fill:at[i.name]||at.Other,stroke:"transparent"},`cell-${c}`))}),e.jsx(yt,{content:e.jsx(a,{})}),e.jsx(Xt,{content:n})]})})}function Vr(){const[t,s]=m.useState([]),r=m.useRef();m.useEffect(()=>{const n=[],i=Date.now();for(let c=60;c>=0;c--){const o=i-c*5e3;n.push({time:new Date(o).toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"}),timestamp:o,packets:Math.floor(Math.random()*1e3),bytes:Math.floor(Math.random()*1e5),tcp:Math.floor(Math.random()*700),udp:Math.floor(Math.random()*300)})}return s(n),r.current=setInterval(()=>{s(c=>{const o={time:new Date().toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"}),timestamp:Date.now(),packets:Math.floor(Math.random()*1e3),bytes:Math.floor(Math.random()*1e5),tcp:Math.floor(Math.random()*700),udp:Math.floor(Math.random()*300)};return[...c.slice(1),o]})},5e3),()=>{r.current&&clearInterval(r.current)}},[]);const a=({active:n,payload:i,label:c})=>{var o,x,d,l;return n&&i&&i.length?e.jsxs("div",{className:"bg-surface-overlay border border-surface-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:c}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-protocol-tcp",children:"TCP: "}),e.jsx("span",{className:"font-mono text-white",children:(x=(o=i[0])==null?void 0:o.value)==null?void 0:x.toLocaleString()})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-protocol-udp",children:"UDP: "}),e.jsx("span",{className:"font-mono text-white",children:(l=(d=i[1])==null?void 0:d.value)==null?void 0:l.toLocaleString()})]})]})]}):null};return t.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsx("p",{children:"Loading timeline data..."})}):e.jsx(gt,{width:"100%",height:"100%",children:e.jsxs(Jt,{data:t,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"tcpGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"udpGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#22c55e",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#22c55e",stopOpacity:0})]})]}),e.jsx(es,{strokeDasharray:"3 3",stroke:"#2a2a3a",vertical:!1}),e.jsx(ts,{dataKey:"time",stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:10},tickLine:{stroke:"#2a2a3a"},axisLine:{stroke:"#2a2a3a"},interval:"preserveStartEnd"}),e.jsx(ss,{stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:10},tickLine:{stroke:"#2a2a3a"},axisLine:{stroke:"#2a2a3a"},tickFormatter:n=>n.toLocaleString()}),e.jsx(yt,{content:e.jsx(a,{})}),e.jsx(Be,{type:"monotone",dataKey:"tcp",stackId:"1",stroke:"#3b82f6",strokeWidth:2,fill:"url(#tcpGradient)",animationDuration:300}),e.jsx(Be,{type:"monotone",dataKey:"udp",stackId:"1",stroke:"#22c55e",strokeWidth:2,fill:"url(#udpGradient)",animationDuration:300})]})})}function Hr({talkers:t}){const s=a=>{if(a===0)return"0 B";const n=1024,i=["B","KB","MB","GB"],c=Math.floor(Math.log(a)/Math.log(n));return parseFloat((a/Math.pow(n,c)).toFixed(1))+" "+i[c]};if(t.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-4",children:e.jsx("p",{className:"text-sm",children:"No traffic data yet"})});const r=Math.max(...t.map(a=>a.bytes));return e.jsx("div",{className:"space-y-3",children:t.slice(0,5).map((a,n)=>{const i=a.bytes/r*100;return e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:j("w-5 h-5 rounded text-xs font-medium flex items-center justify-center",n===0&&"bg-cyber-600 text-white",n===1&&"bg-cyber-700 text-white",n===2&&"bg-cyber-800 text-white",n>2&&"bg-surface-overlay text-gray-400"),children:n+1}),e.jsx("span",{className:"font-mono text-sm text-gray-300 group-hover:text-white transition-colors",children:a.ip})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[a.packets.toLocaleString()," pkts"]}),e.jsx("span",{className:"text-xs text-gray-600 mx-1",children:""}),e.jsx("span",{className:"text-xs font-mono text-gray-400",children:s(a.bytes)})]})]}),e.jsx("div",{className:"h-1.5 bg-surface-overlay rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyber-600 to-cyber-400 rounded-full transition-all duration-500",style:{width:`${i}%`}})})]},a.ip)})})}const qr={critical:{color:"text-threat-critical",bg:"bg-threat-critical/10"},high:{color:"text-threat-high",bg:"bg-threat-high/10"},medium:{color:"text-threat-medium",bg:"bg-threat-medium/10"},low:{color:"text-threat-low",bg:"bg-threat-low/10"},info:{color:"text-threat-info",bg:"bg-threat-info/10"}},Ur={malware:Oe,c2:be,exfiltration:B,lateral_movement:R,credential_access:R,reconnaissance:B,anomaly:T,policy_violation:R,suspicious:T};function Gr(){const t=y(i=>i.alertIds.slice(0,5).map(c=>i.alerts.get(c)).filter(Boolean)),s=y(i=>i.selectAlert),r=y(i=>i.setActiveView),a=i=>{s(i.id),r("alerts")},n=i=>new Date(i/1e6).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});return t.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-4",children:[e.jsx(R,{className:"w-8 h-8 mx-auto mb-2 text-green-500/50"}),e.jsx("p",{className:"text-sm",children:"No alerts detected"})]}):e.jsx("div",{className:"space-y-2",children:t.map(i=>{const c=qr[i.severity],o=Ur[i.category]||T;return e.jsx("button",{onClick:()=>a(i),className:j("w-full p-3 rounded-lg text-left transition-all duration-200","hover:bg-surface-overlay group",c.bg),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:j("p-1.5 rounded",c.bg),children:e.jsx(o,{className:j("w-4 h-4",c.color)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:j("text-sm font-medium truncate",c.color),children:i.title}),e.jsx("span",{className:"text-xxs text-gray-500 flex-shrink-0",children:n(i.timestampNano)})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:i.description}),i.sourceIP&&e.jsxs("p",{className:"text-xxs text-gray-600 font-mono mt-1",children:[i.sourceIP,"  ",i.destIP]})]})]})},i.id)})})}const Kr={packet:"text-protocol-tcp",flow:"text-protocol-udp",alert:"text-threat-high",file:"text-cyber-400"},Wr={packet:"PKT",flow:"FLW",alert:"ALT",file:"FIL"};function Zr(){const[t,s]=m.useState([]),r=m.useRef(null);m.useEffect(()=>{const n=["TCP","UDP","DNS","HTTP","HTTPS","SMB","QUIC"],i=["packet","flow","packet","packet","flow","alert"],c=()=>{const d=i[Math.floor(Math.random()*i.length)],l=n[Math.floor(Math.random()*n.length)],h=`192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,g=`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`;let N="";switch(d){case"packet":N=`${l} ${h}:${Math.floor(Math.random()*65535)}  ${g}:${Math.floor(Math.random()*1024)}`;break;case"flow":N=`New ${l} flow established`;break;case"alert":N=`Suspicious ${l} activity detected`;break;case"file":N=`File extracted from ${l} stream`;break}return{id:Math.random().toString(36).substr(2,9),timestamp:Date.now(),type:d,message:N,protocol:l,srcIP:h,dstIP:g}},o=[];for(let d=0;d<10;d++)o.push(c());s(o);const x=setInterval(()=>{s(d=>[c(),...d.slice(0,19)])},500);return()=>clearInterval(x)},[]);const a=n=>new Date(n).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.jsx("div",{ref:r,className:"h-full overflow-hidden font-mono text-xs",children:e.jsx("div",{className:"space-y-0.5",children:t.map((n,i)=>e.jsxs("div",{className:j("flex items-center gap-2 py-0.5 px-1 rounded transition-all duration-300","hover:bg-surface-overlay",i===0&&"animate-pulse bg-surface-overlay/50"),children:[e.jsx("span",{className:"text-gray-600 w-20 flex-shrink-0",children:a(n.timestamp)}),e.jsx("span",{className:j("w-8 flex-shrink-0 font-semibold",Kr[n.type]),children:Wr[n.type]}),e.jsx("span",{className:"text-gray-400 truncate",children:n.message})]},n.id))})})}function nt(){const t=Le(),s=$e(),r=Ft();At();const a=Dt(),n=i=>{if(i===0)return"0 B";const c=1024,o=["B","KB","MB","GB","TB"],x=Math.floor(Math.log(i)/Math.log(c));return parseFloat((i/Math.pow(c,x)).toFixed(2))+" "+o[x]};return e.jsxs("div",{className:"h-full overflow-auto p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(ae,{title:"Total Packets",value:r.toLocaleString(),icon:je,trend:s.isCapturing?"up":void 0,trendValue:s.isCapturing?"+"+t.packets.tcp+"/s":void 0,color:"cyber"}),e.jsx(ae,{title:"Active Flows",value:t.flows.active.toLocaleString(),subtitle:`${t.flows.completed.toLocaleString()} completed`,icon:Vt,color:"blue"}),e.jsx(ae,{title:"Data Processed",value:n(t.bytes.total),subtitle:` ${n(t.bytes.outbound)}  ${n(t.bytes.inbound)}`,icon:oe,color:"green"}),e.jsx(ae,{title:"Alerts",value:a.toString(),icon:T,color:a>0?"red":"gray",highlight:a>0})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{className:"panel-title",children:"Traffic Timeline"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-xs text-gray-500",children:"Last 5 minutes"})})]}),e.jsx("div",{className:"panel-content h-64",children:e.jsx(Vr,{})})]}),e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h2",{className:"panel-title",children:"Protocol Distribution"})}),e.jsx("div",{className:"panel-content h-64",children:e.jsx(Br,{protocols:t.protocols})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{className:"panel-title",children:"Live Activity"}),e.jsx("div",{className:"status-dot status-dot-active"})]}),e.jsx("div",{className:"panel-content h-48 overflow-hidden",children:e.jsx(Zr,{})})]}),e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h2",{className:"panel-title",children:"Top Talkers"})}),e.jsx("div",{className:"panel-content",children:e.jsx(Hr,{talkers:t.topTalkers})})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{className:"panel-title",children:"Recent Alerts"}),a>0&&e.jsx("span",{className:"badge badge-threat-critical",children:a})]}),e.jsx("div",{className:"panel-content",children:e.jsx(Gr,{})})]})]})]})]})}const ct={TCP:"badge-protocol-tcp",UDP:"badge-protocol-udp",ICMP:"badge-protocol-icmp",ICMPv6:"badge-protocol-icmp",DNS:"badge-protocol-dns",HTTP:"badge-protocol-http",HTTPS:"badge-protocol-https",TLS:"badge-protocol-https",SMB:"badge-protocol-smb",QUIC:"badge-protocol-quic",HTTP3:"badge-protocol-quic",FTP:"badge-protocol-http",SSH:"badge-protocol-dns",SMTP:"badge-protocol-http",IMAP:"badge-protocol-http",POP3:"badge-protocol-http",ARP:"badge-protocol-icmp",DHCP:"badge-protocol-udp",NTP:"badge-protocol-udp",Unknown:"bg-gray-500/20 text-gray-400"},lt=32;function Qr(){const t=m.useRef(null),s=rr(),r=y(d=>d.view.selectedPacketId),a=y(d=>d.selectPacket),n=he({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>lt,overscan:20}),i=n.getVirtualItems(),c=m.useCallback(d=>new Date(d/1e6).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),[]),o=m.useCallback(d=>{a(d.id)},[a]),x=m.useCallback(d=>{if(!r)return;const l=s.findIndex(h=>h.id===r);l!==-1&&(d.key==="ArrowDown"&&l<s.length-1?(d.preventDefault(),a(s[l+1].id),n.scrollToIndex(l+1)):d.key==="ArrowUp"&&l>0&&(d.preventDefault(),a(s[l-1].id),n.scrollToIndex(l-1)))},[r,s,a,n]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-12 px-2 py-2 text-center",children:"#"}),e.jsx("div",{className:"w-24 px-2 py-2",children:"Time"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Source"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Destination"}),e.jsx("div",{className:"w-20 px-2 py-2",children:"Protocol"}),e.jsx("div",{className:"w-20 px-2 py-2 text-right",children:"Length"}),e.jsx("div",{className:"w-48 px-2 py-2",children:"Info"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto focus:outline-none",tabIndex:0,onKeyDown:x,children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:i.map(d=>{const l=s[d.index],h=l.id===r;return e.jsxs("div",{"data-index":d.index,ref:n.measureElement,className:j("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",h&&"table-row-selected bg-cyber-900/30"),style:{height:`${lt}px`,transform:`translateY(${d.start}px)`},onClick:()=>o(l),children:[e.jsx("div",{className:"w-12 px-2 text-center text-xs text-gray-600 font-mono",children:d.index+1}),e.jsx("div",{className:"w-24 px-2 text-xs font-mono text-gray-400",children:c(l.timestampNano)}),e.jsxs("div",{className:"flex-1 px-2 text-xs font-mono text-gray-300 truncate",children:[l.srcIP,l.srcPort>0&&e.jsxs("span",{className:"text-gray-500",children:[":",l.srcPort]})]}),e.jsxs("div",{className:"flex-1 px-2 text-xs font-mono text-gray-300 truncate",children:[l.dstIP,l.dstPort>0&&e.jsxs("span",{className:"text-gray-500",children:[":",l.dstPort]})]}),e.jsx("div",{className:"w-20 px-2",children:e.jsx("span",{className:j("badge",ct[l.protocol]||ct.Unknown),children:l.protocol})}),e.jsx("div",{className:"w-20 px-2 text-xs font-mono text-gray-400 text-right",children:l.length}),e.jsx("div",{className:"w-48 px-2 text-xs text-gray-500 truncate",children:Yr(l)})]},d.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," packets",r&&e.jsxs("span",{className:"ml-2",children:[" Selected: #",s.findIndex(d=>d.id===r)+1]})]})]})}function Yr(t){for(const s of t.layers){if(s.name==="DNS"&&s.fields){const r=s.fields.queryName;if(r)return`Query: ${r}`}if(s.name==="HTTP"&&s.fields){const r=s.fields.method,a=s.fields.uri;if(r&&a)return`${r} ${a}`}if(s.name==="TLS"&&s.fields){const r=s.fields.serverName;if(r)return`SNI: ${r}`}}switch(t.protocol){case"TCP":return`${t.srcPort}  ${t.dstPort}`;case"UDP":return`${t.srcPort}  ${t.dstPort}`;case"ICMP":case"ICMPv6":return"Echo request/reply";default:return""}}function Xr({packet:t}){const[s,r]=m.useState(new Set(["Ethernet","IPv4","IPv6","TCP","UDP"])),[a,n]=m.useState(null),i=d=>{r(l=>{const h=new Set(l);return h.has(d)?h.delete(d):h.add(d),h})},c=async(d,l)=>{await navigator.clipboard.writeText(d),n(l),setTimeout(()=>n(null),2e3)},o=d=>new Date(d/1e6).toISOString(),x=d=>d==null?"null":typeof d=="boolean"?d?"true":"false":typeof d=="number"?d.toString():typeof d=="string"?d:Array.isArray(d)?d.join(", "):typeof d=="object"?JSON.stringify(d):String(d);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Packet Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Timestamp:"}),e.jsx("span",{className:"ml-2 font-mono text-gray-300",children:o(t.timestampNano)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Length:"}),e.jsxs("span",{className:"ml-2 font-mono text-gray-300",children:[t.length," bytes"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Protocol:"}),e.jsx("span",{className:"ml-2 font-mono text-gray-300",children:t.protocol})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Interface:"}),e.jsx("span",{className:"ml-2 font-mono text-gray-300",children:t.metadata.captureInterface})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Protocol Layers"}),t.layers.map((d,l)=>{const h=s.has(d.name),g=Object.entries(d.fields||{});return e.jsxs("div",{className:"border border-surface-border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>i(d.name),className:"w-full flex items-center justify-between px-3 py-2 bg-surface-overlay hover:bg-surface-border transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h?e.jsx(de,{className:"w-4 h-4 text-gray-500"}):e.jsx($t,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-cyber-400",children:d.name})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[d.length," bytes @ offset ",d.offset]})]}),h&&g.length>0&&e.jsx("div",{className:"px-3 py-2 space-y-1 bg-surface",children:g.map(([N,k])=>e.jsxs("div",{className:"flex items-center justify-between group text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[Jr(N),":"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300 max-w-48 truncate",children:x(k)}),e.jsx("button",{onClick:()=>c(x(k),N),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:a===N?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]})]},N))})]},`${d.name}-${l}`)})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Metadata"}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Direction:"}),e.jsx("span",{className:"text-gray-300",children:t.metadata.direction})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Checksum Valid:"}),e.jsx("span",{className:t.metadata.checksumValid?"text-green-400":"text-red-400",children:t.metadata.checksumValid?"Yes":"No"})]}),t.metadata.vlanId&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"VLAN ID:"}),e.jsx("span",{className:"text-gray-300",children:t.metadata.vlanId})]}),t.metadata.truncated&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Truncated:"}),e.jsx("span",{className:"text-yellow-400",children:"Yes"})]})]})]})]})}function Jr(t){return t.replace(/([A-Z])/g," $1").replace(/^./,s=>s.toUpperCase()).trim()}const U=16;function ea({data:t,highlightRanges:s=[],onByteSelect:r,selectedOffset:a}){const[n,i]=m.useState(""),[c,o]=m.useState([]),[x,d]=m.useState(0),[l,h]=m.useState(null),g=m.useRef(null),N=m.useMemo(()=>{const b=[];for(let u=0;u<t.length;u+=U){const v=[];let w="";for(let S=0;S<U;S++)if(u+S<t.length){const C=t[u+S];v.push(C),w+=C>=32&&C<=126?String.fromCharCode(C):"."}else v.push(null),w+=" ";b.push({offset:u,bytes:v,ascii:w})}return b},[t]),k=m.useCallback(()=>{if(!n){o([]);return}const b=[],u=n.toLowerCase();if(/^[0-9a-f\s]+$/i.test(u)){const S=(u.replace(/\s/g,"").match(/.{1,2}/g)||[]).map(C=>parseInt(C,16));for(let C=0;C<=t.length-S.length;C++){let P=!0;for(let L=0;L<S.length;L++)if(t[C+L]!==S[L]){P=!1;break}P&&b.push(C)}}const v=Array.from(u).map(w=>w.charCodeAt(0));for(let w=0;w<=t.length-v.length;w++){let S=!0;for(let C=0;C<v.length;C++){const P=t[w+C],L=v[C];if(P!==L&&!(P>=65&&P<=90&&P+32===L)&&!(P>=97&&P<=122&&P-32===L)){S=!1;break}}S&&!b.includes(w)&&b.push(w)}o(b.sort((w,S)=>w-S)),d(0)},[n,t]),p=m.useCallback(b=>{var C;if(c.length===0)return;let u=x;b==="next"?u=(x+1)%c.length:u=(x-1+c.length)%c.length,d(u);const v=c[u],w=Math.floor(v/U),S=(C=g.current)==null?void 0:C.querySelector(`[data-row="${w}"]`);S==null||S.scrollIntoView({behavior:"smooth",block:"center"})},[c,x]),A=m.useCallback(async b=>{const u=t[b];await navigator.clipboard.writeText(u.toString(16).padStart(2,"0")),h(b),setTimeout(()=>h(null),1500)},[t]),I=m.useCallback(b=>{if(c.length>0){const u=c[x];if(b>=u&&b<u+n.length)return{color:"bg-yellow-500/50"};for(const v of c)if(b>=v&&b<v+n.length)return{color:"bg-yellow-500/20"}}for(const u of s)if(b>=u.start&&b<u.end)return{color:u.color,label:u.label};return null},[s,c,x,n]),E=m.useCallback(b=>b.toString(16).padStart(8,"0").toUpperCase(),[]),$=m.useCallback(b=>b===null?"  ":b.toString(16).padStart(2,"0").toUpperCase(),[]);return e.jsxs("div",{className:"h-full flex flex-col bg-surface",children:[e.jsxs("div",{className:"p-2 border-b border-surface-border flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Re,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),onKeyDown:b=>b.key==="Enter"&&k(),placeholder:"Search hex or ASCII...",className:"input w-full pl-8 pr-4 py-1 text-xs"})]}),e.jsx("button",{onClick:k,className:"btn btn-secondary py-1 px-2 text-xs",children:"Find"}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[x+1,"/",c.length]}),e.jsx("button",{onClick:()=>p("prev"),className:"btn-icon p-1",children:e.jsx(xr,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:()=>p("next"),className:"btn-icon p-1",children:e.jsx(de,{className:"w-4 h-4 text-gray-400"})})]})]}),e.jsx("div",{ref:g,className:"flex-1 overflow-auto font-mono text-xs",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-surface-raised",children:e.jsxs("tr",{className:"text-gray-500",children:[e.jsx("th",{className:"px-2 py-1 text-left w-20",children:"Offset"}),e.jsx("th",{className:"px-2 py-1 text-left",colSpan:U,children:e.jsx("div",{className:"flex",children:Array.from({length:U},(b,u)=>e.jsx("span",{className:"w-6 text-center",children:u.toString(16).toUpperCase()},u))})}),e.jsx("th",{className:"px-2 py-1 text-left w-40",children:"ASCII"})]})}),e.jsx("tbody",{children:N.map(b=>e.jsxs("tr",{"data-row":Math.floor(b.offset/U),className:"hover:bg-surface-overlay",children:[e.jsx("td",{className:"px-2 py-0.5 hex-offset",children:E(b.offset)}),e.jsx("td",{className:"px-2 py-0.5",children:e.jsx("div",{className:"flex",children:b.bytes.map((u,v)=>{const w=b.offset+v,S=u!==null?I(w):null,C=w===a,P=u!==null&&u>=32&&u<=126;return e.jsxs("span",{className:j("w-6 text-center cursor-pointer transition-colors","hex-byte",P?"hex-byte-printable":"hex-byte-nonprintable",C&&"hex-byte-selected",S==null?void 0:S.color,u===null&&"opacity-0"),onClick:()=>u!==null&&(r==null?void 0:r(w)),onDoubleClick:()=>u!==null&&A(w),title:u!==null?`Offset: ${w} (0x${E(w)})
Value: ${u} (0x${$(u)})`:void 0,children:[$(u),l===w&&e.jsx(D,{className:"inline w-3 h-3 text-green-500 ml-0.5"})]},v)})})}),e.jsx("td",{className:"px-2 py-0.5 hex-ascii border-l border-surface-border",children:e.jsx("div",{className:"flex",children:b.ascii.split("").map((u,v)=>{const w=b.offset+v,S=I(w),C=w===a,P=u!=="."&&u!==" ";return e.jsx("span",{className:j("w-2 text-center cursor-pointer",P?"text-gray-300":"text-gray-600",C&&"bg-cyber-600 text-white rounded",S==null?void 0:S.color),onClick:()=>b.bytes[v]!==null&&(r==null?void 0:r(w)),children:u},v)})})})]},b.offset))})]})}),e.jsxs("div",{className:"px-2 py-1 border-t border-surface-border text-xs text-gray-500 flex items-center justify-between",children:[e.jsxs("span",{children:[t.length," bytes"]}),a!==void 0&&e.jsxs("span",{children:["Selected: 0x",E(a)," (",a,")"]})]})]})}const ta=["TCP","UDP","ICMP","DNS","HTTP","HTTPS","TLS","SMB","QUIC","HTTP3","SSH","FTP"],sa=["critical","high","medium","low","info"];function ve(){const t=cr(),{setFilter:s,clearFilters:r}=y(),[a,n]=m.useState(!1),[i,c]=m.useState(!1),o=t.search||t.protocols.length>0||t.severities.length>0||t.srcIP||t.dstIP||t.port!==null,x=l=>{const h=t.protocols.includes(l)?t.protocols.filter(g=>g!==l):[...t.protocols,l];s({protocols:h})},d=l=>{const h=t.severities.includes(l)?t.severities.filter(g=>g!==l):[...t.severities,l];s({severities:h})};return e.jsxs("div",{className:"px-4 py-3 border-b border-surface-border bg-surface-raised",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:t.search,onChange:l=>s({search:l.target.value}),placeholder:"Search IPs, protocols, hostnames...",className:"input w-full pl-10 pr-4"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>n(!a),className:j("btn btn-secondary flex items-center gap-2",t.protocols.length>0&&"border-cyber-500 text-cyber-400"),children:[e.jsx(Bt,{className:"w-4 h-4"}),e.jsx("span",{children:"Protocol"}),t.protocols.length>0&&e.jsx("span",{className:"bg-cyber-600 text-white text-xs px-1.5 py-0.5 rounded",children:t.protocols.length}),e.jsx(de,{className:"w-4 h-4"})]}),a&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-surface-raised border border-surface-border rounded-lg shadow-lg z-20",children:e.jsx("div",{className:"p-2 max-h-64 overflow-auto",children:ta.map(l=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-surface-overlay rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.protocols.includes(l),onChange:()=>x(l),className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:l})]},l))})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!i),className:j("btn btn-secondary flex items-center gap-2",t.severities.length>0&&"border-threat-high text-threat-high"),children:[e.jsx("span",{children:"Severity"}),t.severities.length>0&&e.jsx("span",{className:"bg-threat-high text-white text-xs px-1.5 py-0.5 rounded",children:t.severities.length}),e.jsx(de,{className:"w-4 h-4"})]}),i&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-40 bg-surface-raised border border-surface-border rounded-lg shadow-lg z-20",children:e.jsx("div",{className:"p-2",children:sa.map(l=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-surface-overlay rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.severities.includes(l),onChange:()=>d(l),className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),e.jsx("span",{className:j("text-sm capitalize",l==="critical"&&"text-threat-critical",l==="high"&&"text-threat-high",l==="medium"&&"text-threat-medium",l==="low"&&"text-threat-low",l==="info"&&"text-threat-info"),children:l})]},l))})})]}),e.jsx("input",{type:"text",value:t.srcIP,onChange:l=>s({srcIP:l.target.value}),placeholder:"Source IP",className:"input w-32"}),e.jsx("input",{type:"text",value:t.dstIP,onChange:l=>s({dstIP:l.target.value}),placeholder:"Dest IP",className:"input w-32"}),e.jsx("input",{type:"number",value:t.port??"",onChange:l=>s({port:l.target.value?parseInt(l.target.value):null}),placeholder:"Port",className:"input w-20"}),o&&e.jsxs("button",{onClick:r,className:"btn btn-secondary flex items-center gap-1 text-red-400 hover:text-red-300",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Clear"})]})]}),o&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Active filters:"}),t.protocols.map(l=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-cyber-900/30 text-cyber-400 text-xs rounded",children:[l,e.jsx("button",{onClick:()=>x(l),children:e.jsx(G,{className:"w-3 h-3"})})]},l)),t.severities.map(l=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-threat-high/20 text-threat-high text-xs rounded capitalize",children:[l,e.jsx("button",{onClick:()=>d(l),children:e.jsx(G,{className:"w-3 h-3"})})]},l)),t.srcIP&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-surface-overlay text-gray-300 text-xs rounded",children:["src: ",t.srcIP,e.jsx("button",{onClick:()=>s({srcIP:""}),children:e.jsx(G,{className:"w-3 h-3"})})]}),t.dstIP&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-surface-overlay text-gray-300 text-xs rounded",children:["dst: ",t.dstIP,e.jsx("button",{onClick:()=>s({dstIP:""}),children:e.jsx(G,{className:"w-3 h-3"})})]})]})]})}function ra(){const t=y(a=>a.view.selectedPacketId),s=y(a=>t?a.packets.get(t):null),[r]=m.useState(!0);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(ve,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(Qr,{})}),s&&e.jsxs("div",{className:"w-96 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-auto border-b border-surface-border",children:e.jsx(Xr,{packet:s})}),r&&s.payload&&e.jsx("div",{className:"h-64 overflow-auto",children:e.jsx(ea,{data:s.payload})})]})]})]})}const it={TCP:"badge-protocol-tcp",UDP:"badge-protocol-udp",ICMP:"badge-protocol-icmp",ICMPv6:"badge-protocol-icmp",DNS:"badge-protocol-dns",HTTP:"badge-protocol-http",HTTPS:"badge-protocol-https",TLS:"badge-protocol-https",SMB:"badge-protocol-smb",QUIC:"badge-protocol-quic",HTTP3:"badge-protocol-quic",FTP:"badge-protocol-http",SSH:"badge-protocol-dns",SMTP:"badge-protocol-http",IMAP:"badge-protocol-http",POP3:"badge-protocol-http",ARP:"badge-protocol-icmp",DHCP:"badge-protocol-udp",NTP:"badge-protocol-udp",Unknown:"bg-gray-500/20 text-gray-400"},aa={new:"text-blue-400",established:"text-green-400",closing:"text-yellow-400",closed:"text-gray-400",timeout:"text-orange-400",reset:"text-red-400"},ot=40;function na(){const t=m.useRef(null),s=ar(),r=y(l=>l.view.selectedFlowId),a=y(l=>l.selectFlow),n=he({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>ot,overscan:15}),i=n.getVirtualItems(),c=m.useCallback((l,h)=>{const g=(h-l)/1e6;return g<1e3?`${g.toFixed(0)}ms`:g<6e4?`${(g/1e3).toFixed(1)}s`:`${(g/6e4).toFixed(1)}m`},[]),o=m.useCallback(l=>l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:l<1024*1024*1024?`${(l/(1024*1024)).toFixed(1)} MB`:`${(l/(1024*1024*1024)).toFixed(2)} GB`,[]),x=m.useCallback(l=>new Date(l/1e6).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),[]),d=m.useCallback(l=>{a(l.id)},[a]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-20 px-2 py-2",children:"Time"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Source"}),e.jsx("div",{className:"w-8 px-1 py-2"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Destination"}),e.jsx("div",{className:"w-20 px-2 py-2",children:"Protocol"}),e.jsx("div",{className:"w-16 px-2 py-2",children:"State"}),e.jsx("div",{className:"w-16 px-2 py-2 text-right",children:"Packets"}),e.jsx("div",{className:"w-20 px-2 py-2 text-right",children:"Bytes"}),e.jsx("div",{className:"w-16 px-2 py-2 text-right",children:"Duration"}),e.jsx("div",{className:"w-40 px-2 py-2",children:"Info"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:i.map(l=>{const h=s[l.index],g=h.id===r;return e.jsxs("div",{"data-index":l.index,ref:n.measureElement,className:j("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",g&&"table-row-selected bg-cyber-900/30"),style:{height:`${ot}px`,transform:`translateY(${l.start}px)`},onClick:()=>d(h),children:[e.jsx("div",{className:"w-20 px-2 text-xs font-mono text-gray-400",children:x(h.startTimeNano)}),e.jsxs("div",{className:"flex-1 px-2",children:[e.jsx("div",{className:"text-xs font-mono text-gray-300 truncate",children:h.srcIP}),e.jsxs("div",{className:"text-xxs text-gray-500",children:[":",h.srcPort]})]}),e.jsx("div",{className:"w-8 px-1 flex justify-center",children:e.jsx(ze,{className:"w-3 h-3 text-gray-600"})}),e.jsxs("div",{className:"flex-1 px-2",children:[e.jsx("div",{className:"text-xs font-mono text-gray-300 truncate",children:h.dstIP}),e.jsxs("div",{className:"text-xxs text-gray-500",children:[":",h.dstPort]})]}),e.jsx("div",{className:"w-20 px-2",children:e.jsx("span",{className:j("badge",it[h.protocol]||it.Unknown),children:h.protocol})}),e.jsx("div",{className:"w-16 px-2",children:e.jsx("span",{className:j("text-xs capitalize",aa[h.state]),children:h.state})}),e.jsx("div",{className:"w-16 px-2 text-xs font-mono text-gray-400 text-right",children:h.packetCount.toLocaleString()}),e.jsx("div",{className:"w-20 px-2 text-xs font-mono text-gray-400 text-right",children:o(h.byteCount)}),e.jsx("div",{className:"w-16 px-2 text-xs font-mono text-gray-500 text-right",children:c(h.startTimeNano,h.endTimeNano)}),e.jsxs("div",{className:"w-40 px-2 flex items-center gap-1",children:[h.metadata.ja4&&e.jsx(qt,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{className:"text-xs text-gray-500 truncate",children:ca(h)})]})]},l.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," flows"]})]})}function ca(t){return t.metadata.serverName?t.metadata.serverName:t.metadata.httpHost?t.metadata.httpHost:t.metadata.dnsQuery?t.metadata.dnsQuery:t.metadata.smbShare?t.metadata.smbShare:t.metadata.applicationProtocol?t.metadata.applicationProtocol:""}function la({flow:t}){const[s,r]=m.useState(null),a=async(o,x)=>{await navigator.clipboard.writeText(o),r(x),setTimeout(()=>r(null),2e3)},n=o=>new Date(o/1e6).toISOString(),i=(o,x)=>{const d=(x-o)/1e6;return d<1e3?`${d.toFixed(0)} ms`:d<6e4?`${(d/1e3).toFixed(2)} sec`:`${(d/6e4).toFixed(2)} min`},c=o=>o<1024?`${o} B`:o<1024*1024?`${(o/1024).toFixed(2)} KB`:o<1024*1024*1024?`${(o/(1024*1024)).toFixed(2)} MB`:`${(o/(1024*1024*1024)).toFixed(2)} GB`;return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-3",children:"Flow Summary"}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-overlay rounded-lg mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Source"}),e.jsx("div",{className:"font-mono text-sm text-gray-200",children:t.srcIP}),e.jsxs("div",{className:"font-mono text-xs text-gray-500",children:[":",t.srcPort]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center px-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-cyber-500 to-transparent"}),e.jsx(ze,{className:"w-4 h-4 text-cyber-400 mx-2"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-l from-cyber-500 to-transparent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Destination"}),e.jsx("div",{className:"font-mono text-sm text-gray-200",children:t.dstIP}),e.jsxs("div",{className:"font-mono text-xs text-gray-500",children:[":",t.dstPort]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Packets"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:t.packetCount.toLocaleString()})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Bytes"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:c(t.byteCount)})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Duration"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:i(t.startTimeNano,t.endTimeNano)})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Protocol"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:t.protocol})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Timestamps"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"Start:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:n(t.startTimeNano)}),e.jsx(F,{value:n(t.startTimeNano),fieldName:"startTime",copiedField:s,onCopy:a})]})]}),e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"End:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:n(t.endTimeNano)}),e.jsx(F,{value:n(t.endTimeNano),fieldName:"endTime",copiedField:s,onCopy:a})]})]})]})]}),(t.metadata.ja3||t.metadata.ja4||t.metadata.serverName)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-green-500"}),"TLS Information"]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[t.metadata.serverName&&e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"Server Name (SNI):"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.serverName}),e.jsx(F,{value:t.metadata.serverName,fieldName:"sni",copiedField:s,onCopy:a})]})]}),t.metadata.ja3&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"JA3 Fingerprint:"}),e.jsx(F,{value:t.metadata.ja3,fieldName:"ja3",copiedField:s,onCopy:a})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 mt-1 break-all",children:t.metadata.ja3})]}),t.metadata.ja3s&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"JA3S Fingerprint:"}),e.jsx(F,{value:t.metadata.ja3s,fieldName:"ja3s",copiedField:s,onCopy:a})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 mt-1 break-all",children:t.metadata.ja3s})]}),t.metadata.ja4&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"JA4 Fingerprint:"}),e.jsx(F,{value:t.metadata.ja4,fieldName:"ja4",copiedField:s,onCopy:a})]}),e.jsx("div",{className:"font-mono text-xxs text-cyber-400 mt-1 break-all",children:t.metadata.ja4})]})]})]}),(t.metadata.httpHost||t.metadata.userAgent)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-protocol-http"}),"HTTP Information"]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[t.metadata.httpHost&&e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"Host:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.httpHost}),e.jsx(F,{value:t.metadata.httpHost,fieldName:"httpHost",copiedField:s,onCopy:a})]})]}),t.metadata.userAgent&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"User-Agent:"}),e.jsx(F,{value:t.metadata.userAgent,fieldName:"userAgent",copiedField:s,onCopy:a})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 mt-1 break-all",children:t.metadata.userAgent})]}),t.metadata.contentType&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Content-Type:"}),e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.contentType})]})]})]}),t.metadata.dnsQuery&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Ut,{className:"w-4 h-4 text-protocol-dns"}),"DNS Information"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs group",children:[e.jsx("span",{className:"text-gray-500",children:"Query:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.dnsQuery}),e.jsx(F,{value:t.metadata.dnsQuery,fieldName:"dnsQuery",copiedField:s,onCopy:a})]})]})]}),t.metadata.smbShare&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-protocol-smb"}),"SMB Information"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs group",children:[e.jsx("span",{className:"text-gray-500",children:"Share:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.smbShare}),e.jsx(F,{value:t.metadata.smbShare,fieldName:"smbShare",copiedField:s,onCopy:a})]})]})]})]})}function F({value:t,fieldName:s,copiedField:r,onCopy:a}){return e.jsx("button",{onClick:()=>a(t,s),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:r===s?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})}function ia(){const t=y(r=>r.view.selectedFlowId),s=y(r=>t?r.flows.get(t):null);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(ve,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(na,{})}),s&&e.jsx("div",{className:"w-96 overflow-auto",children:e.jsx(la,{flow:s})})]})]})}const ne={text:Ae,image:ur,audio:mr,video:pr,"application/zip":re,"application/x-rar":re,"application/x-7z-compressed":re,"application/gzip":re,"application/pdf":Ae,"application/javascript":Q,"application/json":Q,"application/xml":Q,"text/html":Q,"text/css":Q},dt=48;function oa(){const t=m.useRef(null),s=y(l=>Array.from(l.files.values())),r=y(l=>l.view.selectedFileId),a=y(l=>l.selectFile),n=he({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>dt,overscan:15}),i=n.getVirtualItems(),c=m.useCallback(l=>{if(ne[l])return ne[l];const h=l.split("/")[0];return ne[h]?ne[h]:Rt},[]),o=m.useCallback(l=>l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:l<1024*1024*1024?`${(l/(1024*1024)).toFixed(1)} MB`:`${(l/(1024*1024*1024)).toFixed(2)} GB`,[]),x=m.useCallback(l=>new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}),[]),d=m.useCallback(l=>{a(l.id)},[a]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-12 px-2 py-2"}),e.jsx("div",{className:"flex-1 px-3 py-2",children:"File Name"}),e.jsx("div",{className:"w-32 px-3 py-2",children:"Type"}),e.jsx("div",{className:"w-24 px-3 py-2 text-right",children:"Size"}),e.jsx("div",{className:"w-36 px-3 py-2",children:"Extracted"}),e.jsx("div",{className:"w-20 px-3 py-2 text-center",children:"Status"}),e.jsx("div",{className:"w-24 px-3 py-2 text-center",children:"Actions"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:i.map(l=>{const h=s[l.index],g=h.id===r,N=c(h.mimeType);return e.jsxs("div",{"data-index":l.index,ref:n.measureElement,className:j("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",g&&"table-row-selected bg-cyber-900/30",h.isSuspicious&&"bg-threat-high/5"),style:{height:`${dt}px`,transform:`translateY(${l.start}px)`},onClick:()=>d(h),children:[e.jsx("div",{className:"w-12 px-2 flex justify-center",children:e.jsx(N,{className:j("w-5 h-5",h.isSuspicious?"text-threat-high":"text-gray-400")})}),e.jsx("div",{className:"flex-1 px-3",children:e.jsx("div",{className:"text-sm text-gray-200 truncate",children:h.fileName})}),e.jsx("div",{className:"w-32 px-3",children:e.jsx("span",{className:"text-xs text-gray-500 truncate block",children:h.mimeType})}),e.jsx("div",{className:"w-24 px-3 text-right",children:e.jsx("span",{className:"text-xs font-mono text-gray-400",children:o(h.size)})}),e.jsx("div",{className:"w-36 px-3",children:e.jsx("span",{className:"text-xs text-gray-500",children:x(h.extractedAt)})}),e.jsx("div",{className:"w-20 px-3 text-center",children:h.isSuspicious?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-threat-high/10 text-threat-high text-xs rounded",children:[e.jsx(T,{className:"w-3 h-3"}),"Threat"]}):e.jsx("span",{className:"text-xs text-green-500",children:"Clean"})}),e.jsxs("div",{className:"w-24 px-3 flex items-center justify-center gap-1",children:[e.jsx("button",{className:"btn-icon p-1",title:"Preview",onClick:k=>{k.stopPropagation()},children:e.jsx(B,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{className:"btn-icon p-1",title:"Download",onClick:k=>{k.stopPropagation()},children:e.jsx(zt,{className:"w-4 h-4 text-gray-400"})})]})]},l.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," files extracted"]})]})}function da({file:t}){const[s,r]=m.useState(null),a=async(c,o)=>{await navigator.clipboard.writeText(c),r(o),setTimeout(()=>r(null),2e3)},n=c=>c<1024?`${c} bytes`:c<1024*1024?`${(c/1024).toFixed(2)} KB`:c<1024*1024*1024?`${(c/(1024*1024)).toFixed(2)} MB`:`${(c/(1024*1024*1024)).toFixed(2)} GB`,i=c=>new Date(c).toISOString();return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:j("p-4 rounded-lg border",t.isSuspicious?"bg-threat-high/10 border-threat-high/30":"bg-surface-overlay border-surface-border"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:j("p-3 rounded-lg",t.isSuspicious?"bg-threat-high/20":"bg-surface-border"),children:e.jsx(Rt,{className:j("w-8 h-8",t.isSuspicious?"text-threat-high":"text-gray-400")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-white truncate",children:t.fileName}),e.jsx("p",{className:"text-sm text-gray-500",children:t.mimeType}),t.isSuspicious&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(T,{className:"w-4 h-4 text-threat-high"}),e.jsx("span",{className:"text-sm text-threat-high font-medium",children:t.threatType||"Suspicious file detected"})]})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-3",children:"File Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Size"})]}),e.jsx("span",{className:"font-mono text-sm text-gray-300",children:n(t.size)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Extracted"})]}),e.jsx("span",{className:"font-mono text-sm text-gray-300",children:i(t.extractedAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Ht,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Source Flow"})]}),e.jsx("span",{className:"font-mono text-xs text-gray-400 truncate max-w-32",children:t.sourceFlow})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-3 flex items-center gap-2",children:[e.jsx(fr,{className:"w-4 h-4 text-gray-500"}),"File Hashes"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"SHA-256"}),e.jsx("button",{onClick:()=>a(t.sha256,"sha256"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="sha256"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 break-all bg-surface-overlay p-2 rounded",children:t.sha256})]}),e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"BLAKE3"}),e.jsx("button",{onClick:()=>a(t.blake3,"blake3"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="blake3"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]}),e.jsx("div",{className:"font-mono text-xxs text-cyber-400 break-all bg-surface-overlay p-2 rounded",children:t.blake3})]})]})]}),t.isSuspicious&&t.threatType&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-3 flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-threat-high"}),"Threat Analysis"]}),e.jsx("div",{className:"p-3 bg-threat-high/10 border border-threat-high/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-threat-high",children:t.threatType})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"btn btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(zt,{className:"w-4 h-4"}),"Download"]}),e.jsx("button",{className:"btn btn-secondary flex-1",children:"View in Hex"})]}),e.jsx("div",{className:"pt-4 border-t border-surface-border",children:e.jsxs("a",{href:`https://www.virustotal.com/gui/file/${t.sha256}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyber-400 hover:text-cyber-300 flex items-center gap-1",children:["Check on VirusTotal",e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})}function xa(){const t=y(r=>r.view.selectedFileId),s=y(r=>t?r.files.get(t):null);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(ve,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(oa,{})}),s&&e.jsx("div",{className:"w-96 overflow-auto",children:e.jsx(da,{file:s})})]})]})}const ha={critical:{color:"text-threat-critical",bg:"bg-threat-critical/10",border:"border-threat-critical/30"},high:{color:"text-threat-high",bg:"bg-threat-high/10",border:"border-threat-high/30"},medium:{color:"text-threat-medium",bg:"bg-threat-medium/10",border:"border-threat-medium/30"},low:{color:"text-threat-low",bg:"bg-threat-low/10",border:"border-threat-low/30"},info:{color:"text-threat-info",bg:"bg-threat-info/10",border:"border-threat-info/30"}},ma={malware:Oe,c2:be,exfiltration:B,lateral_movement:R,credential_access:Gt,reconnaissance:B,anomaly:T,policy_violation:Ot,suspicious:T},xt=64;function ua(){const t=m.useRef(null),s=nr(),r=y(x=>x.view.selectedAlertId),a=y(x=>x.selectAlert),n=he({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>xt,overscan:10}),i=n.getVirtualItems(),c=m.useCallback(x=>new Date(x/1e6).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),[]),o=m.useCallback(x=>{a(x.id)},[a]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-24 px-3 py-2",children:"Severity"}),e.jsx("div",{className:"w-32 px-3 py-2",children:"Time"}),e.jsx("div",{className:"w-24 px-3 py-2",children:"Category"}),e.jsx("div",{className:"flex-1 px-3 py-2",children:"Alert"}),e.jsx("div",{className:"w-40 px-3 py-2",children:"Source  Dest"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:i.map(x=>{const d=s[x.index],l=d.id===r,h=ha[d.severity],g=ma[d.category]||T;return e.jsxs("div",{"data-index":x.index,ref:n.measureElement,className:j("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",l&&"table-row-selected",h.bg),style:{height:`${xt}px`,transform:`translateY(${x.start}px)`},onClick:()=>o(d),children:[e.jsx("div",{className:"w-24 px-3",children:e.jsx("span",{className:j("inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium uppercase",h.bg,h.color,"border",h.border),children:d.severity})}),e.jsx("div",{className:"w-32 px-3 text-xs font-mono text-gray-400",children:c(d.timestampNano)}),e.jsx("div",{className:"w-24 px-3",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(g,{className:j("w-4 h-4",h.color)}),e.jsx("span",{className:"text-xs text-gray-400 capitalize",children:d.category.replace("_"," ")})]})}),e.jsxs("div",{className:"flex-1 px-3",children:[e.jsx("div",{className:j("text-sm font-medium",h.color),children:d.title}),e.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:d.description})]}),e.jsx("div",{className:"w-40 px-3",children:d.sourceIP&&e.jsxs("div",{className:"text-xs font-mono text-gray-400",children:[d.sourceIP,d.destIP&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"  "}),d.destIP]})]})})]},x.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," alerts"]})]})}const pa={critical:{color:"text-threat-critical",bg:"bg-threat-critical/10",label:"Critical"},high:{color:"text-threat-high",bg:"bg-threat-high/10",label:"High"},medium:{color:"text-threat-medium",bg:"bg-threat-medium/10",label:"Medium"},low:{color:"text-threat-low",bg:"bg-threat-low/10",label:"Low"},info:{color:"text-threat-info",bg:"bg-threat-info/10",label:"Info"}},fa={malware:Oe,c2:be,exfiltration:B,lateral_movement:R,credential_access:Gt,reconnaissance:B,anomaly:T,policy_violation:Ot,suspicious:T};function ga({alert:t}){var o,x;const[s,r]=m.useState(null),a=pa[t.severity],n=fa[t.category]||T,i=async(d,l)=>{await navigator.clipboard.writeText(d),r(l),setTimeout(()=>r(null),2e3)},c=d=>new Date(d/1e6).toISOString();return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:j("p-4 rounded-lg border",a.bg,`border-${t.severity==="critical"?"threat-critical":t.severity==="high"?"threat-high":"surface-border"}/30`),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:j("p-2 rounded-lg",a.bg),children:e.jsx(n,{className:j("w-6 h-6",a.color)})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:j("px-2 py-0.5 rounded text-xs font-medium uppercase",a.bg,a.color),children:a.label}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:t.category.replace("_"," ")})]}),e.jsx("h3",{className:j("text-lg font-semibold",a.color),children:t.title})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:t.description})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-500"}),"Timestamp"]}),e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("span",{className:"font-mono text-sm text-gray-300",children:c(t.timestampNano)}),e.jsx("button",{onClick:()=>i(c(t.timestampNano),"timestamp"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="timestamp"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]})]}),(t.sourceIP||t.destIP)&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-500"}),"Network Information"]}),e.jsxs("div",{className:"space-y-2",children:[t.sourceIP&&e.jsxs("div",{className:"flex items-center justify-between group",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Source IP:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-gray-300",children:t.sourceIP}),e.jsx("button",{onClick:()=>i(t.sourceIP,"sourceIP"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="sourceIP"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]})]}),t.destIP&&e.jsxs("div",{className:"flex items-center justify-between group",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Destination IP:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-gray-300",children:t.destIP}),e.jsx("button",{onClick:()=>i(t.destIP,"destIP"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="destIP"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]})]})]})]}),t.indicators.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Tr,{className:"w-4 h-4 text-gray-500"}),"Indicators of Compromise"]}),e.jsx("div",{className:"space-y-1",children:t.indicators.map((d,l)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-surface-overlay rounded group",children:[e.jsx("span",{className:"font-mono text-xs text-gray-300 truncate",children:d}),e.jsx("button",{onClick:()=>i(d,`indicator-${l}`),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-border rounded transition-all",children:s===`indicator-${l}`?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-gray-500"})})]},l))})]}),(((o=t.mitreTactics)==null?void 0:o.length)||((x=t.mitreTechniques)==null?void 0:x.length))&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500"}),"MITRE ATT&CK"]}),e.jsxs("div",{className:"space-y-3",children:[t.mitreTactics&&t.mitreTactics.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Tactics:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.mitreTactics.map((d,l)=>e.jsxs("a",{href:`https://attack.mitre.org/tactics/${d}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-0.5 bg-cyber-900/30 text-cyber-400 text-xs rounded hover:bg-cyber-900/50 transition-colors",children:[d,e.jsx(rt,{className:"w-3 h-3"})]},l))})]}),t.mitreTechniques&&t.mitreTechniques.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Techniques:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.mitreTechniques.map((d,l)=>e.jsxs("a",{href:`https://attack.mitre.org/techniques/${d}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-0.5 bg-threat-high/10 text-threat-high text-xs rounded hover:bg-threat-high/20 transition-colors",children:[d,e.jsx(rt,{className:"w-3 h-3"})]},l))})]})]})]}),t.relatedFlows.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-gray-500"}),"Related Flows (",t.relatedFlows.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[t.relatedFlows.slice(0,5).map((d,l)=>e.jsx("div",{className:"p-2 bg-surface-overlay rounded text-xs font-mono text-gray-400 cursor-pointer hover:bg-surface-border transition-colors",children:d},l)),t.relatedFlows.length>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["+",t.relatedFlows.length-5," more flows"]})]})]})]})}function ya(){const t=y(r=>r.view.selectedAlertId),s=y(r=>t?r.alerts.get(t):null);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(ve,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(ua,{})}),s&&e.jsx("div",{className:"w-96 overflow-auto",children:e.jsx(ga,{alert:s})})]})]})}const ht={internal:"#8b5cf6",external:"#ef4444",gateway:"#f59e0b",server:"#3b82f6",client:"#22c55e"},mt={TCP:"#3b82f6",UDP:"#22c55e",ICMP:"#f97316",DNS:"#8b5cf6",HTTP:"#06b6d4",HTTPS:"#10b981",SMB:"#f59e0b",QUIC:"#ec4899",default:"#6b7280"};function ja({nodes:t,links:s,onNodeClick:r,selectedNode:a}){const n=m.useRef(),[i,c]=m.useState({width:800,height:600}),o=m.useRef(null);m.useEffect(()=>{const p=()=>{o.current&&c({width:o.current.clientWidth,height:o.current.clientHeight})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const x={nodes:t.map(p=>({id:p.id,name:p.hostname||p.ip,ip:p.ip,type:p.type,packetCount:p.packetCount,byteCount:p.byteCount,alertCount:p.alertCount,val:Math.log10(p.byteCount+1)*2+5})),links:s.map(p=>({source:p.source,target:p.target,protocol:p.protocol,packetCount:p.packetCount,byteCount:p.byteCount,bidirectional:p.bidirectional}))},d=m.useCallback(p=>{const A=p.id===a,I=p.alertCount>0,E=new Ve(p.val||5,16,16),$=ht[p.type]||ht.client,b=new rs({color:$,emissive:A?$:I?"#ef4444":"#000000",emissiveIntensity:A?.5:I?.3:0,transparent:!0,opacity:.9}),u=new Ne(E,b);if(A){const v=new as((p.val||5)*1.5,(p.val||5)*1.8,32),w=new He({color:"#8b5cf6",side:ns,transparent:!0,opacity:.6}),S=new Ne(v,w);u.add(S)}if(I){const v=new Ve(2,8,8),w=new He({color:"#ef4444"}),S=new Ne(v,w);S.position.set(p.val||5,p.val||5,0),u.add(S)}return u},[a]),l=m.useCallback(p=>mt[p.protocol]||mt.default,[]),h=m.useCallback(p=>Math.log10(p.packetCount+1)*.5+.5,[]),g=m.useCallback(p=>{if(r(p.id),n.current&&p.x!==void 0&&p.y!==void 0&&p.z!==void 0){const I=1+100/Math.hypot(p.x,p.y,p.z);n.current.cameraPosition({x:p.x*I,y:p.y*I,z:p.z*I},p,1e3)}},[r]),N=m.useCallback(()=>{r(null)},[r]),k=m.useCallback(p=>`
      <div style="background: rgba(10,10,15,0.9); padding: 8px 12px; border-radius: 6px; border: 1px solid #2a2a3a;">
        <div style="font-weight: 600; color: #fff; margin-bottom: 4px;">${p.name}</div>
        <div style="font-family: monospace; font-size: 11px; color: #9ca3af;">${p.ip}</div>
        <div style="font-size: 11px; color: #6b7280; margin-top: 4px;">
          ${p.packetCount.toLocaleString()} packets  ${ba(p.byteCount)}
        </div>
        ${p.alertCount>0?`<div style="color: #ef4444; font-size: 11px; margin-top: 2px;">${p.alertCount} alerts</div>`:""}
      </div>
    `,[]);return t.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("p",{className:"text-lg",children:"No network topology data"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Start capturing to visualize network connections"})]})}):e.jsx("div",{ref:o,className:"h-full w-full bg-surface",children:e.jsx(cs,{ref:n,width:i.width,height:i.height,graphData:x,nodeThreeObject:d,nodeLabel:k,linkColor:l,linkWidth:h,linkOpacity:.6,linkDirectionalParticles:2,linkDirectionalParticleWidth:2,linkDirectionalParticleSpeed:.005,onNodeClick:g,onBackgroundClick:N,backgroundColor:"#0a0a0f",showNavInfo:!1,enableNodeDrag:!0,enableNavigationControls:!0,controlType:"orbit"})})}function ba(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:t<1024*1024*1024?`${(t/(1024*1024)).toFixed(1)} MB`:`${(t/(1024*1024*1024)).toFixed(2)} GB`}function va({onZoomIn:t,onZoomOut:s,onReset:r,onFitView:a}){const[n,i]=m.useState(!0),[c,o]=m.useState(!0),[x,d]=m.useState(!1);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"panel p-1 flex flex-col gap-1",children:[e.jsx("button",{onClick:t,className:"btn-icon",title:"Zoom In",children:e.jsx(Ar,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:s,className:"btn-icon",title:"Zoom Out",children:e.jsx(Dr,{className:"w-4 h-4 text-gray-400"})}),e.jsx("div",{className:"h-px bg-surface-border my-1"}),e.jsx("button",{onClick:a,className:"btn-icon",title:"Fit to View",children:e.jsx(br,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:r,className:"btn-icon",title:"Reset View",children:e.jsx(kr,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"panel p-1 flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>i(!n),className:j("btn-icon",n&&"bg-surface-overlay"),title:"Toggle Labels",children:n?e.jsx(B,{className:"w-4 h-4 text-cyber-400"}):e.jsx(hr,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:()=>o(!c),className:j("btn-icon",c&&"bg-surface-overlay"),title:"Toggle Alert Indicators",children:e.jsx(yr,{className:j("w-4 h-4",c?"text-threat-high":"text-gray-400")})}),e.jsx("div",{className:"h-px bg-surface-border my-1"}),e.jsx("button",{onClick:()=>d(!x),className:j("btn-icon",x&&"bg-surface-overlay"),title:"Filter Options",children:e.jsx(Bt,{className:"w-4 h-4 text-gray-400"})})]}),x&&e.jsxs("div",{className:"panel p-3 w-48",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Node Types"}),e.jsx("div",{className:"space-y-1",children:[{type:"internal",label:"Internal",color:"#8b5cf6"},{type:"external",label:"External",color:"#ef4444"},{type:"gateway",label:"Gateway",color:"#f59e0b"},{type:"server",label:"Server",color:"#3b82f6"},{type:"client",label:"Client",color:"#22c55e"}].map(({type:l,label:h,color:g})=>e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:g}}),h]},l))}),e.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mt-4 mb-2",children:"Protocols"}),e.jsx("div",{className:"space-y-1",children:["TCP","UDP","DNS","HTTP","HTTPS","SMB"].map(l=>e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),l]},l))})]}),e.jsxs("div",{className:"panel p-3",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Legend"}),e.jsx("div",{className:"space-y-1.5",children:[{color:"#8b5cf6",label:"Internal"},{color:"#ef4444",label:"External"},{color:"#f59e0b",label:"Gateway"},{color:"#3b82f6",label:"Server"},{color:"#22c55e",label:"Client"}].map(({color:l,label:h})=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l}}),h]},h))})]})]})}const Na={internal:vr,external:xe,gateway:Sr,server:Ut,client:gr},ut={internal:"text-cyber-400",external:"text-red-400",gateway:"text-amber-400",server:"text-blue-400",client:"text-green-400"};function wa({node:t,links:s,onClose:r}){const a=Na[t.type],n=o=>o<1024?`${o} B`:o<1024*1024?`${(o/1024).toFixed(1)} KB`:o<1024*1024*1024?`${(o/(1024*1024)).toFixed(1)} MB`:`${(o/(1024*1024*1024)).toFixed(2)} GB`,i=s.filter(o=>o.target===t.id),c=s.filter(o=>o.source===t.id);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-surface-border flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:j("p-2 rounded-lg bg-surface-overlay",ut[t.type]),children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:t.hostname||t.ip}),t.hostname&&e.jsx("p",{className:"text-xs font-mono text-gray-500",children:t.ip}),e.jsx("span",{className:j("text-xs capitalize",ut[t.type]),children:t.type})]})]}),e.jsx("button",{onClick:r,className:"btn-icon",children:e.jsx(G,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"p-4 border-b border-surface-border",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Packets"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:t.packetCount.toLocaleString()})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Bytes"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:n(t.byteCount)})]})]}),t.alertCount>0&&e.jsx("div",{className:"mt-3 p-3 bg-threat-critical/10 border border-threat-critical/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-threat-critical"}),e.jsxs("span",{className:"text-sm text-threat-critical font-medium",children:[t.alertCount," Alert",t.alertCount>1?"s":""]})]})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3",children:["Connections (",s.length,")"]}),i.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-xs text-gray-500 mb-2",children:["Inbound (",i.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[i.slice(0,10).map((o,x)=>e.jsx(pt,{link:o,direction:"inbound"},x)),i.length>10&&e.jsxs("p",{className:"text-xs text-gray-500",children:["+",i.length-10," more"]})]})]}),c.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-xs text-gray-500 mb-2",children:["Outbound (",c.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[c.slice(0,10).map((o,x)=>e.jsx(pt,{link:o,direction:"outbound"},x)),c.length>10&&e.jsxs("p",{className:"text-xs text-gray-500",children:["+",c.length-10," more"]})]})]}),s.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No connections found"})]})]})}function pt({link:t,direction:s}){const r=s==="inbound"?t.source:t.target,a=n=>n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`;return e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-surface-overlay rounded-lg text-xs",children:[e.jsx(ze,{className:j("w-3 h-3 flex-shrink-0",s==="inbound"?"rotate-180 text-green-500":"text-blue-500")}),e.jsx("span",{className:"font-mono text-gray-300 truncate flex-1",children:r}),e.jsx("span",{className:j("badge",t.protocol==="TCP"&&"badge-protocol-tcp",t.protocol==="UDP"&&"badge-protocol-udp",t.protocol==="DNS"&&"badge-protocol-dns",t.protocol==="HTTP"&&"badge-protocol-http",t.protocol==="HTTPS"&&"badge-protocol-https",t.protocol==="SMB"&&"badge-protocol-smb"),children:t.protocol}),e.jsx("span",{className:"text-gray-500",children:a(t.byteCount)})]})}function ka(){const t=y(n=>n.topology),[s,r]=m.useState(null),a=s?t.nodes.find(n=>n.id===s):null;return e.jsxs("div",{className:"h-full flex",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx(va,{})}),e.jsx(ja,{nodes:t.nodes,links:t.links,onNodeClick:r,selectedNode:s})]}),a&&e.jsx("div",{className:"w-80 border-l border-surface-border overflow-auto",children:e.jsx(wa,{node:a,links:t.links.filter(n=>n.source===s||n.target===s),onClose:()=>r(null)})})]})}const z={PACKET_BATCH:"packet:batch",FLOW_UPDATE:"flow:update",ALERT_NEW:"alert:new",STATS_UPDATE:"stats:update",CAPTURE_STATE:"capture:state",TOPOLOGY_UPDATE:"topology:update",FILE_EXTRACTED:"file:extracted",ERROR:"error"},Sa=16;function Ca(){const{addPackets:t,updateFlows:s,addAlert:r,updateStatistics:a,updateCaptureState:n,updateTopology:i,addFile:c}=y(),o=m.useRef([]),x=m.useRef([]),d=m.useRef(0),l=m.useRef(null),h=m.useCallback(()=>{o.current.length>0&&(t(o.current),o.current=[]),x.current.length>0&&(s(x.current),x.current=[]),d.current=performance.now(),l.current=null},[t,s]),g=m.useCallback(()=>{l.current===null&&(performance.now()-d.current>=Sa?l.current=requestAnimationFrame(h):l.current=requestAnimationFrame(()=>{l.current=requestAnimationFrame(h)}))},[h]),N=m.useCallback(u=>{const v=u;o.current.push(...v.packets),g()},[g]),k=m.useCallback(u=>{const v=u;x.current.push(...v.flows),g()},[g]),p=m.useCallback(u=>{const v=u;r(v.alert),(v.alert.severity==="critical"||v.alert.severity==="high")&&Pa(v.alert)},[r]),A=m.useCallback(u=>{a(u.stats)},[a]),I=m.useCallback(u=>{n(u.state)},[n]),E=m.useCallback(u=>{i(u.topology)},[i]),$=m.useCallback(u=>{c(u.file)},[c]),b=m.useCallback(u=>{const v=u;console.error("Backend error:",v.message,v.code)},[]);m.useEffect(()=>{const u=window.runtime;if(!u){console.warn("Wails runtime not available, running in development mode");return}const v=[u.EventsOn(z.PACKET_BATCH,N),u.EventsOn(z.FLOW_UPDATE,k),u.EventsOn(z.ALERT_NEW,p),u.EventsOn(z.STATS_UPDATE,A),u.EventsOn(z.CAPTURE_STATE,I),u.EventsOn(z.TOPOLOGY_UPDATE,E),u.EventsOn(z.FILE_EXTRACTED,$),u.EventsOn(z.ERROR,b)];return()=>{v.forEach(w=>w==null?void 0:w()),l.current!==null&&cancelAnimationFrame(l.current)}},[N,k,p,A,I,E,$,b])}function Pa(t){"Notification"in window&&Notification.permission==="granted"&&new Notification(`NFA Alert: ${t.title}`,{body:t.description,icon:"/nfa-icon.svg",tag:t.id})}function Ta(){const t=Et();Ca();const s=()=>{switch(t){case"dashboard":return e.jsx(nt,{});case"packets":return e.jsx(ra,{});case"flows":return e.jsx(ia,{});case"files":return e.jsx(xa,{});case"alerts":return e.jsx(ya,{});case"topology":return e.jsx(ka,{});default:return e.jsx(nt,{})}};return e.jsxs("div",{className:"h-screen w-screen flex flex-col bg-surface overflow-hidden",children:[e.jsx(zr,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx($r,{}),e.jsx("main",{className:"flex-1 overflow-hidden bg-grid",children:s()})]}),e.jsx(Or,{})]})}Ce.createRoot(document.getElementById("root")).render(e.jsx(ft.StrictMode,{children:e.jsx(Ta,{})}));
