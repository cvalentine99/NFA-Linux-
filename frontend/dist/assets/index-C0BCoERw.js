import{r as m,a as Gt,g as Wt,R as pt}from"./react-vendor-KfUPlHYY.js";import{c as y,R as ft,P as Kt,a as Zt,C as Qt,T as gt,L as Yt,A as Xt,b as Jt,X as es,Y as ts,d as Oe,S as Re,M as ss,e as ve,f as as,g as He,D as rs,F as ns}from"./viz-vendor-DtNZId8l.js";import{u as xe}from"./table-vendor-COPVXm3X.js";import"three/webgpu";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();var yt={exports:{}},he={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cs=m,ls=Symbol.for("react.element"),is=Symbol.for("react.fragment"),os=Object.prototype.hasOwnProperty,ds=cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xs={key:!0,ref:!0,__self:!0,__source:!0};function jt(t,s,a){var r,n={},c=null,i=null;a!==void 0&&(c=""+a),s.key!==void 0&&(c=""+s.key),s.ref!==void 0&&(i=s.ref);for(r in s)os.call(s,r)&&!xs.hasOwnProperty(r)&&(n[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:ls,type:t,key:c,ref:i,props:n,_owner:ds.current}}he.Fragment=is;he.jsx=jt;he.jsxs=jt;yt.exports=he;var e=yt.exports,Se={},qe=Gt;Se.createRoot=qe.createRoot,Se.hydrateRoot=qe.hydrateRoot;const hs={},Ue=t=>{let s;const a=new Set,r=(l,x)=>{const g=typeof l=="function"?l(s):l;if(!Object.is(g,s)){const v=s;s=x??(typeof g!="object"||g===null)?g:Object.assign({},s,g),a.forEach(k=>k(s,v))}},n=()=>s,h={setState:r,getState:n,getInitialState:()=>o,subscribe:l=>(a.add(l),()=>a.delete(l)),destroy:()=>{(hs?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),a.clear()}},o=s=t(r,n,h);return h},ms=t=>t?Ue(t):Ue;var bt={exports:{}},vt={},Nt={exports:{}},wt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W=m;function us(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var ps=typeof Object.is=="function"?Object.is:us,fs=W.useState,gs=W.useEffect,ys=W.useLayoutEffect,js=W.useDebugValue;function bs(t,s){var a=s(),r=fs({inst:{value:a,getSnapshot:s}}),n=r[0].inst,c=r[1];return ys(function(){n.value=a,n.getSnapshot=s,Ne(n)&&c({inst:n})},[t,a,s]),gs(function(){return Ne(n)&&c({inst:n}),t(function(){Ne(n)&&c({inst:n})})},[t]),js(a),a}function Ne(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!ps(t,a)}catch{return!0}}function vs(t,s){return s()}var Ns=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?vs:bs;wt.useSyncExternalStore=W.useSyncExternalStore!==void 0?W.useSyncExternalStore:Ns;Nt.exports=wt;var ws=Nt.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var me=m,ks=ws;function Ss(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Cs=typeof Object.is=="function"?Object.is:Ss,Ps=ks.useSyncExternalStore,Ts=me.useRef,Is=me.useEffect,Ms=me.useMemo,_s=me.useDebugValue;vt.useSyncExternalStoreWithSelector=function(t,s,a,r,n){var c=Ts(null);if(c.current===null){var i={hasValue:!1,value:null};c.current=i}else i=c.current;c=Ms(function(){function h(v){if(!o){if(o=!0,l=v,v=r(v),n!==void 0&&i.hasValue){var k=i.value;if(n(k,v))return x=k}return x=v}if(k=x,Cs(l,v))return k;var p=r(v);return n!==void 0&&n(k,p)?(l=v,k):(l=v,x=p)}var o=!1,l,x,g=a===void 0?null:a;return[function(){return h(s())},g===null?void 0:function(){return h(g())}]},[s,a,r,n]);var d=Ps(t,c[0],c[1]);return Is(function(){i.hasValue=!0,i.value=d},[d]),_s(d),d};bt.exports=vt;var Fs=bt.exports;const As=Wt(Fs),kt={},{useDebugValue:Ds}=pt,{useSyncExternalStoreWithSelector:Es}=As;let Ve=!1;const Ls=t=>t;function $s(t,s=Ls,a){(kt?"production":void 0)!=="production"&&a&&!Ve&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ve=!0);const r=Es(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,a);return Ds(r),r}const zs=t=>{(kt?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?ms(t):t,a=(r,n)=>$s(s,r,n);return Object.assign(a,s),a},Bs=t=>zs;var St=Symbol.for("immer-nothing"),Ge=Symbol.for("immer-draftable"),M=Symbol.for("immer-state");function _(t,...s){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Y=Object.getPrototypeOf;function K(t){return!!t&&!!t[M]}function q(t){var s;return t?Ct(t)||Array.isArray(t)||!!t[Ge]||!!((s=t.constructor)!=null&&s[Ge])||ee(t)||pe(t):!1}var Os=Object.prototype.constructor.toString(),We=new WeakMap;function Ct(t){if(!t||typeof t!="object")return!1;const s=Object.getPrototypeOf(t);if(s===null||s===Object.prototype)return!0;const a=Object.hasOwnProperty.call(s,"constructor")&&s.constructor;if(a===Object)return!0;if(typeof a!="function")return!1;let r=We.get(a);return r===void 0&&(r=Function.toString.call(a),We.set(a,r)),r===Os}function ne(t,s,a=!0){ue(t)===0?(a?Reflect.ownKeys(t):Object.keys(t)).forEach(n=>{s(n,t[n],t)}):t.forEach((r,n)=>s(n,r,t))}function ue(t){const s=t[M];return s?s.type_:Array.isArray(t)?1:ee(t)?2:pe(t)?3:0}function Ce(t,s){return ue(t)===2?t.has(s):Object.prototype.hasOwnProperty.call(t,s)}function Pt(t,s,a){const r=ue(t);r===2?t.set(s,a):r===3?t.add(a):t[s]=a}function Rs(t,s){return t===s?t!==0||1/t===1/s:t!==t&&s!==s}function ee(t){return t instanceof Map}function pe(t){return t instanceof Set}function H(t){return t.copy_||t.base_}function Pe(t,s){if(ee(t))return new Map(t);if(pe(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const a=Ct(t);if(s===!0||s==="class_only"&&!a){const r=Object.getOwnPropertyDescriptors(t);delete r[M];let n=Reflect.ownKeys(r);for(let c=0;c<n.length;c++){const i=n[c],d=r[i];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(r[i]={configurable:!0,writable:!0,enumerable:d.enumerable,value:t[i]})}return Object.create(Y(t),r)}else{const r=Y(t);if(r!==null&&a)return{...t};const n=Object.create(r);return Object.assign(n,t)}}function Ae(t,s=!1){return fe(t)||K(t)||!q(t)||(ue(t)>1&&Object.defineProperties(t,{set:te,add:te,clear:te,delete:te}),Object.freeze(t),s&&Object.values(t).forEach(a=>Ae(a,!0))),t}function Hs(){_(2)}var te={value:Hs};function fe(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var qs={};function U(t){const s=qs[t];return s||_(0,t),s}var X;function Tt(){return X}function Us(t,s){return{drafts_:[],parent_:t,immer_:s,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ke(t,s){s&&(U("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=s)}function Te(t){Ie(t),t.drafts_.forEach(Vs),t.drafts_=null}function Ie(t){t===X&&(X=t.parent_)}function Ze(t){return X=Us(X,t)}function Vs(t){const s=t[M];s.type_===0||s.type_===1?s.revoke_():s.revoked_=!0}function Qe(t,s){s.unfinalizedDrafts_=s.drafts_.length;const a=s.drafts_[0];return t!==void 0&&t!==a?(a[M].modified_&&(Te(s),_(4)),q(t)&&(t=ce(s,t),s.parent_||le(s,t)),s.patches_&&U("Patches").generateReplacementPatches_(a[M].base_,t,s.patches_,s.inversePatches_)):t=ce(s,a,[]),Te(s),s.patches_&&s.patchListener_(s.patches_,s.inversePatches_),t!==St?t:void 0}function ce(t,s,a){if(fe(s))return s;const r=t.immer_.shouldUseStrictIteration(),n=s[M];if(!n)return ne(s,(c,i)=>Ye(t,n,s,c,i,a),r),s;if(n.scope_!==t)return s;if(!n.modified_)return le(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const c=n.copy_;let i=c,d=!1;n.type_===3&&(i=new Set(c),c.clear(),d=!0),ne(i,(h,o)=>Ye(t,n,c,h,o,a,d),r),le(t,c,!1),a&&t.patches_&&U("Patches").generatePatches_(n,a,t.patches_,t.inversePatches_)}return n.copy_}function Ye(t,s,a,r,n,c,i){if(n==null||typeof n!="object"&&!i)return;const d=fe(n);if(!(d&&!i)){if(K(n)){const h=c&&s&&s.type_!==3&&!Ce(s.assigned_,r)?c.concat(r):void 0,o=ce(t,n,h);if(Pt(a,r,o),K(o))t.canAutoFreeze_=!1;else return}else i&&a.add(n);if(q(n)&&!d){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||s&&s.base_&&s.base_[r]===n&&d)return;ce(t,n),(!s||!s.scope_.parent_)&&typeof r!="symbol"&&(ee(a)?a.has(r):Object.prototype.propertyIsEnumerable.call(a,r))&&le(t,n)}}}function le(t,s,a=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ae(s,a)}function Gs(t,s){const a=Array.isArray(t),r={type_:a?1:0,scope_:s?s.scope_:Tt(),modified_:!1,finalized_:!1,assigned_:{},parent_:s,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=r,c=De;a&&(n=[r],c=J);const{revoke:i,proxy:d}=Proxy.revocable(n,c);return r.draft_=d,r.revoke_=i,d}var De={get(t,s){if(s===M)return t;const a=H(t);if(!Ce(a,s))return Ws(t,a,s);const r=a[s];return t.finalized_||!q(r)?r:r===we(t.base_,s)?(ke(t),t.copy_[s]=_e(r,t)):r},has(t,s){return s in H(t)},ownKeys(t){return Reflect.ownKeys(H(t))},set(t,s,a){const r=It(H(t),s);if(r!=null&&r.set)return r.set.call(t.draft_,a),!0;if(!t.modified_){const n=we(H(t),s),c=n==null?void 0:n[M];if(c&&c.base_===a)return t.copy_[s]=a,t.assigned_[s]=!1,!0;if(Rs(a,n)&&(a!==void 0||Ce(t.base_,s)))return!0;ke(t),Me(t)}return t.copy_[s]===a&&(a!==void 0||s in t.copy_)||Number.isNaN(a)&&Number.isNaN(t.copy_[s])||(t.copy_[s]=a,t.assigned_[s]=!0),!0},deleteProperty(t,s){return we(t.base_,s)!==void 0||s in t.base_?(t.assigned_[s]=!1,ke(t),Me(t)):delete t.assigned_[s],t.copy_&&delete t.copy_[s],!0},getOwnPropertyDescriptor(t,s){const a=H(t),r=Reflect.getOwnPropertyDescriptor(a,s);return r&&{writable:!0,configurable:t.type_!==1||s!=="length",enumerable:r.enumerable,value:a[s]}},defineProperty(){_(11)},getPrototypeOf(t){return Y(t.base_)},setPrototypeOf(){_(12)}},J={};ne(De,(t,s)=>{J[t]=function(){return arguments[0]=arguments[0][0],s.apply(this,arguments)}});J.deleteProperty=function(t,s){return J.set.call(this,t,s,void 0)};J.set=function(t,s,a){return De.set.call(this,t[0],s,a,t[0])};function we(t,s){const a=t[M];return(a?H(a):t)[s]}function Ws(t,s,a){var n;const r=It(s,a);return r?"value"in r?r.value:(n=r.get)==null?void 0:n.call(t.draft_):void 0}function It(t,s){if(!(s in t))return;let a=Y(t);for(;a;){const r=Object.getOwnPropertyDescriptor(a,s);if(r)return r;a=Y(a)}}function Me(t){t.modified_||(t.modified_=!0,t.parent_&&Me(t.parent_))}function ke(t){t.copy_||(t.copy_=Pe(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Ks=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(s,a,r)=>{if(typeof s=="function"&&typeof a!="function"){const c=a;a=s;const i=this;return function(h=c,...o){return i.produce(h,l=>a.call(this,l,...o))}}typeof a!="function"&&_(6),r!==void 0&&typeof r!="function"&&_(7);let n;if(q(s)){const c=Ze(this),i=_e(s,void 0);let d=!0;try{n=a(i),d=!1}finally{d?Te(c):Ie(c)}return Ke(c,r),Qe(n,c)}else if(!s||typeof s!="object"){if(n=a(s),n===void 0&&(n=s),n===St&&(n=void 0),this.autoFreeze_&&Ae(n,!0),r){const c=[],i=[];U("Patches").generateReplacementPatches_(s,n,c,i),r(c,i)}return n}else _(1,s)},this.produceWithPatches=(s,a)=>{if(typeof s=="function")return(i,...d)=>this.produceWithPatches(i,h=>s(h,...d));let r,n;return[this.produce(s,a,(i,d)=>{r=i,n=d}),r,n]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){q(t)||_(8),K(t)&&(t=Zs(t));const s=Ze(this),a=_e(t,void 0);return a[M].isManual_=!0,Ie(s),a}finishDraft(t,s){const a=t&&t[M];(!a||!a.isManual_)&&_(9);const{scope_:r}=a;return Ke(r,s),Qe(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,s){let a;for(a=s.length-1;a>=0;a--){const n=s[a];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}a>-1&&(s=s.slice(a+1));const r=U("Patches").applyPatches_;return K(t)?r(t,s):this.produce(t,n=>r(n,s))}};function _e(t,s){const a=ee(t)?U("MapSet").proxyMap_(t,s):pe(t)?U("MapSet").proxySet_(t,s):Gs(t,s);return(s?s.scope_:Tt()).drafts_.push(a),a}function Zs(t){return K(t)||_(10,t),Mt(t)}function Mt(t){if(!q(t)||fe(t))return t;const s=t[M];let a,r=!0;if(s){if(!s.modified_)return s.base_;s.finalized_=!0,a=Pe(t,s.scope_.immer_.useStrictShallowCopy_),r=s.scope_.immer_.shouldUseStrictIteration()}else a=Pe(t,!0);return ne(a,(n,c)=>{Pt(a,n,Mt(c))},r),s&&(s.finalized_=!1),a}var Qs=new Ks,Ys=Qs.produce;const Xs=t=>(s,a,r)=>(r.setState=(n,c,...i)=>{const d=typeof n=="function"?Ys(n):n;return s(d,c,...i)},t(r.setState,a,r)),Js=Xs,Xe=1e5,Je=5e4,et=1e4,ea={packets:{total:0,tcp:0,udp:0,icmp:0,other:0},bytes:{total:0,inbound:0,outbound:0},flows:{total:0,active:0,completed:0},protocols:{},topTalkers:[],topPorts:[]},ta={isCapturing:!1,interface:"",startTime:0,packetsCaptured:0,packetsDropped:0,bytesProcessed:0,flowsActive:0,alertsGenerated:0},tt={activeView:"dashboard",selectedPacketId:null,selectedFlowId:null,selectedFileId:null,selectedAlertId:null,filters:{search:"",protocols:[],severities:[],srcIP:"",dstIP:"",port:null,minBytes:null,maxBytes:null},timeRange:{start:null,end:null,relative:"all"}},w=Bs()(Js((t,s)=>({packets:new Map,packetIds:[],flows:new Map,flowIds:[],files:new Map,alerts:new Map,alertIds:[],topology:{nodes:[],links:[]},statistics:ea,capture:ta,view:tt,addPackets:a=>t(r=>{for(const n of a)r.packets.set(n.id,n),r.packetIds.push(n.id);if(r.packetIds.length>Xe){const n=r.packetIds.splice(0,r.packetIds.length-Xe);for(const c of n)r.packets.delete(c)}}),clearPackets:()=>t(a=>{a.packets.clear(),a.packetIds=[]}),updateFlows:a=>t(r=>{for(const n of a)r.flows.has(n.id)||r.flowIds.push(n.id),r.flows.set(n.id,n);if(r.flowIds.length>Je){const n=r.flowIds.splice(0,r.flowIds.length-Je);for(const c of n)r.flows.delete(c)}}),clearFlows:()=>t(a=>{a.flows.clear(),a.flowIds=[]}),addFile:a=>t(r=>{r.files.set(a.id,a)}),clearFiles:()=>t(a=>{a.files.clear()}),addAlert:a=>t(r=>{if(r.alerts.set(a.id,a),r.alertIds.unshift(a.id),r.alertIds.length>et){const n=r.alertIds.splice(et);for(const c of n)r.alerts.delete(c)}}),clearAlerts:()=>t(a=>{a.alerts.clear(),a.alertIds=[]}),acknowledgeAlert:a=>t(r=>{r.alerts.get(a)}),updateStatistics:a=>t(r=>{r.statistics=a}),updateTopology:a=>t(r=>{r.topology=a}),updateCaptureState:a=>t(r=>{Object.assign(r.capture,a)}),startCapture:a=>t(r=>{r.capture.isCapturing=!0,r.capture.interface=a,r.capture.startTime=Date.now(),r.capture.packetsCaptured=0,r.capture.packetsDropped=0,r.capture.bytesProcessed=0}),stopCapture:()=>t(a=>{a.capture.isCapturing=!1}),setActiveView:a=>t(r=>{r.view.activeView=a}),selectPacket:a=>t(r=>{r.view.selectedPacketId=a}),selectFlow:a=>t(r=>{r.view.selectedFlowId=a}),selectFile:a=>t(r=>{r.view.selectedFileId=a}),selectAlert:a=>t(r=>{r.view.selectedAlertId=a}),setFilter:a=>t(r=>{Object.assign(r.view.filters,a)}),clearFilters:()=>t(a=>{a.view.filters=tt.filters}),setTimeRange:a=>t(r=>{r.view.timeRange=a}),getFilteredPackets:()=>{const a=s(),{filters:r}=a.view;let n=a.packetIds.map(i=>a.packets.get(i)).filter(Boolean);if(r.search){const i=r.search.toLowerCase();n=n.filter(d=>d.srcIP.includes(i)||d.dstIP.includes(i)||d.protocol.toLowerCase().includes(i))}r.protocols.length>0&&(n=n.filter(i=>r.protocols.includes(i.protocol))),r.srcIP&&(n=n.filter(i=>i.srcIP.includes(r.srcIP))),r.dstIP&&(n=n.filter(i=>i.dstIP.includes(r.dstIP))),r.port!==null&&(n=n.filter(i=>i.srcPort===r.port||i.dstPort===r.port));const{timeRange:c}=a.view;return c.start!==null&&(n=n.filter(i=>i.timestampNano>=c.start)),c.end!==null&&(n=n.filter(i=>i.timestampNano<=c.end)),n},getFilteredFlows:()=>{const a=s(),{filters:r}=a.view;let n=a.flowIds.map(c=>a.flows.get(c)).filter(Boolean);if(r.search){const c=r.search.toLowerCase();n=n.filter(i=>{var d,h;return i.srcIP.includes(c)||i.dstIP.includes(c)||i.protocol.toLowerCase().includes(c)||((d=i.metadata.serverName)==null?void 0:d.toLowerCase().includes(c))||((h=i.metadata.httpHost)==null?void 0:h.toLowerCase().includes(c))})}return r.protocols.length>0&&(n=n.filter(c=>r.protocols.includes(c.protocol))),r.minBytes!==null&&(n=n.filter(c=>c.byteCount>=r.minBytes)),r.maxBytes!==null&&(n=n.filter(c=>c.byteCount<=r.maxBytes)),n},getFilteredAlerts:()=>{const a=s(),{filters:r}=a.view;let n=a.alertIds.map(c=>a.alerts.get(c)).filter(Boolean);if(r.severities.length>0&&(n=n.filter(c=>r.severities.includes(c.severity))),r.search){const c=r.search.toLowerCase();n=n.filter(i=>i.title.toLowerCase().includes(c)||i.description.toLowerCase().includes(c))}return n},getSelectedPacket:()=>{const a=s();return a.view.selectedPacketId&&a.packets.get(a.view.selectedPacketId)||null},getSelectedFlow:()=>{const a=s();return a.view.selectedFlowId&&a.flows.get(a.view.selectedFlowId)||null}}))),_t=()=>w(t=>t.packetIds.length),Ft=()=>w(t=>t.flowIds.length),At=()=>w(t=>t.alertIds.length),Ee=()=>w(t=>t.capture),Le=()=>w(t=>t.statistics),Dt=()=>w(t=>t.view.activeView),sa=()=>w(t=>t.view.filters);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=(t,s)=>{const a=m.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:d="",children:h,...o},l)=>m.createElement("svg",{ref:l,...aa,width:n,height:n,stroke:r,strokeWidth:i?Number(c)*24/Number(n):c,className:["lucide",`lucide-${ra(t)}`,d].join(" "),...o},[...s.map(([x,g])=>m.createElement(x,g)),...Array.isArray(h)?h:[h]]));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=f("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=f("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=f("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=f("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=f("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=f("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=f("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=f("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=f("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=f("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=f("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=f("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=f("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=f("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=f("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=f("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=f("FileArchive",[["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v18",key:"1oywqq"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=f("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=f("FileCode",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=f("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=f("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=f("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=f("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=f("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=f("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=f("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=f("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=f("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=f("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=f("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=f("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=f("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=f("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=f("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=f("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=f("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=f("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=f("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=f("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=f("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=f("Router",[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=f("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=f("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=f("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=f("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=f("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=f("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=f("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=f("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=f("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=f("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=f("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=f("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=f("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=f("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=f("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=f("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),_a=[{id:"dashboard",label:"Dashboard",icon:pa},{id:"packets",label:"Packets",icon:ye,badge:_t},{id:"flows",label:"Flows",icon:Rt,badge:Ft},{id:"files",label:"Files",icon:Fe},{id:"alerts",label:"Alerts",icon:T,badge:At,badgeColor:"bg-threat-critical"},{id:"topology",label:"Topology",icon:ya}];function Fa(){const t=Dt(),s=w(n=>n.setActiveView),[a,r]=m.useState(!1);return e.jsxs("aside",{className:y("h-full bg-surface-raised border-r border-surface-border flex flex-col transition-all duration-300",a?"w-16":"w-56"),children:[e.jsx("nav",{className:"flex-1 py-4",children:e.jsx("ul",{className:"space-y-1 px-2",children:_a.map(n=>e.jsx(Aa,{item:n,isActive:t===n.id,collapsed:a,onClick:()=>s(n.id)},n.id))})}),e.jsx("div",{className:"p-2 border-t border-surface-border",children:e.jsx("button",{onClick:()=>r(!a),className:"w-full btn-icon flex items-center justify-center",children:a?e.jsx(Et,{className:"w-5 h-5 text-gray-400"}):e.jsx(ca,{className:"w-5 h-5 text-gray-400"})})})]})}function Aa({item:t,isActive:s,collapsed:a,onClick:r}){const n=t.badge?t.badge():0,c=t.icon;return e.jsx("li",{children:e.jsxs("button",{onClick:r,className:y("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200","hover:bg-surface-overlay group",s&&"bg-cyber-900/30 border-l-2 border-l-cyber-500 text-cyber-400",!s&&"text-gray-400 hover:text-white"),children:[e.jsx(c,{className:y("w-5 h-5 flex-shrink-0 transition-colors",s?"text-cyber-400":"text-gray-500 group-hover:text-gray-300")}),!a&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1 text-left text-sm font-medium",children:t.label}),n>0&&e.jsx("span",{className:y("px-2 py-0.5 rounded-full text-xs font-medium",t.badgeColor||"bg-cyber-600","text-white"),children:n>999?"999+":n})]}),a&&n>0&&e.jsx("span",{className:y("absolute right-1 top-1 w-2 h-2 rounded-full",t.badgeColor||"bg-cyber-500")})]})})}function Da(){const t=Ee(),s=Le(),{startCapture:a,stopCapture:r,setFilter:n}=w(),[c,i]=m.useState(""),d=x=>{x.preventDefault(),n({search:c})},h=()=>{t.isCapturing?r():a("eth0")},o=x=>{if(x===0)return"0 B";const g=1024,v=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(x)/Math.log(g));return parseFloat((x/Math.pow(g,k)).toFixed(2))+" "+v[k]},l=x=>x>=1e6?(x/1e6).toFixed(1)+"M":x>=1e3?(x/1e3).toFixed(1)+"K":x.toString();return e.jsxs("header",{className:"h-14 bg-surface-raised border-b border-surface-border flex items-center px-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyber-500 to-cyber-700 flex items-center justify-center",children:e.jsx(ie,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-lg font-bold text-gradient-cyber",children:"NFA-Linux"}),e.jsx("p",{className:"text-xxs text-gray-500 -mt-1",children:"Network Forensics Analyzer"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{onClick:h,className:`btn ${t.isCapturing?"btn-danger":"btn-primary"} flex items-center gap-2`,children:t.isCapturing?e.jsxs(e.Fragment,{children:[e.jsx(wa,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Stop"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ja,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Capture"})]})}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[t.isCapturing?e.jsx(je,{className:"w-4 h-4 text-green-500 animate-pulse"}):e.jsx(Pa,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-xs text-gray-400",children:t.isCapturing?t.interface:"Idle"})]})]}),e.jsx("form",{onSubmit:d,className:"flex-1 max-w-md mx-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:c,onChange:x=>i(x.target.value),placeholder:"Search packets, flows, IPs...",className:"input w-full pl-10 pr-4"})]})}),e.jsxs("div",{className:"hidden lg:flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[e.jsx(Z,{className:"w-4 h-4 text-cyber-400"}),e.jsx("span",{className:"text-gray-400",children:"Packets:"}),e.jsx("span",{className:"text-white font-mono",children:l(s.packets.total)})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[e.jsx(Lt,{className:"w-4 h-4 text-protocol-tcp"}),e.jsx("span",{className:"text-gray-400",children:"Flows:"}),e.jsx("span",{className:"text-white font-mono",children:l(s.flows.active)})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-overlay",children:[e.jsx(ie,{className:"w-4 h-4 text-protocol-udp"}),e.jsx("span",{className:"text-gray-400",children:"Data:"}),e.jsx("span",{className:"text-white font-mono",children:o(s.bytes.total)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"btn-icon relative",children:[e.jsx(na,{className:"w-5 h-5 text-gray-400"}),s.flows.total>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-threat-critical text-white text-xxs rounded-full flex items-center justify-center",children:"!"})]}),e.jsx("button",{className:"btn-icon",children:e.jsx(Na,{className:"w-5 h-5 text-gray-400"})})]})]})}function Ea(){const t=Ee(),s=Le(),[a,r]=m.useState(new Date),[n,c]=m.useState(0),[i,d]=m.useState(0);m.useEffect(()=>{const x=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(x)},[]),m.useEffect(()=>{const x=setInterval(()=>{const g=s.packets.total-i;c(g),d(s.packets.total)},1e3);return()=>clearInterval(x)},[s.packets.total,i]);const h=()=>{if(!t.isCapturing||t.startTime===0)return"00:00:00";const x=Math.floor((Date.now()-t.startTime)/1e3),g=Math.floor(x/3600),v=Math.floor(x%3600/60),k=x%60;return`${g.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`},o=x=>{if(x===0)return"0 B";const g=1024,v=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(x)/Math.log(g));return parseFloat((x/Math.pow(g,k)).toFixed(2))+" "+v[k]},l=()=>t.packetsCaptured===0?"0%":(t.packetsDropped/t.packetsCaptured*100).toFixed(2)+"%";return e.jsxs("footer",{className:"h-7 bg-surface-raised border-t border-surface-border flex items-center px-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`status-dot ${t.isCapturing?"status-dot-active":"status-dot-inactive"}`}),e.jsx("span",{children:t.isCapturing?"Capturing":"Idle"})]}),t.interface&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsx("span",{children:t.interface})]}),t.isCapturing&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3"}),e.jsx("span",{className:"font-mono",children:h()})]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ta,{className:"w-3 h-3 text-cyber-400"}),e.jsx("span",{className:"font-mono",children:n.toLocaleString()}),e.jsx("span",{className:"text-gray-600",children:"pps"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3 text-protocol-tcp"}),e.jsx("span",{className:"font-mono",children:s.packets.total.toLocaleString()}),e.jsx("span",{className:"text-gray-600",children:"packets"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Lt,{className:"w-3 h-3 text-protocol-udp"}),e.jsx("span",{className:"font-mono",children:o(s.bytes.total)})]}),t.isCapturing&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-600",children:"Drops:"}),e.jsx("span",{className:`font-mono ${t.packetsDropped>0?"text-threat-medium":"text-green-500"}`,children:l()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:a.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("span",{className:"font-mono text-gray-400",children:a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]})}const La={cyber:{bg:"bg-cyber-500/10",icon:"text-cyber-400",border:"border-cyber-500/30"},blue:{bg:"bg-blue-500/10",icon:"text-blue-400",border:"border-blue-500/30"},green:{bg:"bg-green-500/10",icon:"text-green-400",border:"border-green-500/30"},red:{bg:"bg-red-500/10",icon:"text-red-400",border:"border-red-500/30"},gray:{bg:"bg-gray-500/10",icon:"text-gray-400",border:"border-gray-500/30"}};function ae({title:t,value:s,subtitle:a,icon:r,trend:n,trendValue:c,color:i="cyber",highlight:d=!1}){const h=La[i];return e.jsx("div",{className:y("panel p-4 transition-all duration-300",d&&"glow-threat animate-pulse-slow"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:t}),e.jsx("p",{className:"text-2xl font-bold text-white font-mono",children:s}),a&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a}),n&&c&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[n==="up"?e.jsx(Ca,{className:"w-3 h-3 text-green-500"}):e.jsx(Sa,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{className:y("text-xs",n==="up"?"text-green-500":"text-red-500"),children:c})]})]}),e.jsx("div",{className:y("p-3 rounded-lg",h.bg),children:e.jsx(r,{className:y("w-6 h-6",h.icon)})})]})})}const at={TCP:"#3b82f6",UDP:"#22c55e",ICMP:"#f97316",DNS:"#8b5cf6",HTTP:"#06b6d4",HTTPS:"#10b981",TLS:"#10b981",SMB:"#f59e0b",QUIC:"#ec4899",SSH:"#6366f1",FTP:"#84cc16",Other:"#6b7280"};function $a({protocols:t}){const s=Object.entries(t).map(([c,i])=>({name:c,value:i})).sort((c,i)=>i.value-c.value).slice(0,8);if(s.length===0)return e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsx("p",{children:"No protocol data available"})});const a=s.reduce((c,i)=>c+i.value,0),r=({active:c,payload:i})=>{if(c&&i&&i.length){const d=i[0],h=d.value??0,o=(h/a*100).toFixed(1);return e.jsxs("div",{className:"bg-surface-overlay border border-surface-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:d.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[h.toLocaleString()," packets (",o,"%)"]})]})}return null},n=c=>{const{payload:i}=c;return i?e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-4",children:i.map((d,h)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:d.color}}),e.jsx("span",{className:"text-xs text-gray-400",children:d.value})]},h))}):null};return e.jsx(ft,{width:"100%",height:"100%",children:e.jsxs(Kt,{children:[e.jsx(Zt,{data:s,cx:"50%",cy:"45%",innerRadius:60,outerRadius:90,paddingAngle:2,dataKey:"value",animationBegin:0,animationDuration:800,children:s.map((c,i)=>e.jsx(Qt,{fill:at[c.name]||at.Other,stroke:"transparent"},`cell-${i}`))}),e.jsx(gt,{content:e.jsx(r,{})}),e.jsx(Yt,{content:n})]})})}function za(){const[t,s]=m.useState([]),a=m.useRef();m.useEffect(()=>{const n=[],c=Date.now();for(let i=60;i>=0;i--){const d=c-i*5e3;n.push({time:new Date(d).toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"}),timestamp:d,packets:Math.floor(Math.random()*1e3),bytes:Math.floor(Math.random()*1e5),tcp:Math.floor(Math.random()*700),udp:Math.floor(Math.random()*300)})}return s(n),a.current=setInterval(()=>{s(i=>{const d={time:new Date().toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"}),timestamp:Date.now(),packets:Math.floor(Math.random()*1e3),bytes:Math.floor(Math.random()*1e5),tcp:Math.floor(Math.random()*700),udp:Math.floor(Math.random()*300)};return[...i.slice(1),d]})},5e3),()=>{a.current&&clearInterval(a.current)}},[]);const r=({active:n,payload:c,label:i})=>{var d,h,o,l;return n&&c&&c.length?e.jsxs("div",{className:"bg-surface-overlay border border-surface-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:i}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-protocol-tcp",children:"TCP: "}),e.jsx("span",{className:"font-mono text-white",children:(h=(d=c[0])==null?void 0:d.value)==null?void 0:h.toLocaleString()})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-protocol-udp",children:"UDP: "}),e.jsx("span",{className:"font-mono text-white",children:(l=(o=c[1])==null?void 0:o.value)==null?void 0:l.toLocaleString()})]})]})]}):null};return t.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsx("p",{children:"Loading timeline data..."})}):e.jsx(ft,{width:"100%",height:"100%",children:e.jsxs(Xt,{data:t,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"tcpGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"udpGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#22c55e",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#22c55e",stopOpacity:0})]})]}),e.jsx(Jt,{strokeDasharray:"3 3",stroke:"#2a2a3a",vertical:!1}),e.jsx(es,{dataKey:"time",stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:10},tickLine:{stroke:"#2a2a3a"},axisLine:{stroke:"#2a2a3a"},interval:"preserveStartEnd"}),e.jsx(ts,{stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:10},tickLine:{stroke:"#2a2a3a"},axisLine:{stroke:"#2a2a3a"},tickFormatter:n=>n.toLocaleString()}),e.jsx(gt,{content:e.jsx(r,{})}),e.jsx(Oe,{type:"monotone",dataKey:"tcp",stackId:"1",stroke:"#3b82f6",strokeWidth:2,fill:"url(#tcpGradient)",animationDuration:300}),e.jsx(Oe,{type:"monotone",dataKey:"udp",stackId:"1",stroke:"#22c55e",strokeWidth:2,fill:"url(#udpGradient)",animationDuration:300})]})})}function Ba({talkers:t}){const s=r=>{if(r===0)return"0 B";const n=1024,c=["B","KB","MB","GB"],i=Math.floor(Math.log(r)/Math.log(n));return parseFloat((r/Math.pow(n,i)).toFixed(1))+" "+c[i]};if(t.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-4",children:e.jsx("p",{className:"text-sm",children:"No traffic data yet"})});const a=Math.max(...t.map(r=>r.bytes));return e.jsx("div",{className:"space-y-3",children:t.slice(0,5).map((r,n)=>{const c=r.bytes/a*100;return e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:y("w-5 h-5 rounded text-xs font-medium flex items-center justify-center",n===0&&"bg-cyber-600 text-white",n===1&&"bg-cyber-700 text-white",n===2&&"bg-cyber-800 text-white",n>2&&"bg-surface-overlay text-gray-400"),children:n+1}),e.jsx("span",{className:"font-mono text-sm text-gray-300 group-hover:text-white transition-colors",children:r.ip})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[r.packets.toLocaleString()," pkts"]}),e.jsx("span",{className:"text-xs text-gray-600 mx-1",children:""}),e.jsx("span",{className:"text-xs font-mono text-gray-400",children:s(r.bytes)})]})]}),e.jsx("div",{className:"h-1.5 bg-surface-overlay rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyber-600 to-cyber-400 rounded-full transition-all duration-500",style:{width:`${c}%`}})})]},r.ip)})})}const Oa={critical:{color:"text-threat-critical",bg:"bg-threat-critical/10"},high:{color:"text-threat-high",bg:"bg-threat-high/10"},medium:{color:"text-threat-medium",bg:"bg-threat-medium/10"},low:{color:"text-threat-low",bg:"bg-threat-low/10"},info:{color:"text-threat-info",bg:"bg-threat-info/10"}},Ra={malware:ze,c2:je,exfiltration:R,lateral_movement:O,credential_access:O,reconnaissance:R,anomaly:T,policy_violation:O,suspicious:T};function Ha(){const t=w(c=>c.alertIds.slice(0,5).map(i=>c.alerts.get(i)).filter(Boolean)),s=w(c=>c.selectAlert),a=w(c=>c.setActiveView),r=c=>{s(c.id),a("alerts")},n=c=>new Date(c/1e6).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});return t.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-4",children:[e.jsx(O,{className:"w-8 h-8 mx-auto mb-2 text-green-500/50"}),e.jsx("p",{className:"text-sm",children:"No alerts detected"})]}):e.jsx("div",{className:"space-y-2",children:t.map(c=>{const i=Oa[c.severity],d=Ra[c.category]||T;return e.jsx("button",{onClick:()=>r(c),className:y("w-full p-3 rounded-lg text-left transition-all duration-200","hover:bg-surface-overlay group",i.bg),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:y("p-1.5 rounded",i.bg),children:e.jsx(d,{className:y("w-4 h-4",i.color)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:y("text-sm font-medium truncate",i.color),children:c.title}),e.jsx("span",{className:"text-xxs text-gray-500 flex-shrink-0",children:n(c.timestampNano)})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:c.description}),c.sourceIP&&e.jsxs("p",{className:"text-xxs text-gray-600 font-mono mt-1",children:[c.sourceIP,"  ",c.destIP]})]})]})},c.id)})})}const qa={packet:"text-protocol-tcp",flow:"text-protocol-udp",alert:"text-threat-high",file:"text-cyber-400"},Ua={packet:"PKT",flow:"FLW",alert:"ALT",file:"FIL"};function Va(){const[t,s]=m.useState([]),a=m.useRef(null);m.useEffect(()=>{const n=["TCP","UDP","DNS","HTTP","HTTPS","SMB","QUIC"],c=["packet","flow","packet","packet","flow","alert"],i=()=>{const o=c[Math.floor(Math.random()*c.length)],l=n[Math.floor(Math.random()*n.length)],x=`192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,g=`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`;let v="";switch(o){case"packet":v=`${l} ${x}:${Math.floor(Math.random()*65535)}  ${g}:${Math.floor(Math.random()*1024)}`;break;case"flow":v=`New ${l} flow established`;break;case"alert":v=`Suspicious ${l} activity detected`;break;case"file":v=`File extracted from ${l} stream`;break}return{id:Math.random().toString(36).substr(2,9),timestamp:Date.now(),type:o,message:v,protocol:l,srcIP:x,dstIP:g}},d=[];for(let o=0;o<10;o++)d.push(i());s(d);const h=setInterval(()=>{s(o=>[i(),...o.slice(0,19)])},500);return()=>clearInterval(h)},[]);const r=n=>new Date(n).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.jsx("div",{ref:a,className:"h-full overflow-hidden font-mono text-xs",children:e.jsx("div",{className:"space-y-0.5",children:t.map((n,c)=>e.jsxs("div",{className:y("flex items-center gap-2 py-0.5 px-1 rounded transition-all duration-300","hover:bg-surface-overlay",c===0&&"animate-pulse bg-surface-overlay/50"),children:[e.jsx("span",{className:"text-gray-600 w-20 flex-shrink-0",children:r(n.timestamp)}),e.jsx("span",{className:y("w-8 flex-shrink-0 font-semibold",qa[n.type]),children:Ua[n.type]}),e.jsx("span",{className:"text-gray-400 truncate",children:n.message})]},n.id))})})}function rt(){const t=Le(),s=Ee(),a=_t();Ft();const r=At(),n=c=>{if(c===0)return"0 B";const i=1024,d=["B","KB","MB","GB","TB"],h=Math.floor(Math.log(c)/Math.log(i));return parseFloat((c/Math.pow(i,h)).toFixed(2))+" "+d[h]};return e.jsxs("div",{className:"h-full overflow-auto p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(ae,{title:"Total Packets",value:a.toLocaleString(),icon:ye,trend:s.isCapturing?"up":void 0,trendValue:s.isCapturing?"+"+t.packets.tcp+"/s":void 0,color:"cyber"}),e.jsx(ae,{title:"Active Flows",value:t.flows.active.toLocaleString(),subtitle:`${t.flows.completed.toLocaleString()} completed`,icon:Rt,color:"blue"}),e.jsx(ae,{title:"Data Processed",value:n(t.bytes.total),subtitle:` ${n(t.bytes.outbound)}  ${n(t.bytes.inbound)}`,icon:ie,color:"green"}),e.jsx(ae,{title:"Alerts",value:r.toString(),icon:T,color:r>0?"red":"gray",highlight:r>0})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{className:"panel-title",children:"Traffic Timeline"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-xs text-gray-500",children:"Last 5 minutes"})})]}),e.jsx("div",{className:"panel-content h-64",children:e.jsx(za,{})})]}),e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h2",{className:"panel-title",children:"Protocol Distribution"})}),e.jsx("div",{className:"panel-content h-64",children:e.jsx($a,{protocols:t.protocols})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{className:"panel-title",children:"Live Activity"}),e.jsx("div",{className:"status-dot status-dot-active"})]}),e.jsx("div",{className:"panel-content h-48 overflow-hidden",children:e.jsx(Va,{})})]}),e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h2",{className:"panel-title",children:"Top Talkers"})}),e.jsx("div",{className:"panel-content",children:e.jsx(Ba,{talkers:t.topTalkers})})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h2",{className:"panel-title",children:"Recent Alerts"}),r>0&&e.jsx("span",{className:"badge badge-threat-critical",children:r})]}),e.jsx("div",{className:"panel-content",children:e.jsx(Ha,{})})]})]})]})]})}const nt={TCP:"badge-protocol-tcp",UDP:"badge-protocol-udp",ICMP:"badge-protocol-icmp",ICMPv6:"badge-protocol-icmp",DNS:"badge-protocol-dns",HTTP:"badge-protocol-http",HTTPS:"badge-protocol-https",TLS:"badge-protocol-https",SMB:"badge-protocol-smb",QUIC:"badge-protocol-quic",HTTP3:"badge-protocol-quic",FTP:"badge-protocol-http",SSH:"badge-protocol-dns",SMTP:"badge-protocol-http",IMAP:"badge-protocol-http",POP3:"badge-protocol-http",ARP:"badge-protocol-icmp",DHCP:"badge-protocol-udp",NTP:"badge-protocol-udp",Unknown:"bg-gray-500/20 text-gray-400"},ct=32;function Ga(){const t=m.useRef(null),s=w(o=>o.getFilteredPackets()),a=w(o=>o.view.selectedPacketId),r=w(o=>o.selectPacket),n=xe({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>ct,overscan:20}),c=n.getVirtualItems(),i=m.useCallback(o=>new Date(o/1e6).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),[]),d=m.useCallback(o=>{r(o.id)},[r]),h=m.useCallback(o=>{if(!a)return;const l=s.findIndex(x=>x.id===a);l!==-1&&(o.key==="ArrowDown"&&l<s.length-1?(o.preventDefault(),r(s[l+1].id),n.scrollToIndex(l+1)):o.key==="ArrowUp"&&l>0&&(o.preventDefault(),r(s[l-1].id),n.scrollToIndex(l-1)))},[a,s,r,n]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-12 px-2 py-2 text-center",children:"#"}),e.jsx("div",{className:"w-24 px-2 py-2",children:"Time"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Source"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Destination"}),e.jsx("div",{className:"w-20 px-2 py-2",children:"Protocol"}),e.jsx("div",{className:"w-20 px-2 py-2 text-right",children:"Length"}),e.jsx("div",{className:"w-48 px-2 py-2",children:"Info"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto focus:outline-none",tabIndex:0,onKeyDown:h,children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:c.map(o=>{const l=s[o.index],x=l.id===a;return e.jsxs("div",{"data-index":o.index,ref:n.measureElement,className:y("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",x&&"table-row-selected bg-cyber-900/30"),style:{height:`${ct}px`,transform:`translateY(${o.start}px)`},onClick:()=>d(l),children:[e.jsx("div",{className:"w-12 px-2 text-center text-xs text-gray-600 font-mono",children:o.index+1}),e.jsx("div",{className:"w-24 px-2 text-xs font-mono text-gray-400",children:i(l.timestampNano)}),e.jsxs("div",{className:"flex-1 px-2 text-xs font-mono text-gray-300 truncate",children:[l.srcIP,l.srcPort>0&&e.jsxs("span",{className:"text-gray-500",children:[":",l.srcPort]})]}),e.jsxs("div",{className:"flex-1 px-2 text-xs font-mono text-gray-300 truncate",children:[l.dstIP,l.dstPort>0&&e.jsxs("span",{className:"text-gray-500",children:[":",l.dstPort]})]}),e.jsx("div",{className:"w-20 px-2",children:e.jsx("span",{className:y("badge",nt[l.protocol]||nt.Unknown),children:l.protocol})}),e.jsx("div",{className:"w-20 px-2 text-xs font-mono text-gray-400 text-right",children:l.length}),e.jsx("div",{className:"w-48 px-2 text-xs text-gray-500 truncate",children:Wa(l)})]},o.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," packets",a&&e.jsxs("span",{className:"ml-2",children:[" Selected: #",s.findIndex(o=>o.id===a)+1]})]})]})}function Wa(t){for(const s of t.layers){if(s.name==="DNS"&&s.fields){const a=s.fields.queryName;if(a)return`Query: ${a}`}if(s.name==="HTTP"&&s.fields){const a=s.fields.method,r=s.fields.uri;if(a&&r)return`${a} ${r}`}if(s.name==="TLS"&&s.fields){const a=s.fields.serverName;if(a)return`SNI: ${a}`}}switch(t.protocol){case"TCP":return`${t.srcPort}  ${t.dstPort}`;case"UDP":return`${t.srcPort}  ${t.dstPort}`;case"ICMP":case"ICMPv6":return"Echo request/reply";default:return""}}function Ka({packet:t}){const[s,a]=m.useState(new Set(["Ethernet","IPv4","IPv6","TCP","UDP"])),[r,n]=m.useState(null),c=o=>{a(l=>{const x=new Set(l);return x.has(o)?x.delete(o):x.add(o),x})},i=async(o,l)=>{await navigator.clipboard.writeText(o),n(l),setTimeout(()=>n(null),2e3)},d=o=>new Date(o/1e6).toISOString(),h=o=>o==null?"null":typeof o=="boolean"?o?"true":"false":typeof o=="number"?o.toString():typeof o=="string"?o:Array.isArray(o)?o.join(", "):typeof o=="object"?JSON.stringify(o):String(o);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Packet Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Timestamp:"}),e.jsx("span",{className:"ml-2 font-mono text-gray-300",children:d(t.timestampNano)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Length:"}),e.jsxs("span",{className:"ml-2 font-mono text-gray-300",children:[t.length," bytes"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Protocol:"}),e.jsx("span",{className:"ml-2 font-mono text-gray-300",children:t.protocol})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Interface:"}),e.jsx("span",{className:"ml-2 font-mono text-gray-300",children:t.metadata.captureInterface})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Protocol Layers"}),t.layers.map((o,l)=>{const x=s.has(o.name),g=Object.entries(o.fields||{});return e.jsxs("div",{className:"border border-surface-border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>c(o.name),className:"w-full flex items-center justify-between px-3 py-2 bg-surface-overlay hover:bg-surface-border transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x?e.jsx(oe,{className:"w-4 h-4 text-gray-500"}):e.jsx(Et,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-cyber-400",children:o.name})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," bytes @ offset ",o.offset]})]}),x&&g.length>0&&e.jsx("div",{className:"px-3 py-2 space-y-1 bg-surface",children:g.map(([v,k])=>e.jsxs("div",{className:"flex items-center justify-between group text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[Za(v),":"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300 max-w-48 truncate",children:h(k)}),e.jsx("button",{onClick:()=>i(h(k),v),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:r===v?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]})]},v))})]},`${o.name}-${l}`)})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Metadata"}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Direction:"}),e.jsx("span",{className:"text-gray-300",children:t.metadata.direction})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Checksum Valid:"}),e.jsx("span",{className:t.metadata.checksumValid?"text-green-400":"text-red-400",children:t.metadata.checksumValid?"Yes":"No"})]}),t.metadata.vlanId&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"VLAN ID:"}),e.jsx("span",{className:"text-gray-300",children:t.metadata.vlanId})]}),t.metadata.truncated&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Truncated:"}),e.jsx("span",{className:"text-yellow-400",children:"Yes"})]})]})]})]})}function Za(t){return t.replace(/([A-Z])/g," $1").replace(/^./,s=>s.toUpperCase()).trim()}const V=16;function Qa({data:t,highlightRanges:s=[],onByteSelect:a,selectedOffset:r}){const[n,c]=m.useState(""),[i,d]=m.useState([]),[h,o]=m.useState(0),[l,x]=m.useState(null),g=m.useRef(null),v=m.useMemo(()=>{const j=[];for(let u=0;u<t.length;u+=V){const b=[];let N="";for(let S=0;S<V;S++)if(u+S<t.length){const C=t[u+S];b.push(C),N+=C>=32&&C<=126?String.fromCharCode(C):"."}else b.push(null),N+=" ";j.push({offset:u,bytes:b,ascii:N})}return j},[t]),k=m.useCallback(()=>{if(!n){d([]);return}const j=[],u=n.toLowerCase();if(/^[0-9a-f\s]+$/i.test(u)){const S=(u.replace(/\s/g,"").match(/.{1,2}/g)||[]).map(C=>parseInt(C,16));for(let C=0;C<=t.length-S.length;C++){let P=!0;for(let $=0;$<S.length;$++)if(t[C+$]!==S[$]){P=!1;break}P&&j.push(C)}}const b=Array.from(u).map(N=>N.charCodeAt(0));for(let N=0;N<=t.length-b.length;N++){let S=!0;for(let C=0;C<b.length;C++){const P=t[N+C],$=b[C];if(P!==$&&!(P>=65&&P<=90&&P+32===$)&&!(P>=97&&P<=122&&P-32===$)){S=!1;break}}S&&!j.includes(N)&&j.push(N)}d(j.sort((N,S)=>N-S)),o(0)},[n,t]),p=m.useCallback(j=>{var C;if(i.length===0)return;let u=h;j==="next"?u=(h+1)%i.length:u=(h-1+i.length)%i.length,o(u);const b=i[u],N=Math.floor(b/V),S=(C=g.current)==null?void 0:C.querySelector(`[data-row="${N}"]`);S==null||S.scrollIntoView({behavior:"smooth",block:"center"})},[i,h]),A=m.useCallback(async j=>{const u=t[j];await navigator.clipboard.writeText(u.toString(16).padStart(2,"0")),x(j),setTimeout(()=>x(null),1500)},[t]),I=m.useCallback(j=>{if(i.length>0){const u=i[h];if(j>=u&&j<u+n.length)return{color:"bg-yellow-500/50"};for(const b of i)if(j>=b&&j<b+n.length)return{color:"bg-yellow-500/20"}}for(const u of s)if(j>=u.start&&j<u.end)return{color:u.color,label:u.label};return null},[s,i,h,n]),E=m.useCallback(j=>j.toString(16).padStart(8,"0").toUpperCase(),[]),L=m.useCallback(j=>j===null?"  ":j.toString(16).padStart(2,"0").toUpperCase(),[]);return e.jsxs("div",{className:"h-full flex flex-col bg-surface",children:[e.jsxs("div",{className:"p-2 border-b border-surface-border flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Be,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:n,onChange:j=>c(j.target.value),onKeyDown:j=>j.key==="Enter"&&k(),placeholder:"Search hex or ASCII...",className:"input w-full pl-8 pr-4 py-1 text-xs"})]}),e.jsx("button",{onClick:k,className:"btn btn-secondary py-1 px-2 text-xs",children:"Find"}),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[h+1,"/",i.length]}),e.jsx("button",{onClick:()=>p("prev"),className:"btn-icon p-1",children:e.jsx(la,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:()=>p("next"),className:"btn-icon p-1",children:e.jsx(oe,{className:"w-4 h-4 text-gray-400"})})]})]}),e.jsx("div",{ref:g,className:"flex-1 overflow-auto font-mono text-xs",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-surface-raised",children:e.jsxs("tr",{className:"text-gray-500",children:[e.jsx("th",{className:"px-2 py-1 text-left w-20",children:"Offset"}),e.jsx("th",{className:"px-2 py-1 text-left",colSpan:V,children:e.jsx("div",{className:"flex",children:Array.from({length:V},(j,u)=>e.jsx("span",{className:"w-6 text-center",children:u.toString(16).toUpperCase()},u))})}),e.jsx("th",{className:"px-2 py-1 text-left w-40",children:"ASCII"})]})}),e.jsx("tbody",{children:v.map(j=>e.jsxs("tr",{"data-row":Math.floor(j.offset/V),className:"hover:bg-surface-overlay",children:[e.jsx("td",{className:"px-2 py-0.5 hex-offset",children:E(j.offset)}),e.jsx("td",{className:"px-2 py-0.5",children:e.jsx("div",{className:"flex",children:j.bytes.map((u,b)=>{const N=j.offset+b,S=u!==null?I(N):null,C=N===r,P=u!==null&&u>=32&&u<=126;return e.jsxs("span",{className:y("w-6 text-center cursor-pointer transition-colors","hex-byte",P?"hex-byte-printable":"hex-byte-nonprintable",C&&"hex-byte-selected",S==null?void 0:S.color,u===null&&"opacity-0"),onClick:()=>u!==null&&(a==null?void 0:a(N)),onDoubleClick:()=>u!==null&&A(N),title:u!==null?`Offset: ${N} (0x${E(N)})
Value: ${u} (0x${L(u)})`:void 0,children:[L(u),l===N&&e.jsx(D,{className:"inline w-3 h-3 text-green-500 ml-0.5"})]},b)})})}),e.jsx("td",{className:"px-2 py-0.5 hex-ascii border-l border-surface-border",children:e.jsx("div",{className:"flex",children:j.ascii.split("").map((u,b)=>{const N=j.offset+b,S=I(N),C=N===r,P=u!=="."&&u!==" ";return e.jsx("span",{className:y("w-2 text-center cursor-pointer",P?"text-gray-300":"text-gray-600",C&&"bg-cyber-600 text-white rounded",S==null?void 0:S.color),onClick:()=>j.bytes[b]!==null&&(a==null?void 0:a(N)),children:u},b)})})})]},j.offset))})]})}),e.jsxs("div",{className:"px-2 py-1 border-t border-surface-border text-xs text-gray-500 flex items-center justify-between",children:[e.jsxs("span",{children:[t.length," bytes"]}),r!==void 0&&e.jsxs("span",{children:["Selected: 0x",E(r)," (",r,")"]})]})]})}const Ya=["TCP","UDP","ICMP","DNS","HTTP","HTTPS","TLS","SMB","QUIC","HTTP3","SSH","FTP"],Xa=["critical","high","medium","low","info"];function be(){const t=sa(),{setFilter:s,clearFilters:a}=w(),[r,n]=m.useState(!1),[c,i]=m.useState(!1),d=t.search||t.protocols.length>0||t.severities.length>0||t.srcIP||t.dstIP||t.port!==null,h=l=>{const x=t.protocols.includes(l)?t.protocols.filter(g=>g!==l):[...t.protocols,l];s({protocols:x})},o=l=>{const x=t.severities.includes(l)?t.severities.filter(g=>g!==l):[...t.severities,l];s({severities:x})};return e.jsxs("div",{className:"px-4 py-3 border-b border-surface-border bg-surface-raised",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:t.search,onChange:l=>s({search:l.target.value}),placeholder:"Search IPs, protocols, hostnames...",className:"input w-full pl-10 pr-4"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>n(!r),className:y("btn btn-secondary flex items-center gap-2",t.protocols.length>0&&"border-cyber-500 text-cyber-400"),children:[e.jsx(Ot,{className:"w-4 h-4"}),e.jsx("span",{children:"Protocol"}),t.protocols.length>0&&e.jsx("span",{className:"bg-cyber-600 text-white text-xs px-1.5 py-0.5 rounded",children:t.protocols.length}),e.jsx(oe,{className:"w-4 h-4"})]}),r&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-surface-raised border border-surface-border rounded-lg shadow-lg z-20",children:e.jsx("div",{className:"p-2 max-h-64 overflow-auto",children:Ya.map(l=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-surface-overlay rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.protocols.includes(l),onChange:()=>h(l),className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:l})]},l))})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>i(!c),className:y("btn btn-secondary flex items-center gap-2",t.severities.length>0&&"border-threat-high text-threat-high"),children:[e.jsx("span",{children:"Severity"}),t.severities.length>0&&e.jsx("span",{className:"bg-threat-high text-white text-xs px-1.5 py-0.5 rounded",children:t.severities.length}),e.jsx(oe,{className:"w-4 h-4"})]}),c&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-40 bg-surface-raised border border-surface-border rounded-lg shadow-lg z-20",children:e.jsx("div",{className:"p-2",children:Xa.map(l=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-surface-overlay rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.severities.includes(l),onChange:()=>o(l),className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),e.jsx("span",{className:y("text-sm capitalize",l==="critical"&&"text-threat-critical",l==="high"&&"text-threat-high",l==="medium"&&"text-threat-medium",l==="low"&&"text-threat-low",l==="info"&&"text-threat-info"),children:l})]},l))})})]}),e.jsx("input",{type:"text",value:t.srcIP,onChange:l=>s({srcIP:l.target.value}),placeholder:"Source IP",className:"input w-32"}),e.jsx("input",{type:"text",value:t.dstIP,onChange:l=>s({dstIP:l.target.value}),placeholder:"Dest IP",className:"input w-32"}),e.jsx("input",{type:"number",value:t.port??"",onChange:l=>s({port:l.target.value?parseInt(l.target.value):null}),placeholder:"Port",className:"input w-20"}),d&&e.jsxs("button",{onClick:a,className:"btn btn-secondary flex items-center gap-1 text-red-400 hover:text-red-300",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Clear"})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Active filters:"}),t.protocols.map(l=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-cyber-900/30 text-cyber-400 text-xs rounded",children:[l,e.jsx("button",{onClick:()=>h(l),children:e.jsx(G,{className:"w-3 h-3"})})]},l)),t.severities.map(l=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-threat-high/20 text-threat-high text-xs rounded capitalize",children:[l,e.jsx("button",{onClick:()=>o(l),children:e.jsx(G,{className:"w-3 h-3"})})]},l)),t.srcIP&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-surface-overlay text-gray-300 text-xs rounded",children:["src: ",t.srcIP,e.jsx("button",{onClick:()=>s({srcIP:""}),children:e.jsx(G,{className:"w-3 h-3"})})]}),t.dstIP&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-surface-overlay text-gray-300 text-xs rounded",children:["dst: ",t.dstIP,e.jsx("button",{onClick:()=>s({dstIP:""}),children:e.jsx(G,{className:"w-3 h-3"})})]})]})]})}function Ja(){const t=w(r=>r.view.selectedPacketId),s=w(r=>t?r.packets.get(t):null),[a]=m.useState(!0);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(be,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(Ga,{})}),s&&e.jsxs("div",{className:"w-96 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-auto border-b border-surface-border",children:e.jsx(Ka,{packet:s})}),a&&s.payload&&e.jsx("div",{className:"h-64 overflow-auto",children:e.jsx(Qa,{data:s.payload})})]})]})]})}const lt={TCP:"badge-protocol-tcp",UDP:"badge-protocol-udp",ICMP:"badge-protocol-icmp",ICMPv6:"badge-protocol-icmp",DNS:"badge-protocol-dns",HTTP:"badge-protocol-http",HTTPS:"badge-protocol-https",TLS:"badge-protocol-https",SMB:"badge-protocol-smb",QUIC:"badge-protocol-quic",HTTP3:"badge-protocol-quic",FTP:"badge-protocol-http",SSH:"badge-protocol-dns",SMTP:"badge-protocol-http",IMAP:"badge-protocol-http",POP3:"badge-protocol-http",ARP:"badge-protocol-icmp",DHCP:"badge-protocol-udp",NTP:"badge-protocol-udp",Unknown:"bg-gray-500/20 text-gray-400"},er={new:"text-blue-400",established:"text-green-400",closing:"text-yellow-400",closed:"text-gray-400",timeout:"text-orange-400",reset:"text-red-400"},it=40;function tr(){const t=m.useRef(null),s=w(l=>l.getFilteredFlows()),a=w(l=>l.view.selectedFlowId),r=w(l=>l.selectFlow),n=xe({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>it,overscan:15}),c=n.getVirtualItems(),i=m.useCallback((l,x)=>{const g=(x-l)/1e6;return g<1e3?`${g.toFixed(0)}ms`:g<6e4?`${(g/1e3).toFixed(1)}s`:`${(g/6e4).toFixed(1)}m`},[]),d=m.useCallback(l=>l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:l<1024*1024*1024?`${(l/(1024*1024)).toFixed(1)} MB`:`${(l/(1024*1024*1024)).toFixed(2)} GB`,[]),h=m.useCallback(l=>new Date(l/1e6).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),[]),o=m.useCallback(l=>{r(l.id)},[r]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-20 px-2 py-2",children:"Time"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Source"}),e.jsx("div",{className:"w-8 px-1 py-2"}),e.jsx("div",{className:"flex-1 px-2 py-2",children:"Destination"}),e.jsx("div",{className:"w-20 px-2 py-2",children:"Protocol"}),e.jsx("div",{className:"w-16 px-2 py-2",children:"State"}),e.jsx("div",{className:"w-16 px-2 py-2 text-right",children:"Packets"}),e.jsx("div",{className:"w-20 px-2 py-2 text-right",children:"Bytes"}),e.jsx("div",{className:"w-16 px-2 py-2 text-right",children:"Duration"}),e.jsx("div",{className:"w-40 px-2 py-2",children:"Info"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:c.map(l=>{const x=s[l.index],g=x.id===a;return e.jsxs("div",{"data-index":l.index,ref:n.measureElement,className:y("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",g&&"table-row-selected bg-cyber-900/30"),style:{height:`${it}px`,transform:`translateY(${l.start}px)`},onClick:()=>o(x),children:[e.jsx("div",{className:"w-20 px-2 text-xs font-mono text-gray-400",children:h(x.startTimeNano)}),e.jsxs("div",{className:"flex-1 px-2",children:[e.jsx("div",{className:"text-xs font-mono text-gray-300 truncate",children:x.srcIP}),e.jsxs("div",{className:"text-xxs text-gray-500",children:[":",x.srcPort]})]}),e.jsx("div",{className:"w-8 px-1 flex justify-center",children:e.jsx($e,{className:"w-3 h-3 text-gray-600"})}),e.jsxs("div",{className:"flex-1 px-2",children:[e.jsx("div",{className:"text-xs font-mono text-gray-300 truncate",children:x.dstIP}),e.jsxs("div",{className:"text-xxs text-gray-500",children:[":",x.dstPort]})]}),e.jsx("div",{className:"w-20 px-2",children:e.jsx("span",{className:y("badge",lt[x.protocol]||lt.Unknown),children:x.protocol})}),e.jsx("div",{className:"w-16 px-2",children:e.jsx("span",{className:y("text-xs capitalize",er[x.state]),children:x.state})}),e.jsx("div",{className:"w-16 px-2 text-xs font-mono text-gray-400 text-right",children:x.packetCount.toLocaleString()}),e.jsx("div",{className:"w-20 px-2 text-xs font-mono text-gray-400 text-right",children:d(x.byteCount)}),e.jsx("div",{className:"w-16 px-2 text-xs font-mono text-gray-500 text-right",children:i(x.startTimeNano,x.endTimeNano)}),e.jsxs("div",{className:"w-40 px-2 flex items-center gap-1",children:[x.metadata.ja4&&e.jsx(qt,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{className:"text-xs text-gray-500 truncate",children:sr(x)})]})]},l.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," flows"]})]})}function sr(t){return t.metadata.serverName?t.metadata.serverName:t.metadata.httpHost?t.metadata.httpHost:t.metadata.dnsQuery?t.metadata.dnsQuery:t.metadata.smbShare?t.metadata.smbShare:t.metadata.applicationProtocol?t.metadata.applicationProtocol:""}function ar({flow:t}){const[s,a]=m.useState(null),r=async(d,h)=>{await navigator.clipboard.writeText(d),a(h),setTimeout(()=>a(null),2e3)},n=d=>new Date(d/1e6).toISOString(),c=(d,h)=>{const o=(h-d)/1e6;return o<1e3?`${o.toFixed(0)} ms`:o<6e4?`${(o/1e3).toFixed(2)} sec`:`${(o/6e4).toFixed(2)} min`},i=d=>d<1024?`${d} B`:d<1024*1024?`${(d/1024).toFixed(2)} KB`:d<1024*1024*1024?`${(d/(1024*1024)).toFixed(2)} MB`:`${(d/(1024*1024*1024)).toFixed(2)} GB`;return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-3",children:"Flow Summary"}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-overlay rounded-lg mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Source"}),e.jsx("div",{className:"font-mono text-sm text-gray-200",children:t.srcIP}),e.jsxs("div",{className:"font-mono text-xs text-gray-500",children:[":",t.srcPort]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center px-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-cyber-500 to-transparent"}),e.jsx($e,{className:"w-4 h-4 text-cyber-400 mx-2"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-l from-cyber-500 to-transparent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Destination"}),e.jsx("div",{className:"font-mono text-sm text-gray-200",children:t.dstIP}),e.jsxs("div",{className:"font-mono text-xs text-gray-500",children:[":",t.dstPort]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Packets"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:t.packetCount.toLocaleString()})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Bytes"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:i(t.byteCount)})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Duration"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:c(t.startTimeNano,t.endTimeNano)})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Protocol"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:t.protocol})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Timestamps"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"Start:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:n(t.startTimeNano)}),e.jsx(F,{value:n(t.startTimeNano),fieldName:"startTime",copiedField:s,onCopy:r})]})]}),e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"End:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:n(t.endTimeNano)}),e.jsx(F,{value:n(t.endTimeNano),fieldName:"endTime",copiedField:s,onCopy:r})]})]})]})]}),(t.metadata.ja3||t.metadata.ja4||t.metadata.serverName)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-green-500"}),"TLS Information"]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[t.metadata.serverName&&e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"Server Name (SNI):"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.serverName}),e.jsx(F,{value:t.metadata.serverName,fieldName:"sni",copiedField:s,onCopy:r})]})]}),t.metadata.ja3&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"JA3 Fingerprint:"}),e.jsx(F,{value:t.metadata.ja3,fieldName:"ja3",copiedField:s,onCopy:r})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 mt-1 break-all",children:t.metadata.ja3})]}),t.metadata.ja3s&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"JA3S Fingerprint:"}),e.jsx(F,{value:t.metadata.ja3s,fieldName:"ja3s",copiedField:s,onCopy:r})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 mt-1 break-all",children:t.metadata.ja3s})]}),t.metadata.ja4&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"JA4 Fingerprint:"}),e.jsx(F,{value:t.metadata.ja4,fieldName:"ja4",copiedField:s,onCopy:r})]}),e.jsx("div",{className:"font-mono text-xxs text-cyber-400 mt-1 break-all",children:t.metadata.ja4})]})]})]}),(t.metadata.httpHost||t.metadata.userAgent)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-protocol-http"}),"HTTP Information"]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[t.metadata.httpHost&&e.jsxs("div",{className:"flex justify-between items-center group",children:[e.jsx("span",{className:"text-gray-500",children:"Host:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.httpHost}),e.jsx(F,{value:t.metadata.httpHost,fieldName:"httpHost",copiedField:s,onCopy:r})]})]}),t.metadata.userAgent&&e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"User-Agent:"}),e.jsx(F,{value:t.metadata.userAgent,fieldName:"userAgent",copiedField:s,onCopy:r})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 mt-1 break-all",children:t.metadata.userAgent})]}),t.metadata.contentType&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Content-Type:"}),e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.contentType})]})]})]}),t.metadata.dnsQuery&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Ut,{className:"w-4 h-4 text-protocol-dns"}),"DNS Information"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs group",children:[e.jsx("span",{className:"text-gray-500",children:"Query:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.dnsQuery}),e.jsx(F,{value:t.metadata.dnsQuery,fieldName:"dnsQuery",copiedField:s,onCopy:r})]})]})]}),t.metadata.smbShare&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-protocol-smb"}),"SMB Information"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs group",children:[e.jsx("span",{className:"text-gray-500",children:"Share:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-mono text-gray-300",children:t.metadata.smbShare}),e.jsx(F,{value:t.metadata.smbShare,fieldName:"smbShare",copiedField:s,onCopy:r})]})]})]})]})}function F({value:t,fieldName:s,copiedField:a,onCopy:r}){return e.jsx("button",{onClick:()=>r(t,s),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:a===s?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})}function rr(){const t=w(a=>a.view.selectedFlowId),s=w(a=>t?a.flows.get(t):null);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(be,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(tr,{})}),s&&e.jsx("div",{className:"w-96 overflow-auto",children:e.jsx(ar,{flow:s})})]})]})}const re={text:Fe,image:da,audio:oa,video:xa,"application/zip":se,"application/x-rar":se,"application/x-7z-compressed":se,"application/gzip":se,"application/pdf":Fe,"application/javascript":Q,"application/json":Q,"application/xml":Q,"text/html":Q,"text/css":Q},ot=48;function nr(){const t=m.useRef(null),s=w(l=>Array.from(l.files.values())),a=w(l=>l.view.selectedFileId),r=w(l=>l.selectFile),n=xe({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>ot,overscan:15}),c=n.getVirtualItems(),i=m.useCallback(l=>{if(re[l])return re[l];const x=l.split("/")[0];return re[x]?re[x]:Bt},[]),d=m.useCallback(l=>l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:l<1024*1024*1024?`${(l/(1024*1024)).toFixed(1)} MB`:`${(l/(1024*1024*1024)).toFixed(2)} GB`,[]),h=m.useCallback(l=>new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}),[]),o=m.useCallback(l=>{r(l.id)},[r]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-12 px-2 py-2"}),e.jsx("div",{className:"flex-1 px-3 py-2",children:"File Name"}),e.jsx("div",{className:"w-32 px-3 py-2",children:"Type"}),e.jsx("div",{className:"w-24 px-3 py-2 text-right",children:"Size"}),e.jsx("div",{className:"w-36 px-3 py-2",children:"Extracted"}),e.jsx("div",{className:"w-20 px-3 py-2 text-center",children:"Status"}),e.jsx("div",{className:"w-24 px-3 py-2 text-center",children:"Actions"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:c.map(l=>{const x=s[l.index],g=x.id===a,v=i(x.mimeType);return e.jsxs("div",{"data-index":l.index,ref:n.measureElement,className:y("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",g&&"table-row-selected bg-cyber-900/30",x.isSuspicious&&"bg-threat-high/5"),style:{height:`${ot}px`,transform:`translateY(${l.start}px)`},onClick:()=>o(x),children:[e.jsx("div",{className:"w-12 px-2 flex justify-center",children:e.jsx(v,{className:y("w-5 h-5",x.isSuspicious?"text-threat-high":"text-gray-400")})}),e.jsx("div",{className:"flex-1 px-3",children:e.jsx("div",{className:"text-sm text-gray-200 truncate",children:x.fileName})}),e.jsx("div",{className:"w-32 px-3",children:e.jsx("span",{className:"text-xs text-gray-500 truncate block",children:x.mimeType})}),e.jsx("div",{className:"w-24 px-3 text-right",children:e.jsx("span",{className:"text-xs font-mono text-gray-400",children:d(x.size)})}),e.jsx("div",{className:"w-36 px-3",children:e.jsx("span",{className:"text-xs text-gray-500",children:h(x.extractedAt)})}),e.jsx("div",{className:"w-20 px-3 text-center",children:x.isSuspicious?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-threat-high/10 text-threat-high text-xs rounded",children:[e.jsx(T,{className:"w-3 h-3"}),"Threat"]}):e.jsx("span",{className:"text-xs text-green-500",children:"Clean"})}),e.jsxs("div",{className:"w-24 px-3 flex items-center justify-center gap-1",children:[e.jsx("button",{className:"btn-icon p-1",title:"Preview",onClick:k=>{k.stopPropagation()},children:e.jsx(R,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{className:"btn-icon p-1",title:"Download",onClick:k=>{k.stopPropagation()},children:e.jsx($t,{className:"w-4 h-4 text-gray-400"})})]})]},l.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," files extracted"]})]})}function cr({file:t}){const[s,a]=m.useState(null),r=async(i,d)=>{await navigator.clipboard.writeText(i),a(d),setTimeout(()=>a(null),2e3)},n=i=>i<1024?`${i} bytes`:i<1024*1024?`${(i/1024).toFixed(2)} KB`:i<1024*1024*1024?`${(i/(1024*1024)).toFixed(2)} MB`:`${(i/(1024*1024*1024)).toFixed(2)} GB`,c=i=>new Date(i).toISOString();return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:y("p-4 rounded-lg border",t.isSuspicious?"bg-threat-high/10 border-threat-high/30":"bg-surface-overlay border-surface-border"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:y("p-3 rounded-lg",t.isSuspicious?"bg-threat-high/20":"bg-surface-border"),children:e.jsx(Bt,{className:y("w-8 h-8",t.isSuspicious?"text-threat-high":"text-gray-400")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-white truncate",children:t.fileName}),e.jsx("p",{className:"text-sm text-gray-500",children:t.mimeType}),t.isSuspicious&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(T,{className:"w-4 h-4 text-threat-high"}),e.jsx("span",{className:"text-sm text-threat-high font-medium",children:t.threatType||"Suspicious file detected"})]})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-3",children:"File Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Size"})]}),e.jsx("span",{className:"font-mono text-sm text-gray-300",children:n(t.size)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Extracted"})]}),e.jsx("span",{className:"font-mono text-sm text-gray-300",children:c(t.extractedAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Ht,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Source Flow"})]}),e.jsx("span",{className:"font-mono text-xs text-gray-400 truncate max-w-32",children:t.sourceFlow})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-3 flex items-center gap-2",children:[e.jsx(ha,{className:"w-4 h-4 text-gray-500"}),"File Hashes"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"SHA-256"}),e.jsx("button",{onClick:()=>r(t.sha256,"sha256"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="sha256"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]}),e.jsx("div",{className:"font-mono text-xxs text-gray-400 break-all bg-surface-overlay p-2 rounded",children:t.sha256})]}),e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"BLAKE3"}),e.jsx("button",{onClick:()=>r(t.blake3,"blake3"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="blake3"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]}),e.jsx("div",{className:"font-mono text-xxs text-cyber-400 break-all bg-surface-overlay p-2 rounded",children:t.blake3})]})]})]}),t.isSuspicious&&t.threatType&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-3 flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-threat-high"}),"Threat Analysis"]}),e.jsx("div",{className:"p-3 bg-threat-high/10 border border-threat-high/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-threat-high",children:t.threatType})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"btn btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx($t,{className:"w-4 h-4"}),"Download"]}),e.jsx("button",{className:"btn btn-secondary flex-1",children:"View in Hex"})]}),e.jsx("div",{className:"pt-4 border-t border-surface-border",children:e.jsxs("a",{href:`https://www.virustotal.com/gui/file/${t.sha256}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyber-400 hover:text-cyber-300 flex items-center gap-1",children:["Check on VirusTotal",e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})}function lr(){const t=w(a=>a.view.selectedFileId),s=w(a=>t?a.files.get(t):null);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(be,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(nr,{})}),s&&e.jsx("div",{className:"w-96 overflow-auto",children:e.jsx(cr,{file:s})})]})]})}const ir={critical:{color:"text-threat-critical",bg:"bg-threat-critical/10",border:"border-threat-critical/30"},high:{color:"text-threat-high",bg:"bg-threat-high/10",border:"border-threat-high/30"},medium:{color:"text-threat-medium",bg:"bg-threat-medium/10",border:"border-threat-medium/30"},low:{color:"text-threat-low",bg:"bg-threat-low/10",border:"border-threat-low/30"},info:{color:"text-threat-info",bg:"bg-threat-info/10",border:"border-threat-info/30"}},or={malware:ze,c2:je,exfiltration:R,lateral_movement:O,credential_access:Vt,reconnaissance:R,anomaly:T,policy_violation:zt,suspicious:T},dt=64;function dr(){const t=m.useRef(null),s=w(h=>h.getFilteredAlerts()),a=w(h=>h.view.selectedAlertId),r=w(h=>h.selectAlert),n=xe({count:s.length,getScrollElement:()=>t.current,estimateSize:()=>dt,overscan:10}),c=n.getVirtualItems(),i=m.useCallback(h=>new Date(h/1e6).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),[]),d=m.useCallback(h=>{r(h.id)},[r]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"table-header flex items-center border-b border-surface-border text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"w-24 px-3 py-2",children:"Severity"}),e.jsx("div",{className:"w-32 px-3 py-2",children:"Time"}),e.jsx("div",{className:"w-24 px-3 py-2",children:"Category"}),e.jsx("div",{className:"flex-1 px-3 py-2",children:"Alert"}),e.jsx("div",{className:"w-40 px-3 py-2",children:"Source  Dest"})]}),e.jsx("div",{ref:t,className:"flex-1 overflow-auto",children:e.jsx("div",{style:{height:`${n.getTotalSize()}px`,width:"100%",position:"relative"},children:c.map(h=>{const o=s[h.index],l=o.id===a,x=ir[o.severity],g=or[o.category]||T;return e.jsxs("div",{"data-index":h.index,ref:n.measureElement,className:y("absolute top-0 left-0 w-full flex items-center","table-row cursor-pointer",l&&"table-row-selected",x.bg),style:{height:`${dt}px`,transform:`translateY(${h.start}px)`},onClick:()=>d(o),children:[e.jsx("div",{className:"w-24 px-3",children:e.jsx("span",{className:y("inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium uppercase",x.bg,x.color,"border",x.border),children:o.severity})}),e.jsx("div",{className:"w-32 px-3 text-xs font-mono text-gray-400",children:i(o.timestampNano)}),e.jsx("div",{className:"w-24 px-3",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(g,{className:y("w-4 h-4",x.color)}),e.jsx("span",{className:"text-xs text-gray-400 capitalize",children:o.category.replace("_"," ")})]})}),e.jsxs("div",{className:"flex-1 px-3",children:[e.jsx("div",{className:y("text-sm font-medium",x.color),children:o.title}),e.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:o.description})]}),e.jsx("div",{className:"w-40 px-3",children:o.sourceIP&&e.jsxs("div",{className:"text-xs font-mono text-gray-400",children:[o.sourceIP,o.destIP&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"  "}),o.destIP]})]})})]},h.key)})})}),e.jsxs("div",{className:"px-4 py-2 border-t border-surface-border text-xs text-gray-500",children:[s.length.toLocaleString()," alerts"]})]})}const xr={critical:{color:"text-threat-critical",bg:"bg-threat-critical/10",label:"Critical"},high:{color:"text-threat-high",bg:"bg-threat-high/10",label:"High"},medium:{color:"text-threat-medium",bg:"bg-threat-medium/10",label:"Medium"},low:{color:"text-threat-low",bg:"bg-threat-low/10",label:"Low"},info:{color:"text-threat-info",bg:"bg-threat-info/10",label:"Info"}},hr={malware:ze,c2:je,exfiltration:R,lateral_movement:O,credential_access:Vt,reconnaissance:R,anomaly:T,policy_violation:zt,suspicious:T};function mr({alert:t}){var d,h;const[s,a]=m.useState(null),r=xr[t.severity],n=hr[t.category]||T,c=async(o,l)=>{await navigator.clipboard.writeText(o),a(l),setTimeout(()=>a(null),2e3)},i=o=>new Date(o/1e6).toISOString();return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:y("p-4 rounded-lg border",r.bg,`border-${t.severity==="critical"?"threat-critical":t.severity==="high"?"threat-high":"surface-border"}/30`),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:y("p-2 rounded-lg",r.bg),children:e.jsx(n,{className:y("w-6 h-6",r.color)})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:y("px-2 py-0.5 rounded text-xs font-medium uppercase",r.bg,r.color),children:r.label}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:t.category.replace("_"," ")})]}),e.jsx("h3",{className:y("text-lg font-semibold",r.color),children:t.title})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:t.description})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-gray-500"}),"Timestamp"]}),e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("span",{className:"font-mono text-sm text-gray-300",children:i(t.timestampNano)}),e.jsx("button",{onClick:()=>c(i(t.timestampNano),"timestamp"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="timestamp"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]})]}),(t.sourceIP||t.destIP)&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-gray-500"}),"Network Information"]}),e.jsxs("div",{className:"space-y-2",children:[t.sourceIP&&e.jsxs("div",{className:"flex items-center justify-between group",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Source IP:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-gray-300",children:t.sourceIP}),e.jsx("button",{onClick:()=>c(t.sourceIP,"sourceIP"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="sourceIP"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]})]}),t.destIP&&e.jsxs("div",{className:"flex items-center justify-between group",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Destination IP:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-gray-300",children:t.destIP}),e.jsx("button",{onClick:()=>c(t.destIP,"destIP"),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-overlay rounded transition-all",children:s==="destIP"?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]})]})]})]}),t.indicators.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(ka,{className:"w-4 h-4 text-gray-500"}),"Indicators of Compromise"]}),e.jsx("div",{className:"space-y-1",children:t.indicators.map((o,l)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-surface-overlay rounded group",children:[e.jsx("span",{className:"font-mono text-xs text-gray-300 truncate",children:o}),e.jsx("button",{onClick:()=>c(o,`indicator-${l}`),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-surface-border rounded transition-all",children:s===`indicator-${l}`?e.jsx(D,{className:"w-3 h-3 text-green-500"}):e.jsx(B,{className:"w-3 h-3 text-gray-500"})})]},l))})]}),(((d=t.mitreTactics)==null?void 0:d.length)||((h=t.mitreTechniques)==null?void 0:h.length))&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-gray-500"}),"MITRE ATT&CK"]}),e.jsxs("div",{className:"space-y-3",children:[t.mitreTactics&&t.mitreTactics.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Tactics:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.mitreTactics.map((o,l)=>e.jsxs("a",{href:`https://attack.mitre.org/tactics/${o}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-0.5 bg-cyber-900/30 text-cyber-400 text-xs rounded hover:bg-cyber-900/50 transition-colors",children:[o,e.jsx(st,{className:"w-3 h-3"})]},l))})]}),t.mitreTechniques&&t.mitreTechniques.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Techniques:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.mitreTechniques.map((o,l)=>e.jsxs("a",{href:`https://attack.mitre.org/techniques/${o}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-0.5 bg-threat-high/10 text-threat-high text-xs rounded hover:bg-threat-high/20 transition-colors",children:[o,e.jsx(st,{className:"w-3 h-3"})]},l))})]})]})]}),t.relatedFlows.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-200 mb-2 flex items-center gap-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-gray-500"}),"Related Flows (",t.relatedFlows.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[t.relatedFlows.slice(0,5).map((o,l)=>e.jsx("div",{className:"p-2 bg-surface-overlay rounded text-xs font-mono text-gray-400 cursor-pointer hover:bg-surface-border transition-colors",children:o},l)),t.relatedFlows.length>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["+",t.relatedFlows.length-5," more flows"]})]})]})]})}function ur(){const t=w(a=>a.view.selectedAlertId),s=w(a=>t?a.alerts.get(t):null);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(be,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden border-r border-surface-border",children:e.jsx(dr,{})}),s&&e.jsx("div",{className:"w-96 overflow-auto",children:e.jsx(mr,{alert:s})})]})]})}const xt={internal:"#8b5cf6",external:"#ef4444",gateway:"#f59e0b",server:"#3b82f6",client:"#22c55e"},ht={TCP:"#3b82f6",UDP:"#22c55e",ICMP:"#f97316",DNS:"#8b5cf6",HTTP:"#06b6d4",HTTPS:"#10b981",SMB:"#f59e0b",QUIC:"#ec4899",default:"#6b7280"};function pr({nodes:t,links:s,onNodeClick:a,selectedNode:r}){const n=m.useRef(),[c,i]=m.useState({width:800,height:600}),d=m.useRef(null);m.useEffect(()=>{const p=()=>{d.current&&i({width:d.current.clientWidth,height:d.current.clientHeight})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const h={nodes:t.map(p=>({id:p.id,name:p.hostname||p.ip,ip:p.ip,type:p.type,packetCount:p.packetCount,byteCount:p.byteCount,alertCount:p.alertCount,val:Math.log10(p.byteCount+1)*2+5})),links:s.map(p=>({source:p.source,target:p.target,protocol:p.protocol,packetCount:p.packetCount,byteCount:p.byteCount,bidirectional:p.bidirectional}))},o=m.useCallback(p=>{const A=p.id===r,I=p.alertCount>0,E=new Re(p.val||5,16,16),L=xt[p.type]||xt.client,j=new ss({color:L,emissive:A?L:I?"#ef4444":"#000000",emissiveIntensity:A?.5:I?.3:0,transparent:!0,opacity:.9}),u=new ve(E,j);if(A){const b=new as((p.val||5)*1.5,(p.val||5)*1.8,32),N=new He({color:"#8b5cf6",side:rs,transparent:!0,opacity:.6}),S=new ve(b,N);u.add(S)}if(I){const b=new Re(2,8,8),N=new He({color:"#ef4444"}),S=new ve(b,N);S.position.set(p.val||5,p.val||5,0),u.add(S)}return u},[r]),l=m.useCallback(p=>ht[p.protocol]||ht.default,[]),x=m.useCallback(p=>Math.log10(p.packetCount+1)*.5+.5,[]),g=m.useCallback(p=>{if(a(p.id),n.current&&p.x!==void 0&&p.y!==void 0&&p.z!==void 0){const I=1+100/Math.hypot(p.x,p.y,p.z);n.current.cameraPosition({x:p.x*I,y:p.y*I,z:p.z*I},p,1e3)}},[a]),v=m.useCallback(()=>{a(null)},[a]),k=m.useCallback(p=>`
      <div style="background: rgba(10,10,15,0.9); padding: 8px 12px; border-radius: 6px; border: 1px solid #2a2a3a;">
        <div style="font-weight: 600; color: #fff; margin-bottom: 4px;">${p.name}</div>
        <div style="font-family: monospace; font-size: 11px; color: #9ca3af;">${p.ip}</div>
        <div style="font-size: 11px; color: #6b7280; margin-top: 4px;">
          ${p.packetCount.toLocaleString()} packets  ${fr(p.byteCount)}
        </div>
        ${p.alertCount>0?`<div style="color: #ef4444; font-size: 11px; margin-top: 2px;">${p.alertCount} alerts</div>`:""}
      </div>
    `,[]);return t.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("p",{className:"text-lg",children:"No network topology data"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Start capturing to visualize network connections"})]})}):e.jsx("div",{ref:d,className:"h-full w-full bg-surface",children:e.jsx(ns,{ref:n,width:c.width,height:c.height,graphData:h,nodeThreeObject:o,nodeLabel:k,linkColor:l,linkWidth:x,linkOpacity:.6,linkDirectionalParticles:2,linkDirectionalParticleWidth:2,linkDirectionalParticleSpeed:.005,onNodeClick:g,onBackgroundClick:v,backgroundColor:"#0a0a0f",showNavInfo:!1,enableNodeDrag:!0,enableNavigationControls:!0,controlType:"orbit"})})}function fr(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:t<1024*1024*1024?`${(t/(1024*1024)).toFixed(1)} MB`:`${(t/(1024*1024*1024)).toFixed(2)} GB`}function gr({onZoomIn:t,onZoomOut:s,onReset:a,onFitView:r}){const[n,c]=m.useState(!0),[i,d]=m.useState(!0),[h,o]=m.useState(!1);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"panel p-1 flex flex-col gap-1",children:[e.jsx("button",{onClick:t,className:"btn-icon",title:"Zoom In",children:e.jsx(Ia,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:s,className:"btn-icon",title:"Zoom Out",children:e.jsx(Ma,{className:"w-4 h-4 text-gray-400"})}),e.jsx("div",{className:"h-px bg-surface-border my-1"}),e.jsx("button",{onClick:r,className:"btn-icon",title:"Fit to View",children:e.jsx(fa,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:a,className:"btn-icon",title:"Reset View",children:e.jsx(ba,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"panel p-1 flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>c(!n),className:y("btn-icon",n&&"bg-surface-overlay"),title:"Toggle Labels",children:n?e.jsx(R,{className:"w-4 h-4 text-cyber-400"}):e.jsx(ia,{className:"w-4 h-4 text-gray-400"})}),e.jsx("button",{onClick:()=>d(!i),className:y("btn-icon",i&&"bg-surface-overlay"),title:"Toggle Alert Indicators",children:e.jsx(ua,{className:y("w-4 h-4",i?"text-threat-high":"text-gray-400")})}),e.jsx("div",{className:"h-px bg-surface-border my-1"}),e.jsx("button",{onClick:()=>o(!h),className:y("btn-icon",h&&"bg-surface-overlay"),title:"Filter Options",children:e.jsx(Ot,{className:"w-4 h-4 text-gray-400"})})]}),h&&e.jsxs("div",{className:"panel p-3 w-48",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Node Types"}),e.jsx("div",{className:"space-y-1",children:[{type:"internal",label:"Internal",color:"#8b5cf6"},{type:"external",label:"External",color:"#ef4444"},{type:"gateway",label:"Gateway",color:"#f59e0b"},{type:"server",label:"Server",color:"#3b82f6"},{type:"client",label:"Client",color:"#22c55e"}].map(({type:l,label:x,color:g})=>e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:g}}),x]},l))}),e.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mt-4 mb-2",children:"Protocols"}),e.jsx("div",{className:"space-y-1",children:["TCP","UDP","DNS","HTTP","HTTPS","SMB"].map(l=>e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-600 bg-surface text-cyber-500 focus:ring-cyber-500"}),l]},l))})]}),e.jsxs("div",{className:"panel p-3",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Legend"}),e.jsx("div",{className:"space-y-1.5",children:[{color:"#8b5cf6",label:"Internal"},{color:"#ef4444",label:"External"},{color:"#f59e0b",label:"Gateway"},{color:"#3b82f6",label:"Server"},{color:"#22c55e",label:"Client"}].map(({color:l,label:x})=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l}}),x]},x))})]})]})}const yr={internal:ga,external:de,gateway:va,server:Ut,client:ma},mt={internal:"text-cyber-400",external:"text-red-400",gateway:"text-amber-400",server:"text-blue-400",client:"text-green-400"};function jr({node:t,links:s,onClose:a}){const r=yr[t.type],n=d=>d<1024?`${d} B`:d<1024*1024?`${(d/1024).toFixed(1)} KB`:d<1024*1024*1024?`${(d/(1024*1024)).toFixed(1)} MB`:`${(d/(1024*1024*1024)).toFixed(2)} GB`,c=s.filter(d=>d.target===t.id),i=s.filter(d=>d.source===t.id);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-surface-border flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:y("p-2 rounded-lg bg-surface-overlay",mt[t.type]),children:e.jsx(r,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:t.hostname||t.ip}),t.hostname&&e.jsx("p",{className:"text-xs font-mono text-gray-500",children:t.ip}),e.jsx("span",{className:y("text-xs capitalize",mt[t.type]),children:t.type})]})]}),e.jsx("button",{onClick:a,className:"btn-icon",children:e.jsx(G,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"p-4 border-b border-surface-border",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Packets"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:t.packetCount.toLocaleString()})]}),e.jsxs("div",{className:"p-3 bg-surface-overlay rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Bytes"})]}),e.jsx("div",{className:"font-mono text-lg text-white",children:n(t.byteCount)})]})]}),t.alertCount>0&&e.jsx("div",{className:"mt-3 p-3 bg-threat-critical/10 border border-threat-critical/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-threat-critical"}),e.jsxs("span",{className:"text-sm text-threat-critical font-medium",children:[t.alertCount," Alert",t.alertCount>1?"s":""]})]})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3",children:["Connections (",s.length,")"]}),c.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-xs text-gray-500 mb-2",children:["Inbound (",c.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[c.slice(0,10).map((d,h)=>e.jsx(ut,{link:d,direction:"inbound"},h)),c.length>10&&e.jsxs("p",{className:"text-xs text-gray-500",children:["+",c.length-10," more"]})]})]}),i.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-xs text-gray-500 mb-2",children:["Outbound (",i.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[i.slice(0,10).map((d,h)=>e.jsx(ut,{link:d,direction:"outbound"},h)),i.length>10&&e.jsxs("p",{className:"text-xs text-gray-500",children:["+",i.length-10," more"]})]})]}),s.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No connections found"})]})]})}function ut({link:t,direction:s}){const a=s==="inbound"?t.source:t.target,r=n=>n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`;return e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-surface-overlay rounded-lg text-xs",children:[e.jsx($e,{className:y("w-3 h-3 flex-shrink-0",s==="inbound"?"rotate-180 text-green-500":"text-blue-500")}),e.jsx("span",{className:"font-mono text-gray-300 truncate flex-1",children:a}),e.jsx("span",{className:y("badge",t.protocol==="TCP"&&"badge-protocol-tcp",t.protocol==="UDP"&&"badge-protocol-udp",t.protocol==="DNS"&&"badge-protocol-dns",t.protocol==="HTTP"&&"badge-protocol-http",t.protocol==="HTTPS"&&"badge-protocol-https",t.protocol==="SMB"&&"badge-protocol-smb"),children:t.protocol}),e.jsx("span",{className:"text-gray-500",children:r(t.byteCount)})]})}function br(){const t=w(n=>n.topology),[s,a]=m.useState(null),r=s?t.nodes.find(n=>n.id===s):null;return e.jsxs("div",{className:"h-full flex",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx(gr,{})}),e.jsx(pr,{nodes:t.nodes,links:t.links,onNodeClick:a,selectedNode:s})]}),r&&e.jsx("div",{className:"w-80 border-l border-surface-border overflow-auto",children:e.jsx(jr,{node:r,links:t.links.filter(n=>n.source===s||n.target===s),onClose:()=>a(null)})})]})}const z={PACKET_BATCH:"packet:batch",FLOW_UPDATE:"flow:update",ALERT_NEW:"alert:new",STATS_UPDATE:"stats:update",CAPTURE_STATE:"capture:state",TOPOLOGY_UPDATE:"topology:update",FILE_EXTRACTED:"file:extracted",ERROR:"error"},vr=16;function Nr(){const{addPackets:t,updateFlows:s,addAlert:a,updateStatistics:r,updateCaptureState:n,updateTopology:c,addFile:i}=w(),d=m.useRef([]),h=m.useRef([]),o=m.useRef(0),l=m.useRef(null),x=m.useCallback(()=>{d.current.length>0&&(t(d.current),d.current=[]),h.current.length>0&&(s(h.current),h.current=[]),o.current=performance.now(),l.current=null},[t,s]),g=m.useCallback(()=>{l.current===null&&(performance.now()-o.current>=vr?l.current=requestAnimationFrame(x):l.current=requestAnimationFrame(()=>{l.current=requestAnimationFrame(x)}))},[x]),v=m.useCallback(u=>{const b=u;d.current.push(...b.packets),g()},[g]),k=m.useCallback(u=>{const b=u;h.current.push(...b.flows),g()},[g]),p=m.useCallback(u=>{const b=u;a(b.alert),(b.alert.severity==="critical"||b.alert.severity==="high")&&wr(b.alert)},[a]),A=m.useCallback(u=>{r(u.stats)},[r]),I=m.useCallback(u=>{n(u.state)},[n]),E=m.useCallback(u=>{c(u.topology)},[c]),L=m.useCallback(u=>{i(u.file)},[i]),j=m.useCallback(u=>{const b=u;console.error("Backend error:",b.message,b.code)},[]);m.useEffect(()=>{const u=window.runtime;if(!u){console.warn("Wails runtime not available, running in development mode");return}const b=[u.EventsOn(z.PACKET_BATCH,v),u.EventsOn(z.FLOW_UPDATE,k),u.EventsOn(z.ALERT_NEW,p),u.EventsOn(z.STATS_UPDATE,A),u.EventsOn(z.CAPTURE_STATE,I),u.EventsOn(z.TOPOLOGY_UPDATE,E),u.EventsOn(z.FILE_EXTRACTED,L),u.EventsOn(z.ERROR,j)];return()=>{b.forEach(N=>N==null?void 0:N()),l.current!==null&&cancelAnimationFrame(l.current)}},[v,k,p,A,I,E,L,j])}function wr(t){"Notification"in window&&Notification.permission==="granted"&&new Notification(`NFA Alert: ${t.title}`,{body:t.description,icon:"/nfa-icon.svg",tag:t.id})}function kr(){const t=Dt();Nr();const s=()=>{switch(t){case"dashboard":return e.jsx(rt,{});case"packets":return e.jsx(Ja,{});case"flows":return e.jsx(rr,{});case"files":return e.jsx(lr,{});case"alerts":return e.jsx(ur,{});case"topology":return e.jsx(br,{});default:return e.jsx(rt,{})}};return e.jsxs("div",{className:"h-screen w-screen flex flex-col bg-surface overflow-hidden",children:[e.jsx(Da,{}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx(Fa,{}),e.jsx("main",{className:"flex-1 overflow-hidden bg-grid",children:s()})]}),e.jsx(Ea,{})]})}Se.createRoot(document.getElementById("root")).render(e.jsx(pt.StrictMode,{children:e.jsx(kr,{})}));
